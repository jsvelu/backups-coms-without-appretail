webpackJsonp([6],[function(e,r,t){e.exports=t(172)},,function(e,r){"use strict";r.__esModule=!0,r.default=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var a=t(23),s=n(a);r.default=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}()},,,,,,,,,,,,,,,,,,,,function(e,r,t){e.exports={default:t(25),__esModule:!0}},,function(e,r,t){t(31);var n=t(4).Object;e.exports=function(e,r,t){return n.defineProperty(e,r,t)}},,,,,,function(e,r,t){var n=t(9);n(n.S+n.F*!t(8),"Object",{defineProperty:t(11).f})},,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";function n(e){var r,t;this.promise=new e(function(e,n){if(void 0!==r||void 0!==t)throw TypeError("Bad Promise constructor");r=e,t=n}),this.resolve=a(r),this.reject=a(t)}var a=t(36);e.exports.f=function(e){return new n(e)}},,,,,,,,,,,,,,,,,,function(e,r,t){var n;(function(e,a){(function(){function s(e,r){return e.set(r[0],r[1]),e}function i(e,r){return e.add(r),e}function o(e,r,t){var n=t?t.length:0;switch(n){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}function l(e,r){for(var t=-1,n=e.length,a=-1,s=r.length,i=Array(n+s);++t<n;)i[t]=e[t];for(;++a<s;)i[t++]=r[a];return i}function d(e,r){for(var t=-1,n=e.length;++t<n&&r(e[t],t,e)!==!1;);return e}function c(e,r){for(var t=e.length;t--&&r(e[t],t,e)!==!1;);return e}function u(e,r){for(var t=-1,n=e.length;++t<n;)if(!r(e[t],t,e))return!1;return!0}function m(e,r){for(var t=-1,n=e.length,a=-1,s=[];++t<n;){var i=e[t];r(i,t,e)&&(s[++a]=i)}return s}function p(e,r){return!!e.length&&S(e,r,0)>-1}function f(e,r,t){for(var n=-1,a=e.length;++n<a;)if(t(r,e[n]))return!0;return!1}function _(e,r){for(var t=-1,n=e.length,a=Array(n);++t<n;)a[t]=r(e[t],t,e);return a}function v(e,r){for(var t=-1,n=r.length,a=e.length;++t<n;)e[a+t]=r[t];return e}function g(e,r,t,n){var a=-1,s=e.length;for(n&&s&&(t=e[++a]);++a<s;)t=r(t,e[a],a,e);return t}function h(e,r,t,n){var a=e.length;for(n&&a&&(t=e[--a]);a--;)t=r(t,e[a],a,e);return t}function b(e,r){for(var t=-1,n=e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}function y(e,r,t){for(var n=-1,a=e.length;++n<a;){var s=e[n],i=r(s);if(null!=i&&(o===K?i===i:t(i,o)))var o=i,l=s}return l}function w(e,r,t,n){var a;return t(e,function(e,t,s){if(r(e,t,s))return a=n?t:e,!1}),a}function C(e,r,t){for(var n=e.length,a=t?n:-1;t?a--:++a<n;)if(r(e[a],a,e))return a;return-1}function S(e,r,t){if(r!==r)return N(e,t);for(var n=t-1,a=e.length;++n<a;)if(e[n]===r)return n;return-1}function k(e,r,t,n,a){return a(e,function(e,a,s){t=n?(n=!1,e):r(t,e,a,s)}),t}function O(e,r){var t=e.length;for(e.sort(r);t--;)e[t]=e[t].value;return e}function D(e,r){for(var t,n=-1,a=e.length;++n<a;){var s=r(e[n]);s!==K&&(t=t===K?s:t+s)}return t}function x(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}function A(e,r){return _(r,function(r){return[r,e[r]]})}function E(e){return function(r){return e(r)}}function q(e,r){return _(r,function(r){return e[r]})}function T(e,r){for(var t=-1,n=e.length;++t<n&&S(r,e[t],0)>-1;);return t}function R(e,r){for(var t=e.length;t--&&S(r,e[t],0)>-1;);return t}function $(e){return e&&e.Object===Object?e:null}function P(e,r){if(e!==r){var t=null===e,n=e===K,a=e===e,s=null===r,i=r===K,o=r===r;if(e>r&&!s||!a||t&&!i&&o||n&&o)return 1;if(e<r&&!t||!o||s&&!n&&a||i&&a)return-1}return 0}function j(e,r,t){for(var n=-1,a=e.criteria,s=r.criteria,i=a.length,o=t.length;++n<i;){var l=P(a[n],s[n]);if(l){if(n>=o)return l;var d=t[n];return l*("desc"==d?-1:1)}}return e.index-r.index}function I(e){return bt[e]}function M(e){return yt[e]}function F(e){return"\\"+St[e]}function N(e,r,t){for(var n=e.length,a=r+(t?0:-1);t?a--:++a<n;){var s=e[a];if(s!==s)return a}return-1}function L(e){var r=!1;if(null!=e&&"function"!=typeof e.toString)try{r=!!(e+"")}catch(e){}return r}function U(e,r){return e="number"==typeof e||Or.test(e)?+e:-1,r=null==r?we:r,e>-1&&e%1==0&&e<r}function W(e){for(var r,t=[];!(r=e.next()).done;)t.push(r.value);return t}function B(e){var r=-1,t=Array(e.size);return e.forEach(function(e,n){t[++r]=[n,e]}),t}function z(e,r){for(var t=-1,n=e.length,a=-1,s=[];++t<n;)e[t]===r&&(e[t]=xe,s[++a]=t);return s}function Q(e){var r=-1,t=Array(e.size);return e.forEach(function(e){t[++r]=e}),t}function H(e){if(!e||!ut.test(e))return e.length;for(var r=ct.lastIndex=0;ct.test(e);)r++;return r}function V(e){return e.match(ct)}function Y(e){return wt[e]}function G(e){function r(e){if(Ci(e)&&!ec(e)&&!(e instanceof a)){if(e instanceof n)return e;if(Ol.call(e,"__wrapped__"))return wa(e)}return new n(e)}function t(){}function n(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=K}function a(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ke,this.__views__=[]}function $(){var e=new a(this.__wrapped__);return e.__actions__=Dn(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Dn(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Dn(this.__views__),e}function We(){if(this.__filtered__){var e=new a(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Or(){var e=this.__wrapped__.value(),r=this.__dir__,t=ec(e),n=r<0,a=t?e.length:0,s=ta(0,a,this.__views__),i=s.start,o=s.end,l=o-i,d=n?o:i-1,c=this.__iteratees__,u=c.length,m=0,p=Yl(l,this.__takeCount__);if(!t||a<fe||a==l&&p==l)return vn(e,this.__actions__);var f=[];e:for(;l--&&m<p;){d+=r;for(var _=-1,v=e[d];++_<u;){var g=c[_],h=g.iteratee,b=g.type,y=h(v);if(b==ve)v=y;else if(!y){if(b==_e)continue e;break e}}f[m++]=v}return f}function Er(){}function qr(e,r){return Rr(e,r)&&delete e[r]}function Tr(e,r){if(rd){var t=e[r];return t===be?K:t}return Ol.call(e,r)?e[r]:K}function Rr(e,r){return rd?e[r]!==K:Ol.call(e,r)}function $r(e,r,t){e[r]=rd&&t===K?be:t}function Pr(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function jr(){this.__data__={hash:new Er,map:Zl?new Zl:[],string:new Er}}function Ir(e){var r=this.__data__;return ca(e)?qr("string"==typeof e?r.string:r.hash,e):Zl?r.map.delete(e):Gr(r.map,e)}function Mr(e){var r=this.__data__;return ca(e)?Tr("string"==typeof e?r.string:r.hash,e):Zl?r.map.get(e):Kr(r.map,e)}function Fr(e){var r=this.__data__;return ca(e)?Rr("string"==typeof e?r.string:r.hash,e):Zl?r.map.has(e):Jr(r.map,e)}function Nr(e,r){var t=this.__data__;return ca(e)?$r("string"==typeof e?t.string:t.hash,e,r):Zl?t.map.set(e,r):Xr(t.map,e,r),this}function Lr(e){var r=-1,t=e?e.length:0;for(this.__data__=new Pr;++r<t;)this.push(e[r])}function Ur(e,r){var t=e.__data__;if(ca(r)){var n=t.__data__,a="string"==typeof r?n.string:n.hash;return a[r]===be}return t.has(r)}function Wr(e){var r=this.__data__;if(ca(e)){var t=r.__data__,n="string"==typeof e?t.string:t.hash;n[e]=be}else r.set(e,be)}function Br(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function zr(){this.__data__={array:[],map:null}}function Qr(e){var r=this.__data__,t=r.array;return t?Gr(t,e):r.map.delete(e)}function Hr(e){var r=this.__data__,t=r.array;return t?Kr(t,e):r.map.get(e)}function Vr(e){var r=this.__data__,t=r.array;return t?Jr(t,e):r.map.has(e)}function Yr(e,r){var t=this.__data__,n=t.array;n&&(n.length<fe-1?Xr(n,e,r):(t.array=null,t.map=new Pr(n)));var a=t.map;return a&&a.set(e,r),this}function Gr(e,r){var t=Zr(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():Ul.call(e,t,1),!0}function Kr(e,r){var t=Zr(e,r);return t<0?K:e[t][1]}function Jr(e,r){return Zr(e,r)>-1}function Zr(e,r){for(var t=e.length;t--;)if(ai(e[t][0],r))return t;return-1}function Xr(e,r,t){var n=Zr(e,r);n<0?e.push([r,t]):e[n][1]=t}function et(e,r,t,n){return e===K||ai(e,Sl[t])&&!Ol.call(n,t)?r:e}function rt(e,r,t){(t===K||ai(e[r],t))&&("number"!=typeof r||t!==K||r in e)||(e[r]=t)}function tt(e,r,t){var n=e[r];ai(n,t)&&(!ai(n,Sl[r])||Ol.call(e,r))&&(t!==K||r in e)||(e[r]=t)}function nt(e,r){return e&&xn(r,so(r),e)}function at(e,r){for(var t=-1,n=null==e,a=r.length,s=Array(a);++t<a;)s[t]=n?K:ro(e,r[t]);return s}function st(e,r,t){return e===e&&(t!==K&&(e=e<=t?e:t),r!==K&&(e=e>=r?e:r)),e}function it(e,r,t,n,a,s){var i;if(t&&(i=a?t(e,n,a,s):t(e)),i!==K)return i;if(!wi(e))return e;var o=ec(e);if(o){if(i=aa(e),!r)return Dn(e,i)}else{var l=ra(e),c=l==$e||l==Pe;if(l!=Me&&l!=Ae&&(!c||a))return ht[l]?ia(e,l,r):a?e:{};if(L(e))return a?e:{};if(i=sa(c?{}:e),!r)return En(e,nt(i,e))}s||(s=new Br);var u=s.get(e);return u?u:(s.set(e,i),(o?d:Dt)(e,function(n,a){tt(i,a,it(n,r,t,a,e,s))}),o?i:En(e,i))}function ot(e){var r=so(e),t=r.length;return function(n){if(null==n)return!t;for(var a=t;a--;){var s=r[a],i=e[s],o=n[s];if(o===K&&!(s in Object(n))||!i(o))return!1}return!0}}function lt(e,r,t){if("function"!=typeof e)throw new wl(he);return Ll(function(){e.apply(K,t)},r)}function ct(e,r,t,n){var a=-1,s=p,i=!0,o=e.length,l=[],d=r.length;if(!o)return l;t&&(r=_(r,E(t))),n?(s=f,i=!1):r.length>=fe&&(s=Ur,i=!1,r=new Lr(r));e:for(;++a<o;){var c=e[a],u=t?t(c):c;if(i&&u===u){for(var m=d;m--;)if(r[m]===u)continue e;l.push(c)}else s(r,u,n)||l.push(c)}return l}function bt(e,r){var t=!0;return cd(e,function(e,n,a){return t=!!r(e,n,a)}),t}function yt(e,r,t,n){var a=e.length;for(t=Li(t),t<0&&(t=-t>a?0:a+t),n=n===K||n>a?a:Li(n),n<0&&(n+=a),n=t>n?0:Ui(n);t<n;)e[t++]=r;return e}function wt(e,r){var t=[];return cd(e,function(e,n,a){r(e,n,a)&&t.push(e)}),t}function Ct(e,r,t,n){n||(n=[]);for(var a=-1,s=e.length;++a<s;){var i=e[a];di(i)&&(t||ec(i)||oi(i))?r?Ct(i,r,t,n):v(n,i):t||(n[n.length]=i)}return n}function St(e,r){return null==e?e:md(e,r,io)}function Dt(e,r){return e&&md(e,r,so)}function xt(e,r){return e&&pd(e,r,so)}function At(e,r){return m(r,function(r){return hi(e[r])})}function Et(e,r){r=da(r,e)?[r+""]:mn(r);for(var t=0,n=r.length;null!=e&&t<n;)e=e[r[t++]];return t&&t==n?e:K}function qt(e,r){return Ol.call(e,r)||"object"==typeof e&&r in e&&null===Il(e)}function Tt(e,r){return r in Object(e)}function Pt(e,r,t){return e>=Yl(r,t)&&e<Vl(r,t)}function jt(e,r,t){for(var n=t?f:p,a=e.length,s=a,i=Array(a),o=[];s--;){var l=e[s];s&&r&&(l=_(l,E(r))),i[s]=!t&&(r||l.length>=120)?new Lr(s&&l):K}l=e[0];var d=-1,c=l.length,u=i[0];e:for(;++d<c;){var m=l[d],v=r?r(m):m;if(!(u?Ur(u,v):n(o,v,t))){for(var s=a;--s;){var g=i[s];if(!(g?Ur(g,v):n(e[s],v,t)))continue e}u&&u.push(v),o.push(m)}}return o}function It(e,r,t){da(r,e)||(r=mn(r),e=va(e,r),r=Na(r));var n=null==e?e:e[r];return null==n?K:o(n,e,t)}function Mt(e,r,t,n,a){return e===r||(null==e||null==r||!wi(e)&&!Ci(r)?e!==e&&r!==r:Ft(e,r,Mt,t,n,a))}function Ft(e,r,t,n,a,s){var i=ec(e),o=ec(r),l=Ee,d=Ee;i||(l=ra(e),l==Ae?l=Me:l!=Me&&(i=ji(e))),o||(d=ra(r),d==Ae?d=Me:d!=Me&&(o=ji(r)));var c=l==Me&&!L(e),u=d==Me&&!L(r),m=l==d;if(m&&!i&&!c)return Gn(e,r,l,t,n,a);var p=a&de;if(!p){var f=c&&Ol.call(e,"__wrapped__"),_=u&&Ol.call(r,"__wrapped__");if(f||_)return t(f?e.value():e,_?r.value():r,n,a,s)}return!!m&&(s||(s=new Br),(i?Yn:Kn)(e,r,t,n,a,s))}function Nt(e,r,t,n){var a=t.length,s=a,i=!n;if(null==e)return!s;for(e=Object(e);a--;){var o=t[a];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<s;){o=t[a];var l=o[0],d=e[l],c=o[1];if(i&&o[2]){if(d===K&&!(l in e))return!1}else{var u=new Br,m=n?n(d,c,l,e,r,u):K;if(!(m===K?Mt(c,d,n,le|de,u):m))return!1}}return!0}function Lt(e){var r=typeof e;return"function"==r?e:null==e?Go:"object"==r?ec(e)?Qt(e[0],e[1]):zt(e):nl(e)}function Ut(e){return Hl(Object(e))}function Wt(e){e=null==e?e:Object(e);var r=[];for(var t in e)r.push(t);return r}function Bt(e,r){var t=-1,n=li(e)?Array(e.length):[];return cd(e,function(e,a,s){n[++t]=r(e,a,s)}),n}function zt(e){var r=Xn(e);if(1==r.length&&r[0][2]){var t=r[0][0],n=r[0][1];return function(e){return null!=e&&(e[t]===n&&(n!==K||t in Object(e)))}}return function(t){return t===e||Nt(t,e,r)}}function Qt(e,r){return function(t){var n=ro(t,e);return n===K&&n===r?no(t,e):Mt(r,n,K,le|de)}}function Ht(e,r,t,n,a){if(e!==r){var s=ec(r)||ji(r)?K:io(r);d(s||r,function(i,o){if(s&&(o=i,i=r[o]),wi(i))a||(a=new Br),Vt(e,r,o,t,Ht,n,a);else{var l=n?n(e[o],i,o+"",e,r,a):K;l===K&&(l=i),rt(e,o,l)}})}}function Vt(e,r,t,n,a,s,i){var o=e[t],l=r[t],d=i.get(l)||i.get(o);if(d)return void rt(e,t,d);var c=s?s(o,l,t+"",e,r,i):K,u=c===K;u&&(c=l,ec(l)||ji(l)?c=ec(o)?n?Dn(o):o:di(o)?Dn(o):it(l):qi(l)||oi(l)?c=oi(o)?Bi(o):!wi(o)||n&&hi(o)?it(l):n?it(o):o:u=!1),i.set(l,c),u&&a(c,l,n,s,i),rt(e,t,c)}function Yt(e,r,t){var n=-1,a=Zn();r=_(r.length?r:Array(1),function(e){return a(e)});var s=Bt(e,function(e,t,a){var s=_(r,function(r){return r(e)});return{criteria:s,index:++n,value:e}});return O(s,function(e,r){return j(e,r,t)})}function Gt(e,r){return e=Object(e),g(r,function(r,t){return t in e&&(r[t]=e[t]),r},{})}function Kt(e,r){var t={};return St(e,function(e,n){r(e,n)&&(t[n]=e)}),t}function Jt(e){return function(r){return null==r?K:r[e]}}function Zt(e){return function(r){return Et(r,e)}}function Xt(e,r){return en(e,r)}function en(e,r,t){var n=-1,a=r.length,s=e;for(t&&(s=_(e,function(e){return t(e)}));++n<a;)for(var i=0,o=r[n],l=t?t(o):o;(i=S(s,l,i))>-1;)s!==e&&Ul.call(s,i,1),Ul.call(e,i,1);return e}function rn(e,r){for(var t=e?r.length:0,n=t-1;t--;){var a=r[t];if(n==t||a!=s){var s=a;if(U(a))Ul.call(e,a,1);else if(da(a,e))delete e[a];else{var i=mn(a),o=va(e,i);null!=o&&delete o[Na(i)]}}}return e}function tn(e,r){return e+Bl(Kl()*(r-e+1))}function nn(e,r,t,n){for(var a=-1,s=Vl(Wl((r-e)/(t||1)),0),i=Array(s);s--;)i[n?s:++a]=e,e+=t;return i}function an(e,r,t,n){r=da(r,e)?[r+""]:mn(r);for(var a=-1,s=r.length,i=s-1,o=e;null!=o&&++a<s;){var l=r[a];if(wi(o)){var d=t;if(a!=i){var c=o[l];d=n?n(c,l,o):K,d===K&&(d=null==c?U(r[a+1])?[]:{}:c)}tt(o,l,d)}o=o[l]}return e}function sn(e,r,t){var n=-1,a=e.length;r<0&&(r=-r>a?0:a+r),t=t>a?a:t,t<0&&(t+=a),a=r>t?0:t-r>>>0,r>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+r];return s}function on(e,r){var t;return cd(e,function(e,n,a){return t=r(e,n,a),!t}),!!t}function ln(e,r,t){var n=0,a=e?e.length:n;if("number"==typeof r&&r===r&&a<=De){for(;n<a;){var s=n+a>>>1,i=e[s];(t?i<=r:i<r)&&null!==i?n=s+1:a=s}return a}return dn(e,r,Go,t)}function dn(e,r,t,n){r=t(r);for(var a=0,s=e?e.length:0,i=r!==r,o=null===r,l=r===K;a<s;){var d=Bl((a+s)/2),c=t(e[d]),u=c!==K,m=c===c;if(i)var p=m||n;else p=o?m&&u&&(n||null!=c):l?m&&(n||u):null!=c&&(n?c<=r:c<r);p?a=d+1:s=d}return Yl(s,Oe)}function cn(e){return un(e)}function un(e,r){for(var t=0,n=e.length,a=e[0],s=r?r(a):a,i=s,o=0,l=[a];++t<n;)a=e[t],s=r?r(a):a,ai(s,i)||(i=s,l[++o]=a);return l}function mn(e){return ec(e)?e:ha(e)}function pn(e,r,t){var n=-1,a=p,s=e.length,i=!0,o=[],l=o;if(t)i=!1,a=f;else if(s>=fe){var d=r?null:_d(e);if(d)return Q(d);i=!1,a=Ur,l=new Lr}else l=r?[]:o;e:for(;++n<s;){var c=e[n],u=r?r(c):c;if(i&&u===u){for(var m=l.length;m--;)if(l[m]===u)continue e;r&&l.push(u),o.push(c)}else a(l,u,t)||(l!==o&&l.push(u),o.push(c))}return o}function fn(e,r){r=da(r,e)?[r+""]:mn(r),e=va(e,r);var t=Na(r);return null==e||!to(e,t)||delete e[t]}function _n(e,r,t,n){for(var a=e.length,s=n?a:-1;(n?s--:++s<a)&&r(e[s],s,e););return t?sn(e,n?0:s,n?s+1:a):sn(e,n?s+1:0,n?a:s)}function vn(e,r){var t=e;return t instanceof a&&(t=t.value()),g(r,function(e,r){return r.func.apply(r.thisArg,v([e],r.args))},t)}function gn(e,r,t){for(var n=-1,a=e.length;++n<a;)var s=s?v(ct(s,e[n],r,t),ct(e[n],s,r,t)):e[n];return s&&s.length?pn(s,r,t):[]}function hn(e){var r=e.constructor,t=new r(e.byteLength),n=new $l(t);return n.set(new $l(e)),t}function bn(e){var r=e.constructor;return g(B(e),s,new r)}function yn(e){var r=e.constructor,t=new r(e.source,br.exec(e));return t.lastIndex=e.lastIndex,t}function wn(e){var r=e.constructor;return g(Q(e),i,new r)}function Cn(e){return Rl?Object(id.call(e)):{}}function Sn(e,r){var t=e.buffer,n=e.constructor;return new n(r?hn(t):t,e.byteOffset,e.length)}function kn(e,r,t){for(var n=t.length,a=-1,s=Vl(e.length-n,0),i=-1,o=r.length,l=Array(o+s);++i<o;)l[i]=r[i];for(;++a<n;)l[t[a]]=e[a];for(;s--;)l[i++]=e[a++];return l}function On(e,r,t){for(var n=-1,a=t.length,s=-1,i=Vl(e.length-a,0),o=-1,l=r.length,d=Array(i+l);++s<i;)d[s]=e[s];for(var c=s;++o<l;)d[c+o]=r[o];for(;++n<a;)d[c+t[n]]=e[s++];return d}function Dn(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}function xn(e,r,t){return An(e,r,t)}function An(e,r,t,n){t||(t={});for(var a=-1,s=r.length;++a<s;){var i=r[a],o=n?n(t[i],e[i],i,t,e):e[i];tt(t,i,o)}return t}function En(e,r){return xn(e,hd(e),r)}function qn(e,r){return function(t,n){var a=r?r():{};if(n=Zn(n),ec(t))for(var s=-1,i=t.length;++s<i;){var o=t[s];e(a,o,n(o),t)}else cd(t,function(r,t,s){e(a,r,n(r),s)});return a}}function Tn(e){return Gs(function(r,t){var n=-1,a=t.length,s=a>1?t[a-1]:K,i=a>2?t[2]:K;for(s="function"==typeof s?(a--,s):K,i&&la(t[0],t[1],i)&&(s=a<3?K:s,a=1),r=Object(r);++n<a;){var o=t[n];o&&e(r,o,n,s)}return r})}function Rn(e,r){return function(t,n){if(null==t)return t;if(!li(t))return e(t,n);for(var a=t.length,s=r?a:-1,i=Object(t);(r?s--:++s<a)&&n(i[s],s,i)!==!1;);return t}}function $n(e){return function(r,t,n){for(var a=-1,s=Object(r),i=n(r),o=i.length;o--;){var l=i[e?o:++a];if(t(s[l],l,s)===!1)break}return r}}function Pn(e,r,t){function n(){var r=this&&this!==Rt&&this instanceof n?s:e;return r.apply(a?t:this,arguments)}var a=r&Z,s=Mn(e);return n}function jn(e){return function(r){r=Qi(r);var t=ut.test(r)?V(r):K,n=t?t[0]:r.charAt(0),a=t?t.slice(1).join(""):r.slice(1);return n[e]()+a}}function In(e){return function(r){return g(Qo(Oo(r)),e,"")}}function Mn(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var t=dd(e.prototype),n=e.apply(t,r);return wi(n)?n:t}}function Fn(e,r,t){function n(){for(var s=arguments.length,i=s,l=Array(s),d=this&&this!==Rt&&this instanceof n?a:e,c=n.placeholder;i--;)l[i]=arguments[i];var u=s<3&&l[0]!==c&&l[s-1]!==c?[]:z(l,c);return s-=u.length,s<t?Qn(e,r,Ln,c,K,l,u,K,K,t-s):o(d,this,l)}var a=Mn(e);return n}function Nn(e){return Gs(function(r){r=Ct(r);var t=r.length,a=t,s=n.prototype.thru;for(e&&r.reverse();a--;){var i=r[a];if("function"!=typeof i)throw new wl(he);if(s&&!o&&"wrapper"==Jn(i))var o=new n([],!0)}for(a=o?a:t;++a<t;){i=r[a];var l=Jn(i),d="wrapper"==l?vd(i):K;o=d&&ua(d[0])&&d[1]==(se|re|ne|ie)&&!d[4].length&&1==d[9]?o[Jn(d[0])].apply(o,d[3]):1==i.length&&ua(i)?o[l]():o.thru(i)}return function(){var e=arguments,n=e[0];if(o&&1==e.length&&ec(n)&&n.length>=fe)return o.plant(n).value();for(var a=0,s=t?r[a].apply(this,e):n;++a<t;)s=r[a].call(this,s);return s}})}function Ln(e,r,t,n,a,s,i,o,l,d){function c(){for(var h=arguments.length,b=h,y=Array(h);b--;)y[b]=arguments[b];if(n&&(y=kn(y,n,a)),s&&(y=On(y,s,i)),f||_){var w=c.placeholder,C=z(y,w);if(h-=C.length,h<d)return Qn(e,r,Ln,w,t,y,C,o,l,d-h)}var S=m?t:this,k=p?S[e]:e;return o?y=ga(y,o):v&&y.length>1&&y.reverse(),u&&l<y.length&&(y.length=l),this&&this!==Rt&&this instanceof c&&(k=g||Mn(k)),k.apply(S,y)}var u=r&se,m=r&Z,p=r&X,f=r&re,_=r&te,v=r&oe,g=p?K:Mn(e);return c}function Un(e){return Gs(function(r){return r=_(Ct(r),Zn()),Gs(function(t){var n=this;return e(r,function(e){return o(e,n,t)})})})}function Wn(e,r,t){r=Li(r);var n=H(e);if(!r||n>=r)return"";var a=r-n;t=t===K?" ":t+"";var s=$o(t,Wl(a/H(t)));return ut.test(t)?V(s).slice(0,a).join(""):s.slice(0,a)}function Bn(e,r,t,n){function a(){for(var r=-1,l=arguments.length,d=-1,c=n.length,u=Array(c+l),m=this&&this!==Rt&&this instanceof a?i:e;++d<c;)u[d]=n[d];for(;l--;)u[d++]=arguments[++r];return o(m,s?t:this,u)}var s=r&Z,i=Mn(e);return a}function zn(e){return function(r,t,n){return n&&"number"!=typeof n&&la(r,t,n)&&(t=n=K),r=Wi(r),r=r===r?r:0,t===K?(t=r,r=0):t=Wi(t)||0,n=n===K?r<t?1:-1:Wi(n)||0,nn(r,t,n,e)}}function Qn(e,r,t,n,a,s,i,o,l,d){var c=r&re,u=o?Dn(o):K,m=c?i:K,p=c?K:i,f=c?s:K,_=c?K:s;r|=c?ne:ae,r&=~(c?ae:ne),r&ee||(r&=~(Z|X));var v=[e,r,a,f,m,_,p,u,l,d],g=t.apply(K,v);return ua(e)&&bd(g,v),g.placeholder=n,g}function Hn(e){var r=bl[e];return function(e,t){if(e=Wi(e),t=Li(t)){var n=(Qi(e)+"e").split("e"),a=r(n[0]+"e"+(+n[1]+t));return n=(Qi(a)+"e").split("e"),+(n[0]+"e"+(+n[1]-t))}return r(e)}}function Vn(e,r,t,n,a,s,i,o){var l=r&X;if(!l&&"function"!=typeof e)throw new wl(he);var d=n?n.length:0;if(d||(r&=~(ne|ae),n=a=K),i=i===K?i:Vl(Li(i),0),o=o===K?o:Li(o),d-=a?a.length:0,r&ae){var c=n,u=a;n=a=K}var m=l?K:vd(e),p=[e,r,t,n,a,c,u,s,i,o];if(m&&fa(p,m),e=p[0],r=p[1],t=p[2],n=p[3],a=p[4],o=p[9]=null==p[9]?l?0:e.length:Vl(p[9]-d,0),!o&&r&(re|te)&&(r&=~(re|te)),r&&r!=Z)f=r==re||r==te?Fn(e,r,o):r!=ne&&r!=(Z|ne)||a.length?Ln.apply(K,p):Bn(e,r,t,n);else var f=Pn(e,r,t);var _=m?fd:bd;return _(f,p)}function Yn(e,r,t,n,a,s){var i=-1,o=a&de,l=a&le,d=e.length,c=r.length;if(d!=c&&!(o&&c>d))return!1;var u=s.get(e);if(u)return u==r;var m=!0;for(s.set(e,r);++i<d;){var p=e[i],f=r[i];if(n)var _=o?n(f,p,i,r,e,s):n(p,f,i,e,r,s);if(_!==K){if(_)continue;m=!1;break}if(l){if(!b(r,function(e){return p===e||t(p,e,n,a,s)})){m=!1;break}}else if(p!==f&&!t(p,f,n,a,s)){m=!1;break}}return s.delete(e),m}function Gn(e,r,t,n,a,s){switch(t){case Be:return!(e.byteLength!=r.byteLength||!n(new $l(e),new $l(r)));case qe:case Te:return+e==+r;case Re:return e.name==r.name&&e.message==r.message;case Ie:return e!=+e?r!=+r:e==+r;case Fe:case Le:return e==r+"";case je:var i=B;case Ne:var o=s&de;return i||(i=Q),(o||e.size==r.size)&&n(i(e),i(r),a,s|le);case Ue:return!!Rl&&id.call(e)==id.call(r)}return!1}function Kn(e,r,t,n,a,s){var i=a&de,o=so(e),l=o.length,d=so(r),c=d.length;if(l!=c&&!i)return!1;for(var u=l;u--;){var m=o[u];if(!(i?m in r:qt(r,m)))return!1}var p=s.get(e);if(p)return p==r;var f=!0;s.set(e,r);for(var _=i;++u<l;){m=o[u];var v=e[m],g=r[m];if(n)var h=i?n(g,v,m,r,e,s):n(v,g,m,e,r,s);if(!(h===K?v===g||t(v,g,n,a,s):h)){f=!1;break}_||(_="constructor"==m)}if(f&&!_){var b=e.constructor,y=r.constructor;b!=y&&"constructor"in e&&"constructor"in r&&!("function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y)&&(f=!1)}return s.delete(e),f}function Jn(e){for(var r=e.name+"",t=ld[r],n=Ol.call(ld,r)?t.length:0;n--;){var a=t[n],s=a.func;if(null==s||s==e)return a.name}return r}function Zn(){var e=r.iteratee||Ko;return e=e===Ko?Lt:e,arguments.length?e(arguments[0],arguments[1]):e}function Xn(e){for(var r=_o(e),t=r.length;t--;)r[t][2]=pa(r[t][1]);return r}function ea(e,r){var t=null==e?K:e[r];return Di(t)?t:K}function ra(e){return Al.call(e)}function ta(e,r,t){for(var n=-1,a=t.length;++n<a;){var s=t[n],i=s.size;switch(s.type){case"drop":e+=i;break;case"dropRight":r-=i;break;case"take":r=Yl(r,e+i);break;case"takeRight":e=Vl(e,r-i)}}return{start:e,end:r}}function na(e,r,t){if(null==e)return!1;var n=t(e,r);return n||da(r)||(r=mn(r),e=va(e,r),null!=e&&(r=Na(r),n=t(e,r))),n||yi(e&&e.length)&&U(r,e.length)&&(ec(e)||$i(e)||oi(e))}function aa(e){var r=e.length,t=e.constructor(r);return r&&"string"==typeof e[0]&&Ol.call(e,"index")&&(t.index=e.index,t.input=e.input),t}function sa(e){var r=e.constructor;return dd(hi(r)?r.prototype:K)}function ia(e,r,t){var n=e.constructor;switch(r){case Be:return hn(e);case qe:case Te:return new n(+e);case ze:case Qe:case He:case Ve:case Ye:case Ge:case Ke:case Je:case Ze:return Sn(e,t);case je:return bn(e);case Ie:case Le:return new n(e);case Fe:return yn(e);case Ne:return wn(e);case Ue:return Cn(e)}}function oa(e){var r=e?e.length:K;return yi(r)&&(ec(e)||$i(e)||oi(e))?x(r,String):null}function la(e,r,t){if(!wi(t))return!1;var n=typeof r;return!!("number"==n?li(t)&&U(r,t.length):"string"==n&&r in t)&&ai(t[r],e)}function da(e,r){return"number"==typeof e||!ec(e)&&(cr.test(e)||!dr.test(e)||null!=r&&e in Object(r))}function ca(e){var r=typeof e;return"number"==r||"boolean"==r||"string"==r&&"__proto__"!==e||null==e}function ua(e){var t=Jn(e),n=r[t];if("function"!=typeof n||!(t in a.prototype))return!1;if(e===n)return!0;var s=vd(n);return!!s&&e===s[0]}function ma(e){var r=e&&e.constructor,t="function"==typeof r&&r.prototype||Sl;return e===t}function pa(e){return e===e&&!wi(e)}function fa(e,r){var t=e[1],n=r[1],a=t|n,s=a<(Z|X|se),i=n==se&&t==re||n==se&&t==ie&&e[7].length<=r[8]||n==(se|ie)&&r[7].length<=r[8]&&t==re;if(!s&&!i)return e;n&Z&&(e[2]=r[2],a|=t&Z?0:ee);var o=r[3];if(o){var l=e[3];e[3]=l?kn(l,o,r[4]):Dn(o),e[4]=l?z(e[3],xe):Dn(r[4])}return o=r[5],o&&(l=e[5],e[5]=l?On(l,o,r[6]):Dn(o),e[6]=l?z(e[5],xe):Dn(r[6])),o=r[7],o&&(e[7]=Dn(o)),n&se&&(e[8]=null==e[8]?r[8]:Yl(e[8],r[8])),null==e[9]&&(e[9]=r[9]),e[0]=r[0],e[1]=a,e}function _a(e,r,t,n,a,s){return wi(e)&&wi(r)&&(s.set(r,e),Ht(e,r,K,_a,s)),e}function va(e,r){return 1==r.length?e:ro(e,sn(r,0,-1))}function ga(e,r){for(var t=e.length,n=Yl(r.length,t),a=Dn(e);n--;){var s=r[n];e[n]=U(s,t)?a[s]:K}return e}function ha(e){var r=[];return Qi(e).replace(ur,function(e,t,n,a){r.push(n?a.replace(gr,"$1"):t||e)}),r}function ba(e){return di(e)?e:[]}function ya(e){return"function"==typeof e?e:Go}function wa(e){if(e instanceof a)return e.clone();var r=new n(e.__wrapped__,e.__chain__);return r.__actions__=Dn(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function Ca(e,r){r=Vl(Li(r),0);var t=e?e.length:0;if(!t||r<1)return[];for(var n=0,a=-1,s=Array(Wl(t/r));n<t;)s[++a]=sn(e,n,n+=r);return s}function Sa(e){for(var r=-1,t=e?e.length:0,n=-1,a=[];++r<t;){var s=e[r];s&&(a[++n]=s)}return a}function ka(e,r,t){var n=e?e.length:0;return n?(r=t||r===K?1:Li(r),sn(e,r<0?0:r,n)):[]}function Oa(e,r,t){var n=e?e.length:0;return n?(r=t||r===K?1:Li(r),r=n-r,sn(e,0,r<0?0:r)):[]}function Da(e,r){return e&&e.length?_n(e,Zn(r,3),!0,!0):[]}function xa(e,r){return e&&e.length?_n(e,Zn(r,3),!0):[]}function Aa(e,r,t,n){var a=e?e.length:0;return a?(t&&"number"!=typeof t&&la(e,r,t)&&(t=0,n=a),yt(e,r,t,n)):[]}function Ea(e,r){return e&&e.length?C(e,Zn(r,3)):-1}function qa(e,r){return e&&e.length?C(e,Zn(r,3),!0):-1}function Ta(e,r){var t=e?e.length:0;return t?Ct(_(e,Zn(r,3))):[]}function Ra(e){var r=e?e.length:0;return r?Ct(e):[]}function $a(e){var r=e?e.length:0;return r?Ct(e,!0):[]}function Pa(e){for(var r=-1,t=e?e.length:0,n={};++r<t;){var a=e[r];n[a[0]]=a[1]}return n}function ja(e){return e?e[0]:K}function Ia(e,r,t){var n=e?e.length:0;return n?(t=Li(t),t<0&&(t=Vl(n+t,0)),S(e,r,t)):-1}function Ma(e){return Oa(e,1)}function Fa(e,r){return e?Ql.call(e,r):""}function Na(e){var r=e?e.length:0;return r?e[r-1]:K}function La(e,r,t){var n=e?e.length:0;if(!n)return-1;var a=n;if(t!==K&&(a=Li(t),a=(a<0?Vl(n+a,0):Yl(a,n-1))+1),r!==r)return N(e,a,!0);for(;a--;)if(e[a]===r)return a;return-1}function Ua(e,r){return e&&e.length&&r&&r.length?Xt(e,r):e}function Wa(e,r,t){return e&&e.length&&r&&r.length?en(e,r,Zn(t)):e}function Ba(e,r){var t=[];if(!e||!e.length)return t;var n=-1,a=[],s=e.length;for(r=Zn(r,3);++n<s;){var i=e[n];r(i,n,e)&&(t.push(i),a.push(n))}return rn(e,a),t}function za(e){return e?Jl.call(e):e}function Qa(e,r,t){var n=e?e.length:0;return n?(t&&"number"!=typeof t&&la(e,r,t)?(r=0,t=n):(r=null==r?0:Li(r),t=t===K?n:Li(t)),sn(e,r,t)):[]}function Ha(e,r){return ln(e,r)}function Va(e,r,t){return dn(e,r,Zn(t))}function Ya(e,r){var t=e?e.length:0;if(t){var n=ln(e,r);if(n<t&&ai(e[n],r))return n}return-1}function Ga(e,r){return ln(e,r,!0)}function Ka(e,r,t){return dn(e,r,Zn(t),!0)}function Ja(e,r){var t=e?e.length:0;if(t){var n=ln(e,r,!0)-1;if(ai(e[n],r))return n}return-1}function Za(e){return e&&e.length?cn(e):[]}function Xa(e,r){return e&&e.length?un(e,Zn(r)):[]}function es(e){return ka(e,1)}function rs(e,r,t){return e&&e.length?(r=t||r===K?1:Li(r),sn(e,0,r<0?0:r)):[]}function ts(e,r,t){var n=e?e.length:0;return n?(r=t||r===K?1:Li(r),r=n-r,sn(e,r<0?0:r,n)):[]}function ns(e,r){return e&&e.length?_n(e,Zn(r,3),!1,!0):[]}function as(e,r){return e&&e.length?_n(e,Zn(r,3)):[]}function ss(e){return e&&e.length?pn(e):[]}function is(e,r){return e&&e.length?pn(e,Zn(r)):[]}function os(e,r){return e&&e.length?pn(e,K,r):[]}function ls(e){if(!e||!e.length)return[];var r=0;return e=m(e,function(e){if(di(e))return r=Vl(e.length,r),!0}),x(r,function(r){return _(e,Jt(r))})}function ds(e,r){if(!e||!e.length)return[];var t=ls(e);return null==r?t:_(t,function(e){return o(r,K,e)})}function cs(e,r){for(var t=-1,n=e?e.length:0,a=r?r.length:0,s={};++t<n;)an(s,e[t],t<a?r[t]:K);return s}function us(e){var t=r(e);return t.__chain__=!0,t}function ms(e,r){return r(e),e}function ps(e,r){return r(e)}function fs(){return us(this)}function _s(){return new n(this.value(),this.__chain__)}function vs(e){return this.map(e).flatten()}function gs(){this.__values__===K&&(this.__values__=Ni(this.value()));var e=this.__index__>=this.__values__.length,r=e?K:this.__values__[this.__index__++];return{done:e,value:r}}function hs(){return this}function bs(e){for(var r,n=this;n instanceof t;){var a=wa(n);a.__index__=0,a.__values__=K,r?s.__wrapped__=a:r=a;var s=a;n=n.__wrapped__}return s.__wrapped__=e,r}function ys(){var e=this.__wrapped__;if(e instanceof a){var r=e;return this.__actions__.length&&(r=new a(this)),r=r.reverse(),r.__actions__.push({func:ps,args:[za],thisArg:K}),new n(r,this.__chain__)}return this.thru(za)}function ws(){return vn(this.__wrapped__,this.__actions__)}function Cs(e,r,t){var n=ec(e)?u:bt;return t&&la(e,r,t)&&(r=K),n(e,Zn(r,3))}function Ss(e,r){var t=ec(e)?m:wt;return t(e,Zn(r,3))}function ks(e,r){if(r=Zn(r,3),ec(e)){var t=C(e,r);return t>-1?e[t]:K}return w(e,r,cd)}function Os(e,r){if(r=Zn(r,3),ec(e)){var t=C(e,r,!0);return t>-1?e[t]:K}return w(e,r,ud)}function Ds(e,r){return"function"==typeof r&&ec(e)?d(e,r):cd(e,ya(r))}function xs(e,r){return"function"==typeof r&&ec(e)?c(e,r):ud(e,ya(r))}function As(e,r,t,n){e=li(e)?e:bo(e),t=t&&!n?Li(t):0;var a=e.length;return t<0&&(t=Vl(a+t,0)),$i(e)?t<=a&&e.indexOf(r,t)>-1:!!a&&S(e,r,t)>-1}function Es(e,r){var t=ec(e)?_:Bt;return t(e,Zn(r,3))}function qs(e,r,t,n){return null==e?[]:(ec(r)||(r=null==r?[]:[r]),t=n?K:t,ec(t)||(t=null==t?[]:[t]),Yt(e,r,t))}function Ts(e,r,t){var n=ec(e)?g:k,a=arguments.length<3;return n(e,Zn(r,4),t,a,cd)}function Rs(e,r,t){var n=ec(e)?h:k,a=arguments.length<3;return n(e,Zn(r,4),t,a,ud)}function $s(e,r){var t=ec(e)?m:wt;return r=Zn(r,3),t(e,function(e,t,n){return!r(e,t,n)})}function Ps(e){var r=li(e)?e:bo(e),t=r.length;return t>0?r[tn(0,t-1)]:K}function js(e,r){var t=-1,n=Ni(e),a=n.length,s=a-1;for(r=st(Li(r),0,a);++t<r;){var i=tn(t,s),o=n[i];n[i]=n[t],n[t]=o}return n.length=r,n}function Is(e){return js(e,ke)}function Ms(e){if(null==e)return 0;if(li(e)){var r=e.length;return r&&$i(e)?H(e):r}return so(e).length}function Fs(e,r,t){var n=ec(e)?b:on;return t&&la(e,r,t)&&(r=K),n(e,Zn(r,3))}function Ns(e,r){if("function"!=typeof r)throw new wl(he);return e=Li(e),function(){if(--e<1)return r.apply(this,arguments)}}function Ls(e,r,t){return r=t?K:r,r=e&&null==r?e.length:r,Vn(e,se,K,K,K,K,r)}function Us(e,r){var t;if("function"!=typeof r)throw new wl(he);return e=Li(e),function(){return--e>0&&(t=r.apply(this,arguments)),e<=1&&(r=K),t}}function Ws(e,r,t){r=t?K:r;var n=Vn(e,re,K,K,K,K,K,r);return n.placeholder=Ws.placeholder,n}function Bs(e,r,t){r=t?K:r;var n=Vn(e,te,K,K,K,K,K,r);return n.placeholder=Bs.placeholder,n}function zs(e,r,t){function n(){f&&Pl(f),c&&Pl(c),v=0,d=c=p=f=_=K}function a(r,t){t&&Pl(t),c=f=_=K,r&&(v=Qd(),u=e.apply(p,d),f||c||(d=p=K))}function s(){var e=r-(Qd()-m);e<=0||e>r?a(_,c):f=Ll(s,e)}function i(){return(f&&_||c&&b)&&(u=e.apply(p,d)),n(),u}function o(){a(b,f)}function l(){if(d=arguments,m=Qd(),p=this,_=b&&(f||!g),h===!1)var t=g&&!f;else{c||g||(v=m);var n=h-(m-v),a=n<=0||n>h;a?(c&&(c=Pl(c)),v=m,u=e.apply(p,d)):c||(c=Ll(o,n))}return a&&f?f=Pl(f):f||r===h||(f=Ll(s,r)),t&&(a=!0,u=e.apply(p,d)),!a||f||c||(d=p=K),u}var d,c,u,m,p,f,_,v=0,g=!1,h=!1,b=!0;
if("function"!=typeof e)throw new wl(he);return r=Wi(r)||0,wi(t)&&(g=!!t.leading,h="maxWait"in t&&Vl(Wi(t.maxWait)||0,r),b="trailing"in t?!!t.trailing:b),l.cancel=n,l.flush=i,l}function Qs(e){return Vn(e,oe)}function Hs(e,r){if("function"!=typeof e||r&&"function"!=typeof r)throw new wl(he);var t=function(){var n=arguments,a=r?r.apply(this,n):n[0],s=t.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return t.cache=s.set(a,i),i};return t.cache=new Hs.Cache,t}function Vs(e){if("function"!=typeof e)throw new wl(he);return function(){return!e.apply(this,arguments)}}function Ys(e){return Us(2,e)}function Gs(e,r){if("function"!=typeof e)throw new wl(he);return r=Vl(r===K?e.length-1:Li(r),0),function(){for(var t=arguments,n=-1,a=Vl(t.length-r,0),s=Array(a);++n<a;)s[n]=t[r+n];switch(r){case 0:return e.call(this,s);case 1:return e.call(this,t[0],s);case 2:return e.call(this,t[0],t[1],s)}var i=Array(r+1);for(n=-1;++n<r;)i[n]=t[n];return i[r]=s,o(e,this,i)}}function Ks(e){if("function"!=typeof e)throw new wl(he);return function(r){return o(e,this,r)}}function Js(e,r,t){var n=!0,a=!0;if("function"!=typeof e)throw new wl(he);return wi(t)&&(n="leading"in t?!!t.leading:n,a="trailing"in t?!!t.trailing:a),zs(e,r,{leading:n,maxWait:r,trailing:a})}function Zs(e){return Ls(e,1)}function Xs(e,r){return r=null==r?Go:r,Jd(r,e)}function ei(e){return it(e)}function ri(e,r){return it(e,!1,r)}function ti(e){return it(e,!0)}function ni(e,r){return it(e,!0,r)}function ai(e,r){return e===r||e!==e&&r!==r}function si(e,r){return e>r}function ii(e,r){return e>=r}function oi(e){return di(e)&&Ol.call(e,"callee")&&(!Nl.call(e,"callee")||Al.call(e)==Ae)}function li(e){return null!=e&&!("function"==typeof e&&hi(e))&&yi(gd(e))}function di(e){return Ci(e)&&li(e)}function ci(e){return e===!0||e===!1||Ci(e)&&Al.call(e)==qe}function ui(e){return Ci(e)&&Al.call(e)==Te}function mi(e){return!!e&&1===e.nodeType&&Ci(e)&&!qi(e)}function pi(e){return!Ci(e)||hi(e.splice)?!Ms(e):!so(e).length}function fi(e,r){return Mt(e,r)}function _i(e,r,t){t="function"==typeof t?t:K;var n=t?t(e,r):K;return n===K?Mt(e,r,t):!!n}function vi(e){return Ci(e)&&"string"==typeof e.message&&Al.call(e)==Re}function gi(e){return"number"==typeof e&&zl(e)}function hi(e){var r=wi(e)?Al.call(e):"";return r==$e||r==Pe}function bi(e){return"number"==typeof e&&e==Li(e)}function yi(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=we}function wi(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function Ci(e){return!!e&&"object"==typeof e}function Si(e,r){return e===r||Nt(e,r,Xn(r))}function ki(e,r,t){return t="function"==typeof t?t:K,Nt(e,r,Xn(r),t)}function Oi(e){return Ei(e)&&e!=+e}function Di(e){return null!=e&&(hi(e)?ql.test(kl.call(e)):Ci(e)&&(L(e)?ql:Sr).test(e))}function xi(e){return null===e}function Ai(e){return null==e}function Ei(e){return"number"==typeof e||Ci(e)&&Al.call(e)==Ie}function qi(e){if(!Ci(e)||Al.call(e)!=Me||L(e))return!1;var r=Sl;if("function"==typeof e.constructor&&(r=Il(e)),null===r)return!0;var t=r.constructor;return"function"==typeof t&&t instanceof t&&kl.call(t)==xl}function Ti(e){return wi(e)&&Al.call(e)==Fe}function Ri(e){return bi(e)&&e>=-we&&e<=we}function $i(e){return"string"==typeof e||!ec(e)&&Ci(e)&&Al.call(e)==Le}function Pi(e){return"symbol"==typeof e||Ci(e)&&Al.call(e)==Ue}function ji(e){return Ci(e)&&yi(e.length)&&!!gt[Al.call(e)]}function Ii(e){return e===K}function Mi(e,r){return e<r}function Fi(e,r){return e<=r}function Ni(e){if(!e)return[];if(li(e))return $i(e)?V(e):Dn(e);if(Fl&&e[Fl])return W(e[Fl]());var r=ra(e),t=r==je?B:r==Ne?Q:bo;return t(e)}function Li(e){if(!e)return 0===e?e:0;if(e=Wi(e),e===ye||e===-ye){var r=e<0?-1:1;return r*Ce}var t=e%1;return e===e?t?e-t:e:0}function Ui(e){return e?st(Li(e),0,ke):0}function Wi(e){if(wi(e)){var r=hi(e.valueOf)?e.valueOf():e;e=wi(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(fr,"");var t=Cr.test(e);return t||kr.test(e)?Ot(e.slice(2),t?2:8):wr.test(e)?Se:+e}function Bi(e){return xn(e,io(e))}function zi(e){return st(Li(e),-we,we)}function Qi(e){if("string"==typeof e)return e;if(null==e)return"";if(Pi(e))return Rl?od.call(e):"";var r=e+"";return"0"==r&&1/e==-ye?"-0":r}function Hi(e,r){var t=dd(e);return r?nt(t,r):t}function Vi(e,r){return w(e,Zn(r,3),Dt,!0)}function Yi(e,r){return w(e,Zn(r,3),xt,!0)}function Gi(e,r){return null==e?e:md(e,ya(r),io)}function Ki(e,r){return null==e?e:pd(e,ya(r),io)}function Ji(e,r){return e&&Dt(e,ya(r))}function Zi(e,r){return e&&xt(e,ya(r))}function Xi(e){return null==e?[]:At(e,so(e))}function eo(e){return null==e?[]:At(e,io(e))}function ro(e,r,t){var n=null==e?K:Et(e,r);return n===K?t:n}function to(e,r){return na(e,r,qt)}function no(e,r){return na(e,r,Tt)}function ao(e,r,t){return g(so(e),function(n,a){var s=e[a];return r&&!t?Ol.call(n,s)?n[s].push(a):n[s]=[a]:n[s]=a,n},{})}function so(e){var r=ma(e);if(!r&&!li(e))return Ut(e);var t=oa(e),n=!!t,a=t||[],s=a.length;for(var i in e)!qt(e,i)||n&&("length"==i||U(i,s))||r&&"constructor"==i||a.push(i);return a}function io(e){for(var r=-1,t=ma(e),n=Wt(e),a=n.length,s=oa(e),i=!!s,o=s||[],l=o.length;++r<a;){var d=n[r];i&&("length"==d||U(d,l))||"constructor"==d&&(t||!Ol.call(e,d))||o.push(d)}return o}function oo(e,r){var t={};return r=Zn(r,3),Dt(e,function(e,n,a){t[r(e,n,a)]=e}),t}function lo(e,r){var t={};return r=Zn(r,3),Dt(e,function(e,n,a){t[n]=r(e,n,a)}),t}function co(e,r){return r=Zn(r,2),Kt(e,function(e,t){return!r(e,t)})}function uo(e,r){return null==e?{}:Kt(e,Zn(r,2))}function mo(e,r,t){if(da(r,e))n=null==e?K:e[r];else{r=mn(r);var n=ro(e,r);e=va(e,r)}return n===K&&(n=t),hi(n)?n.call(e):n}function po(e,r,t){return null==e?e:an(e,r,t)}function fo(e,r,t,n){return n="function"==typeof n?n:K,null==e?e:an(e,r,t,n)}function _o(e){return A(e,so(e))}function vo(e){return A(e,io(e))}function go(e,r,t){var n=ec(e)||ji(e);if(r=Zn(r,4),null==t)if(n||wi(e)){var a=e.constructor;t=n?ec(e)?new a:[]:dd(hi(a)?a.prototype:K)}else t={};return(n?d:Dt)(e,function(e,n,a){return r(t,e,n,a)}),t}function ho(e,r){return null==e||fn(e,r)}function bo(e){return e?q(e,so(e)):[]}function yo(e){return null==e?q(e,io(e)):[]}function wo(e,r,t){return t===K&&(t=r,r=K),t!==K&&(t=Wi(t),t=t===t?t:0),r!==K&&(r=Wi(r),r=r===r?r:0),st(Wi(e),r,t)}function Co(e,r,t){return r=Wi(r)||0,t===K?(t=r,r=0):t=Wi(t)||0,e=Wi(e),Pt(e,r,t)}function So(e,r,t){if(t&&"boolean"!=typeof t&&la(e,r,t)&&(r=t=K),t===K&&("boolean"==typeof r?(t=r,r=K):"boolean"==typeof e&&(t=e,e=K)),e===K&&r===K?(e=0,r=1):(e=Wi(e)||0,r===K?(r=e,e=0):r=Wi(r)||0),e>r){var n=e;e=r,r=n}if(t||e%1||r%1){var a=Kl();return Yl(e+a*(r-e+kt("1e-"+((a+"").length-1))),r)}return tn(e,r)}function ko(e){return gc(Qi(e).toLowerCase())}function Oo(e){return e=Qi(e),e&&e.replace(Dr,I).replace(dt,"")}function Do(e,r,t){e=Qi(e),r="string"==typeof r?r:r+"";var n=e.length;return t=t===K?n:st(Li(t),0,n),t-=r.length,t>=0&&e.indexOf(r,t)==t}function xo(e){return e=Qi(e),e&&sr.test(e)?e.replace(nr,M):e}function Ao(e){return e=Qi(e),e&&pr.test(e)?e.replace(mr,"\\$&"):e}function Eo(e,r,t){e=Qi(e),r=Li(r);var n=H(e);if(!r||n>=r)return e;var a=(r-n)/2,s=Bl(a),i=Wl(a);return Wn("",s,t)+e+Wn("",i,t)}function qo(e,r,t){return e=Qi(e),e+Wn(e,r,t)}function To(e,r,t){return e=Qi(e),Wn(e,r,t)+e}function Ro(e,r,t){return t||null==r?r=0:r&&(r=+r),e=Qi(e).replace(fr,""),Gl(e,r||(yr.test(e)?16:10))}function $o(e,r){e=Qi(e),r=Li(r);var t="";if(!e||r<1||r>we)return t;do r%2&&(t+=e),r=Bl(r/2),e+=e;while(r);return t}function Po(){var e=arguments,r=Qi(e[0]);return e.length<3?r:r.replace(e[1],e[2])}function jo(e,r,t){return Qi(e).split(r,t)}function Io(e,r,t){return e=Qi(e),t=st(Li(t),0,e.length),e.lastIndexOf(r,t)==t}function Mo(e,t,n){var a=r.templateSettings;n&&la(e,t,n)&&(t=K),e=Qi(e),t=nc({},t,a,et);var s,i,o=nc({},t.imports,a.imports,et),l=so(o),d=q(o,l),c=0,u=t.interpolate||xr,m="__p += '",p=yl((t.escape||xr).source+"|"+u.source+"|"+(u===lr?hr:xr).source+"|"+(t.evaluate||xr).source+"|$","g"),f="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++vt+"]")+"\n";e.replace(p,function(r,t,n,a,o,l){return n||(n=a),m+=e.slice(c,l).replace(Ar,F),t&&(s=!0,m+="' +\n__e("+t+") +\n'"),o&&(i=!0,m+="';\n"+o+";\n__p += '"),n&&(m+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=l+r.length,r}),m+="';\n";var _=t.variable;_||(m="with (obj) {\n"+m+"\n}\n"),m=(i?m.replace(Xe,""):m).replace(er,"$1").replace(rr,"$1;"),m="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var v=wc(function(){return Function(l,f+"return "+m).apply(K,d)});if(v.source=m,vi(v))throw v;return v}function Fo(e){return Qi(e).toLowerCase()}function No(e){return Qi(e).toUpperCase()}function Lo(e,r,t){if(e=Qi(e),!e)return e;if(t||r===K)return e.replace(fr,"");if(r+="",!r)return e;var n=V(e),a=V(r);return n.slice(T(n,a),R(n,a)+1).join("")}function Uo(e,r,t){if(e=Qi(e),!e)return e;if(t||r===K)return e.replace(vr,"");if(r+="",!r)return e;var n=V(e);return n.slice(0,R(n,V(r))+1).join("")}function Wo(e,r,t){if(e=Qi(e),!e)return e;if(t||r===K)return e.replace(_r,"");if(r+="",!r)return e;var n=V(e);return n.slice(T(n,V(r))).join("")}function Bo(e,r){var t=ce,n=ue;if(wi(r)){var a="separator"in r?r.separator:a;t="length"in r?Li(r.length):t,n="omission"in r?Qi(r.omission):n}e=Qi(e);var s=e.length;if(ut.test(e)){var i=V(e);s=i.length}if(t>=s)return e;var o=t-H(n);if(o<1)return n;var l=i?i.slice(0,o).join(""):e.slice(0,o);if(a===K)return l+n;if(i&&(o+=l.length-o),Ti(a)){if(e.slice(o).search(a)){var d,c=l;for(a.global||(a=yl(a.source,Qi(br.exec(a))+"g")),a.lastIndex=0;d=a.exec(c);)var u=d.index;l=l.slice(0,u===K?o:u)}}else if(e.indexOf(a,o)!=o){var m=l.lastIndexOf(a);m>-1&&(l=l.slice(0,m))}return l+n}function zo(e){return e=Qi(e),e&&ar.test(e)?e.replace(tr,Y):e}function Qo(e,r,t){return e=Qi(e),r=t?K:r,r===K&&(r=ft.test(e)?pt:mt),e.match(r)||[]}function Ho(e){var r=e?e.length:0,t=Zn();return e=r?_(e,function(e){if("function"!=typeof e[1])throw new wl(he);return[t(e[0]),e[1]]}):[],Gs(function(t){for(var n=-1;++n<r;){var a=e[n];if(o(a[0],this,t))return o(a[1],this,t)}})}function Vo(e){return ot(it(e,!0))}function Yo(e){return function(){return e}}function Go(e){return e}function Ko(e){return Ci(e)&&!ec(e)?Jo(e):Lt(e)}function Jo(e){return zt(it(e,!0))}function Zo(e,r){return Qt(e,it(r,!0))}function Xo(e,r,t){var n=so(r),a=At(r,n);null!=t||wi(r)&&(a.length||!n.length)||(t=r,r=e,e=this,a=At(r,so(r)));var s=!(wi(t)&&"chain"in t)||t.chain,i=hi(e);return d(a,function(t){var n=r[t];e[t]=n,i&&(e.prototype[t]=function(){var r=this.__chain__;if(s||r){var t=e(this.__wrapped__),a=t.__actions__=Dn(this.__actions__);return a.push({func:n,args:arguments,thisArg:e}),t.__chain__=r,t}return n.apply(e,v([this.value()],arguments))})}),e}function el(){return Rt._===this&&(Rt._=El),this}function rl(){}function tl(e){return e=Li(e),function(){return arguments[e]}}function nl(e){return da(e)?Jt(e):Zt(e)}function al(e){return function(r){return null==e?K:Et(e,r)}}function sl(e,r){if(e=Li(e),e<1||e>we)return[];var t=ke,n=Yl(e,ke);r=ya(r),e-=ke;for(var a=x(n,r);++t<e;)r(t);return a}function il(e){return ec(e)?_(e,String):ha(e)}function ol(e){var r=++Dl;return Qi(e)+r}function ll(e,r){var t;return e!==K&&(t=e),r!==K&&(t=t===K?r:t+r),t}function dl(e){return e&&e.length?y(e,Go,si):K}function cl(e,r){return e&&e.length?y(e,Zn(r),si):K}function ul(e){return _l(e)/(e?e.length:0)}function ml(e){return e&&e.length?y(e,Go,Mi):K}function pl(e,r){return e&&e.length?y(e,Zn(r),Mi):K}function fl(e,r){var t;return e!==K&&(t=e),r!==K&&(t=t===K?r:t-r),t}function _l(e){return e&&e.length?D(e,Go):K}function vl(e,r){return e&&e.length?D(e,Zn(r)):K}e=e?$t.defaults({},e,$t.pick(Rt,_t)):Rt;var gl=e.Date,hl=e.Error,bl=e.Math,yl=e.RegExp,wl=e.TypeError,Cl=e.Array.prototype,Sl=e.Object.prototype,kl=e.Function.prototype.toString,Ol=Sl.hasOwnProperty,Dl=0,xl=kl.call(Object),Al=Sl.toString,El=Rt._,ql=yl("^"+kl.call(Ol).replace(mr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tl=e.Reflect,Rl=e.Symbol,$l=e.Uint8Array,Pl=e.clearTimeout,jl=Tl?Tl.enumerate:K,Il=Object.getPrototypeOf,Ml=Object.getOwnPropertySymbols,Fl="symbol"==typeof(Fl=Rl&&Rl.iterator)?Fl:K,Nl=Sl.propertyIsEnumerable,Ll=e.setTimeout,Ul=Cl.splice,Wl=bl.ceil,Bl=bl.floor,zl=e.isFinite,Ql=Cl.join,Hl=Object.keys,Vl=bl.max,Yl=bl.min,Gl=e.parseInt,Kl=bl.random,Jl=Cl.reverse,Zl=ea(e,"Map"),Xl=ea(e,"Set"),ed=ea(e,"WeakMap"),rd=ea(Object,"create"),td=ed&&new ed,nd=Zl?kl.call(Zl):"",ad=Xl?kl.call(Xl):"",sd=Rl?Rl.prototype:K,id=Rl?sd.valueOf:K,od=Rl?sd.toString:K,ld={};r.templateSettings={escape:ir,evaluate:or,interpolate:lr,variable:"",imports:{_:r}};var dd=function(){function e(){}return function(r){if(wi(r)){e.prototype=r;var t=new e;e.prototype=K}return t||{}}}(),cd=Rn(Dt),ud=Rn(xt,!0),md=$n(),pd=$n(!0);jl&&!Nl.call({valueOf:1},"valueOf")&&(Wt=function(e){return W(jl(e))});var fd=td?function(e,r){return td.set(e,r),e}:Go,_d=Xl&&2===new Xl([1,2]).size?function(e){return new Xl(e)}:rl,vd=td?function(e){return td.get(e)}:rl,gd=Jt("length"),hd=Ml||function(){return[]};(Zl&&ra(new Zl)!=je||Xl&&ra(new Xl)!=Ne)&&(ra=function(e){var r=Al.call(e),t=r==Me?e.constructor:null,n="function"==typeof t?kl.call(t):"";if(n){if(n==nd)return je;if(n==ad)return Ne}return r});var bd=function(){var e=0,r=0;return function(t,n){var a=Qd(),s=pe-(a-r);if(r=a,s>0){if(++e>=me)return t}else e=0;return fd(t,n)}}(),yd=Gs(function(e,r){return ec(e)||(e=null==e?[]:[Object(e)]),r=Ct(r),l(e,r)}),wd=Gs(function(e,r){return di(e)?ct(e,Ct(r,!1,!0)):[]}),Cd=Gs(function(e,r){var t=Na(r);return di(t)&&(t=K),di(e)?ct(e,Ct(r,!1,!0),Zn(t)):[]}),Sd=Gs(function(e,r){var t=Na(r);return di(t)&&(t=K),di(e)?ct(e,Ct(r,!1,!0),K,t):[]}),kd=Gs(function(e){var r=_(e,ba);return r.length&&r[0]===e[0]?jt(r):[]}),Od=Gs(function(e){var r=Na(e),t=_(e,ba);return r===Na(t)?r=K:t.pop(),t.length&&t[0]===e[0]?jt(t,Zn(r)):[]}),Dd=Gs(function(e){var r=Na(e),t=_(e,ba);return r===Na(t)?r=K:t.pop(),t.length&&t[0]===e[0]?jt(t,K,r):[]}),xd=Gs(Ua),Ad=Gs(function(e,r){r=_(Ct(r),String);var t=at(e,r);return rn(e,r.sort(P)),t}),Ed=Gs(function(e){return pn(Ct(e,!1,!0))}),qd=Gs(function(e){var r=Na(e);return di(r)&&(r=K),pn(Ct(e,!1,!0),Zn(r))}),Td=Gs(function(e){var r=Na(e);return di(r)&&(r=K),pn(Ct(e,!1,!0),K,r)}),Rd=Gs(function(e,r){return di(e)?ct(e,r):[]}),$d=Gs(function(e){return gn(m(e,di))}),Pd=Gs(function(e){var r=Na(e);return di(r)&&(r=K),gn(m(e,di),Zn(r))}),jd=Gs(function(e){var r=Na(e);return di(r)&&(r=K),gn(m(e,di),K,r)}),Id=Gs(ls),Md=Gs(function(e){var r=e.length,t=r>1?e[r-1]:K;return t="function"==typeof t?(e.pop(),t):K,ds(e,t)}),Fd=Gs(function(e){e=Ct(e);var r=e.length,t=r?e[0]:0,s=this.__wrapped__,i=function(r){return at(r,e)};return!(r>1||this.__actions__.length)&&s instanceof a&&U(t)?(s=s.slice(t,+t+(r?1:0)),s.__actions__.push({func:ps,args:[i],thisArg:K}),new n(s,this.__chain__).thru(function(e){return r&&!e.length&&e.push(K),e})):this.thru(i)}),Nd=qn(function(e,r,t){Ol.call(e,t)?++e[t]:e[t]=1}),Ld=qn(function(e,r,t){Ol.call(e,t)?e[t].push(r):e[t]=[r]}),Ud=Gs(function(e,r,t){var n=-1,a="function"==typeof r,s=da(r),i=li(e)?Array(e.length):[];return cd(e,function(e){var l=a?r:s&&null!=e?e[r]:K;i[++n]=l?o(l,e,t):It(e,r,t)}),i}),Wd=qn(function(e,r,t){e[t]=r}),Bd=qn(function(e,r,t){e[t?0:1].push(r)},function(){return[[],[]]}),zd=Gs(function(e,r){if(null==e)return[];var t=r.length;return t>1&&la(e,r[0],r[1])?r=[]:t>2&&la(r[0],r[1],r[2])&&(r.length=1),Yt(e,Ct(r),[])}),Qd=gl.now,Hd=Gs(function(e,r,t){var n=Z;if(t.length){var a=z(t,Hd.placeholder);n|=ne}return Vn(e,n,r,t,a)}),Vd=Gs(function(e,r,t){var n=Z|X;if(t.length){var a=z(t,Vd.placeholder);n|=ne}return Vn(r,n,e,t,a)}),Yd=Gs(function(e,r){return lt(e,1,r)}),Gd=Gs(function(e,r,t){return lt(e,Wi(r)||0,t)}),Kd=Gs(function(e,r){r=_(Ct(r),Zn());var t=r.length;return Gs(function(n){for(var a=-1,s=Yl(n.length,t);++a<s;)n[a]=r[a].call(this,n[a]);return o(e,this,n)})}),Jd=Gs(function(e,r){var t=z(r,Jd.placeholder);return Vn(e,ne,K,r,t)}),Zd=Gs(function(e,r){var t=z(r,Zd.placeholder);return Vn(e,ae,K,r,t)}),Xd=Gs(function(e,r){return Vn(e,ie,K,K,K,Ct(r))}),ec=Array.isArray,rc=Tn(function(e,r){xn(r,so(r),e)}),tc=Tn(function(e,r){xn(r,io(r),e)}),nc=Tn(function(e,r,t,n){An(r,io(r),e,n)}),ac=Tn(function(e,r,t,n){An(r,so(r),e,n)}),sc=Gs(function(e,r){return at(e,Ct(r))}),ic=Gs(function(e){return e.push(K,et),o(nc,K,e)}),oc=Gs(function(e){return e.push(K,_a),o(cc,K,e)}),lc=Gs(It),dc=Tn(function(e,r,t){Ht(e,r,t)}),cc=Tn(function(e,r,t,n){Ht(e,r,t,n)}),uc=Gs(function(e,r){return null==e?{}:(r=_(Ct(r),String),Gt(e,ct(io(e),r)))}),mc=Gs(function(e,r){return null==e?{}:Gt(e,Ct(r))}),pc=In(function(e,r,t){return r=r.toLowerCase(),e+(t?ko(r):r)}),fc=In(function(e,r,t){return e+(t?"-":"")+r.toLowerCase()}),_c=In(function(e,r,t){return e+(t?" ":"")+r.toLowerCase()}),vc=jn("toLowerCase"),gc=jn("toUpperCase"),hc=In(function(e,r,t){return e+(t?"_":"")+r.toLowerCase()}),bc=In(function(e,r,t){return e+(t?" ":"")+ko(r)}),yc=In(function(e,r,t){return e+(t?" ":"")+r.toUpperCase()}),wc=Gs(function(e,r){try{return o(e,K,r)}catch(e){return vi(e)?e:new hl(e)}}),Cc=Gs(function(e,r){return d(Ct(r),function(r){e[r]=Hd(e[r],e)}),e}),Sc=Nn(),kc=Nn(!0),Oc=Gs(function(e,r){return function(t){return It(t,e,r)}}),Dc=Gs(function(e,r){return function(t){return It(e,t,r)}}),xc=Un(_),Ac=Un(u),Ec=Un(b),qc=zn(),Tc=zn(!0),Rc=Hn("ceil"),$c=Hn("floor"),Pc=Hn("round");return r.prototype=t.prototype,n.prototype=dd(t.prototype),n.prototype.constructor=n,a.prototype=dd(t.prototype),a.prototype.constructor=a,Er.prototype=rd?rd(null):Sl,Pr.prototype.clear=jr,Pr.prototype.delete=Ir,Pr.prototype.get=Mr,Pr.prototype.has=Fr,Pr.prototype.set=Nr,Lr.prototype.push=Wr,Br.prototype.clear=zr,Br.prototype.delete=Qr,Br.prototype.get=Hr,Br.prototype.has=Vr,Br.prototype.set=Yr,Hs.Cache=Pr,r.after=Ns,r.ary=Ls,r.assign=rc,r.assignIn=tc,r.assignInWith=nc,r.assignWith=ac,r.at=sc,r.before=Us,r.bind=Hd,r.bindAll=Cc,r.bindKey=Vd,r.chain=us,r.chunk=Ca,r.compact=Sa,r.concat=yd,r.cond=Ho,r.conforms=Vo,r.constant=Yo,r.countBy=Nd,r.create=Hi,r.curry=Ws,r.curryRight=Bs,r.debounce=zs,r.defaults=ic,r.defaultsDeep=oc,r.defer=Yd,r.delay=Gd,r.difference=wd,r.differenceBy=Cd,r.differenceWith=Sd,r.drop=ka,r.dropRight=Oa,r.dropRightWhile=Da,r.dropWhile=xa,r.fill=Aa,r.filter=Ss,r.flatMap=Ta,r.flatten=Ra,r.flattenDeep=$a,r.flip=Qs,r.flow=Sc,r.flowRight=kc,r.fromPairs=Pa,r.functions=Xi,r.functionsIn=eo,r.groupBy=Ld,r.initial=Ma,r.intersection=kd,r.intersectionBy=Od,r.intersectionWith=Dd,r.invert=ao,r.invokeMap=Ud,r.iteratee=Ko,r.keyBy=Wd,r.keys=so,r.keysIn=io,r.map=Es,r.mapKeys=oo,r.mapValues=lo,r.matches=Jo,r.matchesProperty=Zo,r.memoize=Hs,r.merge=dc,r.mergeWith=cc,r.method=Oc,r.methodOf=Dc,r.mixin=Xo,r.negate=Vs,r.nthArg=tl,r.omit=uc,r.omitBy=co,r.once=Ys,r.orderBy=qs,r.over=xc,r.overArgs=Kd,r.overEvery=Ac,r.overSome=Ec,r.partial=Jd,r.partialRight=Zd,r.partition=Bd,r.pick=mc,r.pickBy=uo,r.property=nl,r.propertyOf=al,r.pull=xd,r.pullAll=Ua,r.pullAllBy=Wa,r.pullAt=Ad,r.range=qc,r.rangeRight=Tc,r.rearg=Xd,r.reject=$s,r.remove=Ba,r.rest=Gs,r.reverse=za,r.sampleSize=js,r.set=po,r.setWith=fo,r.shuffle=Is,r.slice=Qa,r.sortBy=zd,r.sortedUniq=Za,r.sortedUniqBy=Xa,r.split=jo,r.spread=Ks,r.tail=es,r.take=rs,r.takeRight=ts,r.takeRightWhile=ns,r.takeWhile=as,r.tap=ms,r.throttle=Js,r.thru=ps,r.toArray=Ni,r.toPairs=_o,r.toPairsIn=vo,r.toPath=il,r.toPlainObject=Bi,r.transform=go,r.unary=Zs,r.union=Ed,r.unionBy=qd,r.unionWith=Td,r.uniq=ss,r.uniqBy=is,r.uniqWith=os,r.unset=ho,r.unzip=ls,r.unzipWith=ds,r.values=bo,r.valuesIn=yo,r.without=Rd,r.words=Qo,r.wrap=Xs,r.xor=$d,r.xorBy=Pd,r.xorWith=jd,r.zip=Id,r.zipObject=cs,r.zipWith=Md,r.extend=tc,r.extendWith=nc,Xo(r,r),r.add=ll,r.attempt=wc,r.camelCase=pc,r.capitalize=ko,r.ceil=Rc,r.clamp=wo,r.clone=ei,r.cloneDeep=ti,r.cloneDeepWith=ni,r.cloneWith=ri,r.deburr=Oo,r.endsWith=Do,r.eq=ai,r.escape=xo,r.escapeRegExp=Ao,r.every=Cs,r.find=ks,r.findIndex=Ea,r.findKey=Vi,r.findLast=Os,r.findLastIndex=qa,r.findLastKey=Yi,r.floor=$c,r.forEach=Ds,r.forEachRight=xs,r.forIn=Gi,r.forInRight=Ki,r.forOwn=Ji,r.forOwnRight=Zi,r.get=ro,r.gt=si,r.gte=ii,r.has=to,r.hasIn=no,r.head=ja,r.identity=Go,r.includes=As,r.indexOf=Ia,r.inRange=Co,r.invoke=lc,r.isArguments=oi,r.isArray=ec,r.isArrayLike=li,r.isArrayLikeObject=di,r.isBoolean=ci,r.isDate=ui,r.isElement=mi,r.isEmpty=pi,r.isEqual=fi,r.isEqualWith=_i,r.isError=vi,r.isFinite=gi,r.isFunction=hi,r.isInteger=bi,r.isLength=yi,r.isMatch=Si,r.isMatchWith=ki,r.isNaN=Oi,r.isNative=Di,r.isNil=Ai,r.isNull=xi,r.isNumber=Ei,r.isObject=wi,r.isObjectLike=Ci,r.isPlainObject=qi,r.isRegExp=Ti,r.isSafeInteger=Ri,r.isString=$i,r.isSymbol=Pi,r.isTypedArray=ji,r.isUndefined=Ii,r.join=Fa,r.kebabCase=fc,r.last=Na,r.lastIndexOf=La,r.lowerCase=_c,r.lowerFirst=vc,r.lt=Mi,r.lte=Fi,r.max=dl,r.maxBy=cl,r.mean=ul,r.min=ml,r.minBy=pl,r.noConflict=el,r.noop=rl,r.now=Qd,r.pad=Eo,r.padEnd=qo,r.padStart=To,r.parseInt=Ro,r.random=So,r.reduce=Ts,r.reduceRight=Rs,r.repeat=$o,r.replace=Po,r.result=mo,r.round=Pc,r.runInContext=G,r.sample=Ps,r.size=Ms,r.snakeCase=hc,r.some=Fs,r.sortedIndex=Ha,r.sortedIndexBy=Va,r.sortedIndexOf=Ya,r.sortedLastIndex=Ga,r.sortedLastIndexBy=Ka,r.sortedLastIndexOf=Ja,r.startCase=bc,r.startsWith=Io,r.subtract=fl,r.sum=_l,r.sumBy=vl,r.template=Mo,r.times=sl,r.toInteger=Li,r.toLength=Ui,r.toLower=Fo,r.toNumber=Wi,r.toSafeInteger=zi,r.toString=Qi,r.toUpper=No,r.trim=Lo,r.trimEnd=Uo,r.trimStart=Wo,r.truncate=Bo,r.unescape=zo,r.uniqueId=ol,r.upperCase=yc,r.upperFirst=gc,r.each=Ds,r.eachRight=xs,r.first=ja,Xo(r,function(){var e={};return Dt(r,function(t,n){Ol.call(r.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),r.VERSION=J,d(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){r[e].placeholder=r}),d(["drop","take"],function(e,r){a.prototype[e]=function(t){var n=this.__filtered__;if(n&&!r)return new a(this);t=t===K?1:Vl(Li(t),0);var s=this.clone();return n?s.__takeCount__=Yl(t,s.__takeCount__):s.__views__.push({size:Yl(t,ke),type:e+(s.__dir__<0?"Right":"")}),s},a.prototype[e+"Right"]=function(r){return this.reverse()[e](r).reverse()}}),d(["filter","map","takeWhile"],function(e,r){var t=r+1,n=t==_e||t==ge;a.prototype[e]=function(e){var r=this.clone();return r.__iteratees__.push({iteratee:Zn(e,3),type:t}),r.__filtered__=r.__filtered__||n,r}}),d(["head","last"],function(e,r){var t="take"+(r?"Right":"");a.prototype[e]=function(){return this[t](1).value()[0]}}),d(["initial","tail"],function(e,r){var t="drop"+(r?"":"Right");a.prototype[e]=function(){return this.__filtered__?new a(this):this[t](1)}}),a.prototype.compact=function(){return this.filter(Go)},a.prototype.find=function(e){return this.filter(e).head()},a.prototype.findLast=function(e){return this.reverse().find(e)},a.prototype.invokeMap=Gs(function(e,r){return"function"==typeof e?new a(this):this.map(function(t){return It(t,e,r)})}),a.prototype.reject=function(e){return e=Zn(e,3),this.filter(function(r){return!e(r)})},a.prototype.slice=function(e,r){e=Li(e);var t=this;return t.__filtered__&&(e>0||r<0)?new a(t):(e<0?t=t.takeRight(-e):e&&(t=t.drop(e)),r!==K&&(r=Li(r),t=r<0?t.dropRight(-r):t.take(r-e)),t)},a.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},a.prototype.toArray=function(){return this.take(ke)},Dt(a.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=r[i?"take"+("last"==t?"Right":""):t],l=i||/^find/.test(t);o&&(r.prototype[t]=function(){var t=this.__wrapped__,d=i?[1]:arguments,c=t instanceof a,u=d[0],m=c||ec(t),p=function(e){var t=o.apply(r,v([e],d));return i&&f?t[0]:t};m&&s&&"function"==typeof u&&1!=u.length&&(c=m=!1);var f=this.__chain__,_=!!this.__actions__.length,g=l&&!f,h=c&&!_;if(!l&&m){t=h?t:new a(this);var b=e.apply(t,d);return b.__actions__.push({func:ps,args:[p],thisArg:K}),new n(b,f)}return g&&h?e.apply(this,d):(b=this.thru(p),g?i?b.value()[0]:b.value():b)})}),d(["pop","push","shift","sort","splice","unshift"],function(e){var t=Cl[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);r.prototype[e]=function(){var e=arguments;return a&&!this.__chain__?t.apply(this.value(),e):this[n](function(r){return t.apply(r,e)})}}),Dt(a.prototype,function(e,t){var n=r[t];if(n){var a=n.name+"",s=ld[a]||(ld[a]=[]);s.push({name:t,func:n})}}),ld[Ln(K,X).name]=[{name:"wrapper",func:K}],a.prototype.clone=$,a.prototype.reverse=We,a.prototype.value=Or,r.prototype.at=Fd,r.prototype.chain=fs,r.prototype.commit=_s,r.prototype.flatMap=vs,r.prototype.next=gs,r.prototype.plant=bs,r.prototype.reverse=ys,r.prototype.toJSON=r.prototype.valueOf=r.prototype.value=ws,Fl&&(r.prototype[Fl]=hs),r}var K,J="4.0.1",Z=1,X=2,ee=4,re=8,te=16,ne=32,ae=64,se=128,ie=256,oe=512,le=1,de=2,ce=30,ue="...",me=150,pe=16,fe=200,_e=1,ve=2,ge=3,he="Expected a function",be="__lodash_hash_undefined__",ye=1/0,we=9007199254740991,Ce=1.7976931348623157e308,Se=NaN,ke=4294967295,Oe=ke-1,De=ke>>>1,xe="__lodash_placeholder__",Ae="[object Arguments]",Ee="[object Array]",qe="[object Boolean]",Te="[object Date]",Re="[object Error]",$e="[object Function]",Pe="[object GeneratorFunction]",je="[object Map]",Ie="[object Number]",Me="[object Object]",Fe="[object RegExp]",Ne="[object Set]",Le="[object String]",Ue="[object Symbol]",We="[object WeakMap]",Be="[object ArrayBuffer]",ze="[object Float32Array]",Qe="[object Float64Array]",He="[object Int8Array]",Ve="[object Int16Array]",Ye="[object Int32Array]",Ge="[object Uint8Array]",Ke="[object Uint8ClampedArray]",Je="[object Uint16Array]",Ze="[object Uint32Array]",Xe=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,rr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,tr=/&(?:amp|lt|gt|quot|#39|#96);/g,nr=/[&<>"'`]/g,ar=RegExp(tr.source),sr=RegExp(nr.source),ir=/<%-([\s\S]+?)%>/g,or=/<%([\s\S]+?)%>/g,lr=/<%=([\s\S]+?)%>/g,dr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cr=/^\w*$/,ur=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,mr=/[\\^$.*+?()[\]{}|]/g,pr=RegExp(mr.source),fr=/^\s+|\s+$/g,_r=/^\s+/,vr=/\s+$/,gr=/\\(\\)?/g,hr=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,br=/\w*$/,yr=/^0x/i,wr=/^[-+]0x[0-9a-f]+$/i,Cr=/^0b[01]+$/i,Sr=/^\[object .+?Constructor\]$/,kr=/^0o[0-7]+$/i,Or=/^(?:0|[1-9]\d*)$/,Dr=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,xr=/($^)/,Ar=/['\n\r\u2028\u2029\\]/g,Er="\\ud800-\\udfff",qr="\\u0300-\\u036f\\ufe20-\\ufe23",Tr="\\u20d0-\\u20f0",Rr="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",Pr="\\xac\\xb1\\xd7\\xf7",jr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ir="\\u2018\\u2019\\u201c\\u201d",Mr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fr="A-Z\\xc0-\\xd6\\xd8-\\xde",Nr="\\ufe0e\\ufe0f",Lr=Pr+jr+Ir+Mr,Ur="["+Er+"]",Wr="["+Lr+"]",Br="["+qr+Tr+"]",zr="\\d+",Qr="["+Rr+"]",Hr="["+$r+"]",Vr="[^"+Er+Lr+zr+Rr+$r+Fr+"]",Yr="\\ud83c[\\udffb-\\udfff]",Gr="(?:"+Br+"|"+Yr+")",Kr="[^"+Er+"]",Jr="(?:\\ud83c[\\udde6-\\uddff]){2}",Zr="[\\ud800-\\udbff][\\udc00-\\udfff]",Xr="["+Fr+"]",et="\\u200d",rt="(?:"+Hr+"|"+Vr+")",tt="(?:"+Xr+"|"+Vr+")",nt=Gr+"?",at="["+Nr+"]?",st="(?:"+et+"(?:"+[Kr,Jr,Zr].join("|")+")"+at+nt+")*",it=at+nt+st,ot="(?:"+[Qr,Jr,Zr].join("|")+")"+it,lt="(?:"+[Kr+Br+"?",Br,Jr,Zr,Ur].join("|")+")",dt=RegExp(Br,"g"),ct=RegExp(Yr+"(?="+Yr+")|"+lt+it,"g"),ut=RegExp("["+et+Er+qr+Tr+Nr+"]"),mt=/[a-zA-Z0-9]+/g,pt=RegExp([Xr+"?"+Hr+"+(?="+[Wr,Xr,"$"].join("|")+")",tt+"+(?="+[Wr,Xr+rt,"$"].join("|")+")",Xr+"?"+rt+"+",Xr+"+",zr,ot].join("|"),"g"),ft=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_t=["Array","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],vt=-1,gt={};gt[ze]=gt[Qe]=gt[He]=gt[Ve]=gt[Ye]=gt[Ge]=gt[Ke]=gt[Je]=gt[Ze]=!0,gt[Ae]=gt[Ee]=gt[Be]=gt[qe]=gt[Te]=gt[Re]=gt[$e]=gt[je]=gt[Ie]=gt[Me]=gt[Fe]=gt[Ne]=gt[Le]=gt[We]=!1;var ht={};ht[Ae]=ht[Ee]=ht[Be]=ht[qe]=ht[Te]=ht[ze]=ht[Qe]=ht[He]=ht[Ve]=ht[Ye]=ht[je]=ht[Ie]=ht[Me]=ht[Fe]=ht[Ne]=ht[Le]=ht[Ue]=ht[Ge]=ht[Ke]=ht[Je]=ht[Ze]=!0,ht[Re]=ht[$e]=ht[We]=!1;var bt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},yt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},wt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Ct={function:!0,object:!0},St={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kt=parseFloat,Ot=parseInt,Dt=Ct[typeof r]&&r&&!r.nodeType?r:null,xt=Ct[typeof e]&&e&&!e.nodeType?e:null,At=$(Dt&&xt&&"object"==typeof a&&a),Et=$(Ct[typeof self]&&self),qt=$(Ct[typeof window]&&window),Tt=(xt&&xt.exports===Dt?Dt:null,$(Ct[typeof this]&&this)),Rt=At||qt!==(Tt&&Tt.window)&&qt||Et||Tt||Function("return this")(),$t=G();(qt||Et||{})._=$t,n=function(){return $t}.call(r,t,r,e),!(n!==K&&(e.exports=n))}).call(this)}).call(r,t(70)(e),function(){return this}())},function(e,r){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,r,t,n){var a=[],s=!0,i=!1,o=void 0;try{for(var l,d=function(){var e=l.value;switch(e.type_code){case"ADD_EXTRAS":var s=!0,i=!1,o=void 0;try{for(var d,c=(0,p.default)(e.items);!(s=(d=c.next()).done);s=!0){var u=d.value,m=f(u.id,n);if(null!==m&&"options"===m.type){var _=m.item.retail_price;t&&(m.item.retail_price=0,m.item.special_name=t.name);var v={type_code:e.type_code,item:m.item,item_original_retail_price:_,original_item:n.order.items[m.department.id]};a.push(v),n.order.items[m.department.id]=m.item}}}catch(e){i=!0,o=e}finally{try{!s&&c.return&&c.return()}finally{if(i)throw o}}break;case"MAKE_SELECTION":var g=e.selection.item,h=f(g.id,n);null!==h&&(a.push({type_code:e.type_code,department:h.department,original_item:n.order.items[h.department.id]}),n.order.items[h.department.id]=h.item,h.department.changed=!0);break;case"PRICE_MULTIPLY":var b=n.priceMultiplyItems(e.item,e.items);r.price_multiply=b.totalQuantity,n.internal.price_multiplies.push(r),a.push({type_code:e.type_code,item:r,rule:e});break;case"MARK_PLAN":if(e.file_upload){var y="rule"+e.id;n.internal.file_uploads[y]={name:e.file_upload.name,percentage:0},n.uploader.upload({url:"/api/orders/rule-plan-upload",data:{order_id:n.order.id,sku_id:r.id,notes:e.file_upload_notes},file:e.file_upload}).then(function(r){delete n.internal.file_uploads[y],a.push({type_code:e.type_code,rule_plan_id:r.data.rule_plan_id})},function(e){console.log("Error status: "+e.status)},function(e){var r=parseInt(100*e.loaded/e.total);n.internal.file_uploads[y].percentage=r})}break;case"FORCE_SELECTION":var w=!0,C=!1,S=void 0;try{for(var k,O=(0,p.default)(e.items);!(w=(k=O.next()).done);w=!0){var D=k.value,x=f(D.id,n);a.push({type_code:e.type_code,department:x.department,original_item:n.order.items[x.department.id]}),null!==x&&(n.order.items[x.department.id]=x.item,x.department.changed=!0)}}catch(e){C=!0,S=e}finally{try{!w&&O.return&&O.return()}finally{if(C)throw S}}break;case"FORCE_UNSELECTION":var A=!0,E=!1,q=void 0;try{for(var T,R=(0,p.default)(e.items);!(A=(T=R.next()).done);A=!0){var $=T.value,P=f($.id,n);null!==P&&(a.push({type_code:e.type_code,department:P.department,original_item:n.order.items[P.department.id]}),delete n.order.items[P.department.id],P.department.changed=!0);
}}catch(e){E=!0,q=e}finally{try{!A&&R.return&&R.return()}finally{if(E)throw q}}}e.applied=!0},c=(0,p.default)(e);!(s=(l=c.next()).done);s=!0)d()}catch(e){i=!0,o=e}finally{try{!s&&c.return&&c.return()}finally{if(i)throw o}}return r&&(r.undo_rules=a),a}function s(e,r){if(void 0!==e){var t=!0,n=!1,a=void 0;try{for(var s,i=function(){var e=s.value;switch(e.type_code){case"ADD_EXTRAS":r.order.items[e.item.sku_category]=e.original_item,e.item.retail_price=e.item_original_retail_price,e.item.special_name=void 0;break;case"PRICE_MULTIPLY":delete e.item.price_multiply,r.internal.price_multiplies=r.internal.price_multiplies.filter(function(r){return r.id!==e.item.id});break;case"MARK_PLAN":r.post("rule-plan-remove",{rule_plan_id:e.rule_plan_id});break;case"MAKE_SELECTION":case"FORCE_SELECTION":case"FORCE_UNSELECTION":r.order.items[e.department.id]=e.original_item}},o=(0,p.default)(e);!(t=(s=o.next()).done);t=!0)i()}catch(e){n=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw a}}}}function i(e,r,t){var n=[],a=[],s=0,i=0,o=!0,l=!1,d=void 0;try{for(var c,u=(0,p.default)(r);!(o=(c=u.next()).done);o=!0){var m=c.value,_=f(m.id,t);null!==_&&(t.order.items[found_item.department.id].id===m.id||"options"===_.type&&t.order.items[found_item.department.id])?(n.push(m),i+=m.quantity||1,s+=m.quantity*e.retail_price):a.push(m)}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}return{applicableItems:n,otherItems:a,totalPrice:s,totalQuantity:i}}function o(e){if(e.internal){var r=!0,t=!1,n=void 0;try{for(var a,s=(0,p.default)(e.internal.price_multiplies);!(r=(a=s.next()).done);r=!0){var o=a.value,l=0,d=!0,c=!1,u=void 0;try{for(var m,f=(0,p.default)(o.undo_rules.filter(function(e){return"PRICE_MULTIPLY"===e.type_code}));!(d=(m=f.next()).done);d=!0){var _=m.value,v=i(_.rule.item,_.rule.items,e);l+=v.totalQuantity}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}o.price_multiply=l}}catch(e){t=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(t)throw n}}}}function l(e,r){var t=!0,n=!0,a=!1,s=void 0;try{for(var i,o=(0,p.default)(e);!(n=(i=o.next()).done);n=!0){var l=i.value,d=f(l.id,r);if(null===d||!(r.order.items[found_item.department.id].id===l.id||"options"===d.type&&r.order.items[found_item.department.id])){t=!1;break}}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return t}function d(e){if(e.hasAppliedShowSpecial()){var r=e.order.show_special;r.undo_rules=a(r.rules,null,null,r,e)}}function c(e){if(e.hasAppliedShowSpecial()){var r=e.order.show_special,t=0,n=!0,a=!1,s=void 0;try{for(var i,o=(0,p.default)(r.rules);!(n=(i=o.next()).done);n=!0){var d=i.value;"PRICE_ADJUSTMENT"===d.type_code&&(d.applied=l(d.items,e),d.applied&&(t+=parseFloat(d.price_adjustment||0)))}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}r.value=t}}function u(e){o(e)}Object.defineProperty(r,"__esModule",{value:!0});var m=t(1),p=n(m);r.applyRules=a,r.unapplyRules=s,r.priceMultiplyItems=i,r.updatePriceMultiplies=o,r.applyShowSpecialRules=d,r.updateShowSpecialValue=c,r.updateRules=u;var f=function(e,r){var t=!0,n=!1,a=void 0;try{for(var s,i=(0,p.default)(r.info.items);!(t=(s=i.next()).done);t=!0){var o=s.value,l=!0,d=!1,c=void 0;try{for(var u,m=(0,p.default)(o.departments);!(l=(u=m.next()).done);l=!0)for(var f=u.value,_=["selections","upgrades","options"],v=0;v<_.length;v++){var g=_[v],h=!0,b=!1,y=void 0;try{for(var w,C=(0,p.default)(f[g]);!(h=(w=C.next()).done);h=!0){var S=w.value;if(S.id==e)return{category:o,department:f,item:S,type:g}}}catch(e){b=!0,y=e}finally{try{!h&&C.return&&C.return()}finally{if(b)throw y}}}}catch(e){d=!0,c=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw c}}}}catch(e){n=!0,a=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}return null}},,,,,,,,function(e,r,t){var n=t(21),a=t(7)("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||s[a]===e)}},function(e,r,t){var n=t(12);e.exports=function(e,r,t,a){try{return a?r(n(t)[0],t[1]):r(t)}catch(r){var s=e.return;throw void 0!==s&&n(s.call(e)),r}}},,function(e,r,t){var n=t(7)("iterator"),a=!1;try{var s=[7][n]();s.return=function(){a=!0},Array.from(s,function(){throw 2})}catch(e){}e.exports=function(e,r){if(!r&&!a)return!1;var t=!1;try{var s=[7],i=s[n]();i.next=function(){return{done:t=!0}},s[n]=function(){return i},e(s)}catch(e){}return t}},,,,function(e,r){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,r,t){var n=t(12),a=t(16),s=t(51);e.exports=function(e,r){if(n(e),a(r)&&r.constructor===e)return r;var t=s.f(e),i=t.resolve;return i(r),t.promise}},,function(e,r,t){var n=t(12),a=t(36),s=t(7)("species");e.exports=function(e,r){var t,i=n(e).constructor;return void 0===i||void 0==(t=n(i)[s])?r:a(t)}},function(e,r,t){var n,a,s,i=t(27),o=t(207),l=t(76),d=t(49),c=t(6),u=c.process,m=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,_=c.Dispatch,v=0,g={},h="onreadystatechange",b=function(){var e=+this;if(g.hasOwnProperty(e)){var r=g[e];delete g[e],r()}},y=function(e){b.call(e.data)};m&&p||(m=function(e){for(var r=[],t=1;arguments.length>t;)r.push(arguments[t++]);return g[++v]=function(){o("function"==typeof e?e:Function(e),r)},n(v),v},p=function(e){delete g[e]},"process"==t(26)(u)?n=function(e){u.nextTick(i(b,e,1))}:_&&_.now?n=function(e){_.now(i(b,e,1))}:f?(a=new f,s=a.port2,a.port1.onmessage=y,n=i(s.postMessage,s,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(e){c.postMessage(e+"","*")},c.addEventListener("message",y,!1)):n=h in d("script")?function(e){l.appendChild(d("script"))[h]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(i(b,e,1),0)}),e.exports={set:m,clear:p}},,function(e,r){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),i=a(s),o=t(71),l=n(o);r.default=function(e){e.controller("OrderCaravanController",["$http","$log","$q","$scope","$state","$sce","ApiService","AppSettings","OrderService","TestSettings","Upload",function(e,r,t,n,a,s,o,d,c,u,m){n.tabData=[{heading:"Model & Series",route:"order.caravan.modelseries"},{heading:"Weight & Size",route:"order.caravan.weightsize"},{heading:"Features",route:"order.caravan.features"}],n.internal={price_multiplies:[],file_uploads:{}},n.special_features_expanded=!1,n.options_upgrades_expanded=!1,n.uploader=m,n.priceMultiplyItems=function(e,r){return l.priceMultiplyItems(e,r,n)};var p=function(e){var r=!0,t=!1,a=void 0;try{for(var s,o=(0,i.default)(e.options);!(r=(s=o.next()).done);r=!0){var l=s.value,d=n.order.items[e.id];d&&(d.available=!0),l.available=!d||d.id==l.id}}catch(e){t=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw a}}};n.onOpenOptions=function(e){n.optionsByDepartment=n.getDepartmentsWithAvailableOptions(e);var r=!0,t=!1,a=void 0;try{for(var s,o=(0,i.default)(n.optionsByDepartment);!(r=(s=o.next()).done);r=!0){var l=s.value;p(l)}}catch(e){t=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw a}}$("#options.modal").modal({backdrop:"static"})},n.onOpenTotals=function(){var e=n.calculatePrice().detail;n.totals=e,$("#totals.modal").modal({backdrop:"static"})},n.onOpenSpecials=function(){$("#specials.modal").modal({backdrop:"static"})},n.onPrintPdfClick=function(e){var r=$(e.target).closest("a").attr("href");u.DISABLE_PDF&&(r+=r.indexOf("?")!==-1?"&":"?",r+="is_html=1");var t=u.DISABLE_PDF?"_self":"_blank";e.preventDefault(),n.checkAndConfirmSave().then(function(){window.open(r,t)})},n.onOpenSeriesPhotos=function(){n.view_photos=n.info.series_detail.photos,$("#photos.modal").modal({backdrop:"static"})},n.onOpenSeriesPlans=function(){n.view_photos=n.info.series_detail.plans,$("#photos.modal").modal({backdrop:"static"})},n.onItemSelect=function(e,r){var t=!n.order.items[e.id]||n.order.items[e.id].id!=r.id,a=function(){n.order.items[e.id]=r,e.changed=e.changed||t,l.updateRules(n)};n.post("item-rules",{sku_id:r.id,series_id:n.order.series}).then(function(t){var s=t.data.rules;n.info.rules=s,s.length?(n.cancelRules=function(){},n.acceptRules=function(t){if(t&&t.$valid){var i=n.order.items[e.id];i&&l.unapplyRules(i.undo_rules,n),l.applyRules(s,r,null,n),a(),$("#rules.modal").modal("hide")}},$("#rules.modal").modal({})):a()})},n.onItemPhotoClick=function(e){if("undefined"==typeof e.available){var r=f(e.sku_category);p(r)}e.available!==!1&&(n.view_photos=[{url:e.photo}],n.view_header=e.public_description,$("#photos.modal").modal({backdrop:"static"}))},n.isUpgrade=function(e,r){return"undefined"!=typeof r&&e.upgrades.filter(function(e){return e.id==r.id}).length};var f=function(e){var r=!0,t=!1,a=void 0;try{for(var s,o=(0,i.default)(n.info.items);!(r=(s=o.next()).done);r=!0){var l=s.value,d=!0,c=!1,u=void 0;try{for(var m,p=(0,i.default)(l.departments);!(d=(m=p.next()).done);d=!0){var f=m.value;if(f.id==e)return f}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}}}catch(e){t=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw a}}};n.onOptionSelect=function(e){var r=f(e.sku_category);"undefined"==typeof e.available&&p(r),!e.special_name&&e.available&&(n.order.items[r.id]?delete n.order.items[r.id]:n.order.items[r.id]=e,r.changed=!0,p(r),l.updateRules(n))},n.getDepartmentsMissingSelection=function(e){var r=[],t=!0,a=!1,s=void 0;try{for(var o,l=(0,i.default)(e.departments);!(t=(o=l.next()).done);t=!0){var d=o.value;(d.selections.length>0||d.upgrades.length>0)&&!n.order.items[d.id]&&r.push(d)}}catch(e){a=!0,s=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw s}}return r},n.hasSpecialFeatureForDepartment=function(e,r){return!1}}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=t(192),i=a(s),o=t(187),l=a(o),d=t(19),c=a(d),u=t(1),m=a(u),p=t(71),f=n(p);r.default=function(e){t(128)(e),t(123)(e),t(129)(e),t(127)(e),t(126)(e),e.controller("OrderController",["$anchorScroll","$filter","$http","$interval","$location","$log","$q","$rootScope","$sce","$scope","$state","$timeout","$window","ApiService","AppSettings","OrderApiService","OrderService",function(e,r,n,a,s,o,d,u,p,_,v,g,h,b,y,w,C){t(92),_.tabData=[{heading:"Customer Details",route:"order.customer"},{heading:"Caravan Details",route:"order.caravan"},{heading:"Status / Documents / History",route:"order.status"},{heading:"Special Features",route:"order.special_features"},{heading:"Certificates ",route:"order.order_certificates"}],_.choices={departments:[],dealerships:[],models:[],states:[],series:{},delivery_min_date:new Date},_.info={series_detail:{},show_price:!0,rules:{item_description:"",item_rules:[]}},_.chassis_lookup={loading:!1,no_results:!1},_.loading={items:!1,extras:!1,order:!1},_.GST_PERCENT=.1,_.cango=!0,_.stock=0,_.order=C,_.messages=p.trustAsHtml(t(290)),_.editCurrentCustomer=!1,u.$on("$stateChangeStart",function(){u.message=null}),_.post=function(e,r){return b.post("orders/"+e,r)};var S=function(){if(_.order.delivery_date){var e=!0,r=!1,t=void 0;try{for(var n,a=(0,m.default)(_.choices.available_delivery_months);!(e=(n=a.next()).done);e=!0){var s=n.value,i=s.value;if(_.order.delivery_date.getTime()==i.getTime()){_.order.delivery_date=i;break}}}catch(e){r=!0,t=e}finally{try{!e&&a.return&&a.return()}finally{if(r)throw t}}}},k=function(){var e={},r={},t=!0,n=!1,a=void 0;try{for(var s,i=(0,m.default)(_.choices.categories);!(t=(s=i.next()).done);t=!0){var o=s.value;e[o.id]=o;var l=!0,d=!1,c=void 0;try{for(var u,p=(0,m.default)(o.departments);!(l=(u=p.next()).done);l=!0){var f=u.value;r[f.id]={department:f,parent:o}}}catch(e){d=!0,c=e}finally{try{!l&&p.return&&p.return()}finally{if(d)throw c}}}}catch(e){n=!0,a=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}var v=!0,g=!1,h=void 0;try{for(var b,y=(0,m.default)(_.order.special_features);!(v=(b=y.next()).done);v=!0){var w=b.value;if(w.sku_category){var C=e[w.sku_category];C&&(w.selectedCategory=C);var S=r[w.sku_category];S&&(w.selectedDepartment=S.department,w.selectedCategory=S.parent),_.onSpecialFeatureCategorySelect(w),_.onSpecialFeatureDepartmentSelect(w)}}}catch(e){g=!0,h=e}finally{try{!v&&y.return&&y.return()}finally{if(g)throw h}}},O=function(){S(),k()};_.post("initial-data",{order_id:_.order.id,dealership_id:_.order.dealership,customer_id:v.params.customerId}).then(function(e){_.choices.dealerships=e.data.dealerships,_.choices.categories=e.data.categories,_.choices.models=e.data.models,_.choices.states=e.data.states,_.choices.acquisition_source=e.data.acquisition_source,_.choices.source_of_awareness=e.data.source_of_awareness,_.choices.shows=e.data.shows,_.permissions=e.data.permissions,_.choices.available_delivery_months=[];var t=e.data.available_delivery_months;_.permissions.manual_override&&(t=e.data.all_delivery_months);var n=!0,a=!1,s=void 0;try{for(var i,o=(0,m.default)(t);!(n=(i=o.next()).done);n=!0){var l=i.value,d=new Date(Date.parse(l)),c=e.data.available_delivery_months.indexOf(l)!=-1;_.choices.available_delivery_months.push({title:r("date")(d,y.FORMAT_DATE_MONTH_SHORT_JS)+(c?"":" *"),value:d})}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}O(),0==_.permissions.create_order&&0==_.permissions.view_order&&(h.location.href="/orders/list"),1==_.choices.dealerships.length&&(_.order.dealership=_.choices.dealerships[0].id),e.data.customer_info&&_.select_customer(e.data.customer_info),_.$watch("order.special_features",function(e,r){angular.equals(e,r)||(_.order.special_features_changed=!0)},!0)}),_.lookupChassis=function(e){return _.chassis_lookup.loading=!0,_.chassis_lookup.no_results=!1,_.post("chassis-lookup",{chassis_string:e}).then(function(e){return e.data.list.length?e.data.list:void(_.chassis_lookup.no_results=!0)})},_.onChassisSelect=function(){_.post("from-chassis",{order_id:_.data.from_chassis}).then(function(e){_.order.series=e.data.data.series,_.order.model=e.data.data.model,_.onModelSelect(),_.onSeriesSelect()})};var D="This will reset the details of the order. Are you sure you want to continue?";_.isModelEditable=function(){return["ORDER_FINALIZED","ORDER"].indexOf(_.order.order_stage_details.code)==-1&&_.order.isEditable()},_.onModelChange=function(){!_.order.model||confirm(D)?(_.order.model=_.order.modelSelection,_.order.series=null,_.order.resetOrderItems(),_.onModelSelect()):_.order.modelSelection=_.order.model},_.onModelSelect=function(){return _.order.model?void _.post("model-series",{model_id:_.order.model,dealership_id:_.order.dealership}).then(function(e){_.choices.series=e.data.series,_.info.model_detail=e.data.model_detail}):void(_.choices.series=[])},_.onSeriesChange=function(){!_.order.series||confirm(D)?(_.order.series=_.order.seriesSelection,_.order.resetOrderItems(),_.onSeriesSelect()):_.order.seriesSelection=_.order.series,_.calculatePrice()},_.onSeriesSelect=function(){return _.order.series?void _.post("series-detail",{series_id:_.order.series,order_id:_.order.id}).then(function(e){_.info.series_detail=e.data,_.specials=_.info.series_detail.show_specials,_.all_delivery_months=_.info.series_detail.all_delivery_months;_.all_delivery_months;_.available_delivery_months=_.info.series_detail.available_delivery_months;var t=_.available_delivery_months;_.avg_tare_weight=_.info.series_detail.avg_tare_weight,_.avg_ball_weight=_.info.series_detail.avg_ball_weight,_.choices.available_delivery_months=[],_.permissions.manual_override&&(t=e.data.all_delivery_months);var n=!0,a=!1,s=void 0;try{for(var i,o=(0,m.default)(t);!(n=(i=o.next()).done);n=!0){var l=i.value,d=new Date(Date.parse(l)),c=e.data.available_delivery_months.indexOf(l)!=-1;_.choices.available_delivery_months.push({title:r("date")(d,y.FORMAT_DATE_MONTH_SHORT_JS)+(c?"":" *"),value:d})}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}_.onDeliveryChange(),_.loadFeatures(),_.calculatePrice()}):(_.choices.available_delivery_months=[],void(_.choices.available_delivery_months=[]))},_.orderLookupData=function(){return{dealership:_.order.dealership}},_.onDeliveryChange=function(){if(_.order.delivery_date){var e=!0,r=!1,t=void 0;try{for(var n,a=(0,m.default)(_.choices.available_delivery_months);!(e=(n=a.next()).done);e=!0){var s=n.value,i=s.value;if(_.order.delivery_date.getTime()==i.getTime()){_.order.delivery_date=i;break}}}catch(e){r=!0,t=e}finally{try{!e&&a.return&&a.return()}finally{if(r)throw t}}}},_.onOrderLookupSelect=function(e){_.orderLookupResultId=e.id},_.assignSelectedOrderAndProceed=function(){_.order.loadOrderDetails_duplicate(_.orderLookupResultId,!1).then(function(){C.saveOrder().then(function(){_.onModelSelect(),_.onSeriesSelect(),_.loadFeatures(),v.go("order.caravan.weightsize")})})},_.current_dealership=function(){var e=_.choices.dealerships.filter(function(e){return e.id==_.order.dealership});return e.length?e[0]:null},_.createMessage=function(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;("undefined"==typeof t?"undefined":(0,c.default)(t))==(0,c.default)("")&&(t=[t]),u.message={type:r,message_list:t},e("message-anchor"),null!==n&&a(function(){u.message=null},n,1)};var x=function(){var e=v.href("order.customer",{orderId:_.order.id}).split("/").slice(1).join("/");s.path(e)};_.proceedDealerOrder=function(e){var r=e&&e.$valid;r&&(_.order.order_type="Stock",_.order.order_stage_details&&"ORDER_FINALIZED"==_.order.order_stage_details.code&&(_.order.update_customer_only=!0),C.saveOrder().then(function(){console.log("Inside Orderr Service ! "),x(),g(function(){v.go("order.caravan.modelseries",{orderId:_.order.id})})}))},_.proceedCustomerOrder=function(e){var r=e&&e.$valid;if(_.cango=r,r){if(_.order.id&&"Stock"==_.order.order_type)return _.order.is_order_converted=!0,_.stock=1,void(_.order.order_type="Customer");if("Customer"==_.order.order_type&&1==_.order.is_order_converted){if(null==_.order.order_converted&&(alert("Please Enter Sales Date ! "),_.cango=!1),null!=_.order.order_converted){var t=_.order.order_converted,n=t.split("/"),a=new Date(n[1]+"/"+n[0]+"/"+n[2]),s=new Date;if(a>s)return alert(" Sales Date cannot Be greater than today ! "),void(_.cango=!1)}if(0==_.cango)return void(_.stock=1);1==_.cango&&(_.stock=0)}_.cango===!0&&(_.order.order_stage_details&&"ORDER_FINALIZED"==_.order.order_stage_details.code&&(_.order.update_customer_only=!0),_.order.order_type="Customer",C.saveOrder().then(function(){0==_.stock&&(delete _.order.update_customer_only,x(),v.go("order.caravan.modelseries",{orderId:_.order.id})),1==_.stock&&alert("Stock  Customer order converted 1")}))}},_.newOrderForCustomer=function(){C.saveNewOrderForCustomer().then(function(){x(),g(function(){v.go("order.caravan.modelseries",{orderId:_.order.id})})})},_.proceed=function(e){switch(v.current.name){case"order.customer":e&&e.$valid&&v.go("order.caravan.modelseries");break;case"order.caravan.modelseries":_.order.model&&_.order.series&&C.saveOrder().then(function(){v.go("order.caravan.weightsize"),_.onDeliveryChange(),_.loadFeatures()});break;case"order.caravan.weightsize":e&&e.$valid&&C.saveOrder().then(function(){v.go("order.caravan.features")})}},_.toggleWeightDisclaimer=function(){_.order.weight_estimate_disclaimer_time=new Date},_.removeFeatureDocument=function(e){delete e.new_document,delete e.document},_.hasAppliedShowSpecial=function(){return _.order.show_special&&_.order.show_special.applied};var A=function(e){var r=[],t=!0,n=!1,a=void 0;try{for(var s,i=(0,m.default)(e.departments);!(t=(s=i.next()).done);t=!0){var o=s.value;o.selections.length&&r.push(o)}}catch(e){n=!0,a=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}return r};_.getDepartmentsWithAvailableOptions=function(e){var r=A(e);return e.departments.filter(function(e){return r.indexOf(e)==-1&&e.options.length})},_.getAvailableOptions=function(e){var r=[],t=A(e),n=!0,a=!1,s=void 0;try{for(var i,o=(0,m.default)(e.departments);!(n=(i=o.next()).done);n=!0){var l=i.value;t.indexOf(l)==-1&&(r=r.concat(l.options))}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}return r},_.hasCategoryOptions=function(e){return _.getAvailableOptions(e).length},_.getSelectedOptions=function(e){var r=[],t=!0,n=!1,a=void 0;try{for(var s,i=(0,m.default)(_.getDepartmentsWithAvailableOptions(e));!(t=(s=i.next()).done);t=!0){var o=s.value;_.order.items[o.id]&&r.push(_.order.items[o.id])}}catch(e){n=!0,a=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}return r},_.isItemSelected=function(e,r){return _.order.items[r.id]&&_.order.items[r.id].id==e.id},_.calculatePrice=function(){if(void 0===_.info.items||void 0===_.info.series_detail.retail_price)return 0;var e={manufacture:{caravan:parseFloat(_.info.series_detail.cost_price||0),upgrades:0,options:0,special_features:0,adjustments:_.order.price_adjustments.cost||0},wholesale:{caravan:parseFloat(_.info.series_detail.wholesale_price||0),upgrades:0,options:0,special_features:0,adjustments:(_.order.price_adjustments.wholesale||0)+(_.order.after_sales.wholesale||0)},retail:{caravan:parseFloat(_.info.series_detail.retail_price||0),upgrades:0,options:0,special_features:0,adjustments:(_.order.price_adjustments.retail||0)+(_.order.after_sales.retail||0)},options_upgrades:[],special_features:[]},r=!0,t=!1,n=void 0;try{for(var a,s=(0,m.default)(_.info.items);!(r=(a=s.next()).done);r=!0){var i=a.value,o=!0,l=!1,d=void 0;try{for(var c,u=(0,m.default)(i.departments);!(o=(c=u.next()).done);o=!0){var p=c.value;if(_.order.items[p.id]){var f=_.order.items[p.id],v=f.price_multiply||1,g=parseFloat(f.cost_price||0)*v,h=parseFloat(f.wholesale_price||0)*v,b=parseFloat(f.retail_price||0)*v;1==f.availability_type||5==f.availability_type||2==f.availability_type&&(e.manufacture.upgrades+=g,e.wholesale.upgrades+=h,e.retail.upgrades+=b,e.options_upgrades.push({name:f.name,manufacture:g,wholesale:h,retail:b}))}}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}var y=_.getSelectedOptions(i);if(y.length){var w=!0,C=!1,S=void 0;try{for(var k,O=(0,m.default)(y);!(w=(k=O.next()).done);w=!0){var D=k.value,x=D.price_multiply||1,A=parseFloat(D.cost_price||0)*x,E=parseFloat(D.wholesale_price||0)*x,q=parseFloat(D.retail_price||0)*x;e.options_upgrades.push({name:D.name,manufacture:A,wholesale:E,retail:q}),e.manufacture.options+=A,e.wholesale.options+=E,e.retail.options+=q}}catch(e){C=!0,S=e}finally{try{!w&&O.return&&O.return()}finally{if(C)throw S}}}}}catch(e){t=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(t)throw n}}var T=!0,R=!1,$=void 0;try{for(var P,j=(0,m.default)(_.order.special_features);!(T=(P=j.next()).done);T=!0){var I=P.value,M=parseFloat(I.retail_price||0),F=parseFloat(I.wholesale_price||0);e.retail.special_features+=M,e.wholesale.special_features+=F,e.special_features.push({name:I.customer_description,manufacture:0,wholesale:F,retail:M})}}catch(e){R=!0,$=e}finally{try{!T&&j.return&&j.return()}finally{if(R)throw $}}var N=function(e){return e.caravan+e.upgrades+e.options+e.special_features+e.adjustments};e.retail.total=N(e.retail),e.wholesale.total=N(e.wholesale),e.manufacture.total=N(e.manufacture);var L=0;_.hasAppliedShowSpecial()&&(L=parseFloat(_.order.show_special.price)||0,e.retail.total+=L);var U=function(e){return e.total-e.adjustments};return e.retail.totalNoAdjustment=U(e.retail),e.wholesale.totalNoAdjustment=U(e.wholesale),e.manufacture.totalNoAdjustment=U(e.manufacture),{detail:e,price:e.retail.total}},_.select_customer=function(e){_.order.customer=e,_.editCurrentCustomer=!1},_.select_physical_suburb=function(e){_.order.customer.physical_address.suburb=e},_.select_delivery_suburb=function(e){_.order.customer.delivery_address.suburb=e},_.select_invoice_suburb=function(e){_.order.customer.postal_address.suburb=e};var E=function(){var e=!0,r=!1,t=void 0;try{for(var n,a=(0,m.default)(_.info.items);!(e=(n=a.next()).done);e=!0){var s=n.value,i=!0,o=!1,l=void 0;try{for(var d,c=(0,m.default)(s.departments);!(i=(d=c.next()).done);i=!0){var u=d.value;u.changed=!1}}catch(e){o=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw l}}}}catch(e){r=!0,t=e}finally{try{!e&&a.return&&a.return()}finally{if(r)throw t}}_.order.special_features_changed=!1,_.order.price_changed=!1},q="Order details will be saved before continuing.";_.checkAndConfirmSave=function(){return new l.default(function(e,r){var t=function(){confirm(q)?_.saveOrder().then(e,r):r()};if(_.order.special_features_changed||_.order.price_changed)return void t();var n=!0,a=!1,s=void 0;try{for(var i,o=(0,m.default)(_.info.items);!(n=(i=o.next()).done);n=!0){var l=i.value,d=!0,c=!1,u=void 0;try{for(var p,f=(0,m.default)(l.departments);!(d=(p=f.next()).done);d=!0){var v=p.value;if(v.changed)return void t()}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}e()})},_.saveOrder=function(){return"ORDER_FINALIZED"==_.order.order_stage_details.code&&"order.customer"===v.current.name&&(_.order.update_customer_only=!0),_.loading.order=!0,C.saveOrder().then(function(){_.order.update_customer_only?(delete _.order.update_customer_only,_.createMessage("alert-warning","Customer details saved.")):_.createMessage("alert-info","Details Saved."),O(),setTimeout(E,1)}).finally(function(){_.loading.order=!1})},_.requestOrderApproval=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.requestOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.rejectOrderApproval=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.rejectOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.placeOrder=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.placeOrder().then(function(){v.go("order.status",{},{reload:!0}),_.order.last_server_error_message&&_.createMessage("alert-danger",_.order.last_server_error_message)}).finally(function(){_.loading.order=!1})},function(){})},_.confirmCancelOrder=function(){_.cancelReason="",$("#cancel_order.modal").modal({backdrop:"static"})},_.confirmPlaceOrder=function(){$("#place_order.modal").modal({backdrop:"static"})},_.cancelOrder=function(){C.cancelOrder(_.cancelReason).then(function(){v.go("order.status",{},{reload:!0})})},_.finalizeOrder=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.finalizeOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.canOrderBeSaved=function(){return _.order.isEditable()||_.permissions&&(_.permissions.modify_special_features||_.permissions.approve_special_features)},_.canOrderApprovalBeRejected=function(){return!!_.order.order_stage_details&&("ORDER_REQUESTED"==_.order.order_stage_details.code&&_.order.permissions.approve_order)},_.canOrderBeCancelled=function(){return!!_.order.order_stage_details&&(_.order.permissions.cancel_order&&("ORDER"==_.order.order_stage_details.code||"ORDER_FINALIZED"==_.order.order_stage_details.code))},_.canOrderApprovalBeRequested=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections)&&(("QUOTE"==_.order.order_stage_details.code||"QUOTE_SELECTIONS"==_.order.order_stage_details.code||"ORDER_REJECTED"==_.order.order_stage_details.code)&&_.order.permissions.request_order_approval)},_.canOrderBePlaced=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections)&&("ORDER_REQUESTED"==_.order.order_stage_details.code&&_.order.permissions.approve_order)},_.canOrderBeFinalized=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections||_.order.special_features.length&&!_.order.special_features_approved)&&("ORDER"==_.order.order_stage_details.code&&(_.order.permissions.finalize_order||_.order.permissions.lock_order))},_.canOrderPricesBeSaved=function(){return!!_.order.order_stage_details&&("ORDER_FINALIZED"==_.order.order_stage_details.code&&_.order.permissions.modify_retail_prices_finalized)},_.canCreateOrderForSameCustomer=function(){return _.order.id&&_.permissions&&_.permissions.create_order&&_.order.customer},_.updateSalesforce=function(){_.post("update-salesforce",{order_id:_.order.id}).then(function(){C.retrieveOrder(_.order.id)})},_.applyShowSpecial=function(e){_.order.show_special&&_.order.show_special.applied&&_.unapplyShowSpecial(_.order.show_special),_.order.show_special=e,e.applied=!0,f.applyShowSpecialRules(_),f.updateRules(_)},_.unapplyShowSpecial=function(e){f.unapplyRules(e.undo_rules,_),e.applied=!1,_.order.show_special=null},_.loadFeatures=function(){_.loading.items||(_.loading.items=!0,w.getFeatures(_.order.series,_.order.id).then(function(e){if(_.info.items=e.categories,T(),_.order.show_special_id){var r=!0,t=!1,n=void 0;try{for(var a,s=(0,m.default)(_.specials);!(r=(a=s.next()).done);r=!0){var i=a.value;if(i.id==_.order.show_special_id){_.order.show_special=i;break}}}catch(e){t=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(t)throw n}}_.applyShowSpecial(_.order.show_special)}}).finally(function(){_.loading.items=!1}))};var T=function(){var e=_.order;if("ORDER_FINALIZED"!=e.order_stage_details.code){var r=!0,t=!1,n=void 0;try{for(var a,s=(0,m.default)(_.info.items);!(r=(a=s.next()).done);r=!0){var i=a.value,o=!0,l=!1,d=void 0;try{for(var c,u=(0,m.default)(i.departments);!(o=(c=u.next()).done);o=!0){var p=c.value,f=e.items[p.id];if(f&&R(f,p))P(f,p)||(p.changed=!0);else if(1==p.selections.length){var v=p.selections[0];f&&f.id==v.id&&f.availability_type==v.availability_type||(p.changed=!0),e.items[p.id]=v}else f&&(p.changed=!0),delete e.items[p.id]}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}}}catch(e){t=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(t)throw n}}}},R=function(e,r){for(var t=["selections","upgrades","options"],n=0;n<t.length;n++){var a=t[n],s=!0,i=!1,o=void 0;try{for(var l,d=(0,m.default)(r[a]);!(s=(l=d.next()).done);s=!0){var c=l.value;if(c.id==e.id)return!0}}catch(e){i=!0,o=e}finally{try{!s&&d.return&&d.return()}finally{if(i)throw o}}}return!1},P=function(e,r){for(var t=["selections","upgrades","options"],n=0;n<t.length;n++){var a=t[n],s=!0,i=!1,o=void 0;try{for(var l,d=(0,m.default)(r[a]);!(s=(l=d.next()).done);s=!0){var c=l.value;if(c.id==e.id)return c.availability_type==e.availability_type}}catch(e){i=!0,o=e}finally{try{!s&&d.return&&d.return()}finally{if(i)throw o}}}return!1};_.order.validModel()&&_.onModelSelect(),_.order.validSeries()&&_.onSeriesSelect(),_.onOpenTradeInComment=function(){$("#trade_in_comment.modal").modal({backdrop:"static"})},_.onOpenConditions=function(){$("#order_conditions.modal").modal({backdrop:"static"})},_.onOpenAfterMarketNote=function(){$("#after_market_note.modal").modal({backdrop:"static"})},_.isCustomerEditable=function(){return _.order.id&&!_.order.isStockOrder()||!(_.order.customer&&_.order.customer.id)||_.editCurrentCustomer},_.clearCustomer=function(){_.order.resetCustomer(),_.search={}},_.editCustomerFields=function(){_.editCurrentCustomer=!0},_.checkdisplayview=function(){if(16===_.order.model||12===_.order.model||2===_.order.model){if(1===_.permissions.user_details)return 0;if(0===_.permissions.user_details)return 1}else{if(1===_.permissions.user_details)return 1;if(0===_.permissions.user_details)return 1}},_.replaceItem="",_.workcenter="",_.catname="",_.getCategory=function(e){var r={},t={};_.replaceItem="",_.workcenter="";var n=!0,a=!1,s=void 0;try{for(var i,o=(0,m.default)(_.choices.categories);!(n=(i=o.next()).done);n=!0){
var l=i.value;r[l.id]=l;var d=!0,c=!1,u=void 0;try{for(var p,f=(0,m.default)(l.departments);!(d=(p=f.next()).done);d=!0){var v=p.value;t[v.id]={department:v,parent:l}}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}}}catch(e){a=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw s}}var g=r[e.sku_category];g&&(_.catname=g.title);var h=t[e.sku_category];return h&&(e.selectedDepartment=h.department,e.selectedCategory=h.parent,_.workcenter=h.parent.title,_.replaceItem=h.department.title),_.workcenter||(_.workcenter=_.catname,_.replaceItem=e.factory_description,e.selectedCategory=_.workcenter,e.selectedDepartment=_.replaceItem),_.workcenter},_.onSpecialFeatureCategorySelect=function(e){e.departmentList=_.generateDepartmentsForCategory(e.selectedCategory),e.sku_category=e.selectedCategory?e.selectedCategory.id:null},_.onSpecialFeatureDepartmentSelect=function(e){e.selectedDepartment?e.sku_category=e.selectedDepartment.id:e.sku_category=e.selectedCategory.id},_.generateDepartmentsForCategory=function(e){var r=[];if(!e)return onFeatureDetailChange,r;var t=!0,n=!1,a=void 0;try{for(var s,o=(0,m.default)(e.departments);!(t=(s=o.next()).done);t=!0){var l=s.value,d=_.order.items[l.id];d&&r.push({id:l.id,title:d.public_description})}}catch(e){n=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw a}}var c=e.departments.filter(function(e){return 0==r.filter(function(r){return r.id==e.id}).length});return[].concat(r,[{id:null,title:"--------------------------------------------------"}],(0,i.default)(c))},_.addSpecialFeature=function(){var e={};_.onFeatureDetailChange(e),_.order.special_features.push(e)},_.removeSpecialFeature=function(e){_.order.special_features.splice(e,1)},_.onFeatureDetailChange=function(e){e.approved=null},_.onPrintAutocad=function(){_.checkAndConfirmSave().then(function(){window.open("/orders/autocad/"+_.order.id+"/","_blank")})}}])},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){e.directive("datetimepickerNeutralTimezone",function(){return{restrict:"A",priority:1,require:"ngModel",link:function(e,r,t,n){n.$formatters.push(function(e){if(e){var r=new Date(Date.parse(e));return r=new Date(r.getTime()+6e4*r.getTimezoneOffset())}}),n.$parsers.push(function(e){if(e){var r=new Date(e.getTime()-6e4*e.getTimezoneOffset());return r}return null})}}}),e.directive("statusRow",["AppSettings",function(e){return{restrict:"E",transclude:!0,template:t(301),scope:{stage:"=",title:"@",permission:"="},link:function(r){r.AppSettings=e,r.statusClass=function(e){if(e)switch(e.status){case"Complete":return"complete";case"Optional":return"optional";case"Requires Action":return"requires-action";case"Rejected":return"rejected"}}}}}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(2),s=n(a),i=t(3),o=n(i);r.default=function(e){e.factory("OrderApiService",["ApiService",function(e){var r=function(){function r(){(0,s.default)(this,r)}return(0,o.default)(r,[{key:"getFeatures",value:function(r,t){return e.getData("orders/series-items",{series_id:r,order_id:t})}}]),r}();return new r}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(64),s=n(a),i=t(272),o=n(i),l=t(2),d=n(l),c=t(3),u=n(c);r.default=function(e){e.factory("OrderService",["ApiService","AppSettings","Upload","$q",function(e,r,t,n){var a=function(){function a(){(0,d.default)(this,a),this.resetOrder()}return(0,u.default)(a,[{key:"resetOrder",value:function(){this.resetOrderExceptCustomer(),this.resetCustomer(),this.resetPermissions()}},{key:"resetOrderExceptCustomer",value:function(){this.resetOrderMainData(),this.resetOrderItems()}},{key:"resetOrderMainData",value:function(){this.id=null,this.model=null,this.series=null,this.custom_series_name=null,this.custom_series_code=null,this.series_description=null,this.series_code=null,this.production_month=null,this.production_start_date=null,this.modelSelection=null,this.seriesSelection=null,this.chassis=null,this.order_type=null,this.delivery_date=null,this.dealership=null,this.dealer_sales_rep_name=null,this.customer_manager_name=null,this.order_stage_details=null,this.dealership_name=null,this.original={},this.show_id=null,this.is_expired=!1,this.base_order=null,this.customer_plans_approved=!1,this.is_order_converted=!1,this.order_converted=null,this.salesforce_sync_error=null}},{key:"resetOrderItems",value:function(){this.weight_estimate_disclaimer=!1,this.custom_tare_weight=null,this.custom_ball_weight=null,this.show_special_id=null,this.price_adjustments={cost:0,wholesale:0,wholesale_comment:0,retail:0},this.after_sales={wholesale:0,retail:0,description:""},this.dealer_load=0,this.trade_in_write_back=0,this.trade_in_comment=null,this.price_comment=null,this.show_special=null,this.orderconditions={},this.aftermarketnote={},this.has_missing_selections=!0,this.items={},this.special_features=[],this.special_features_approved=!1,this.special_features_changed=!1,this.price_changed=!1}},{key:"resetCustomer",value:function(){this.customer={physical_address:{},delivery_address:{},postal_address:{}}}},{key:"resetPermissions",value:function(){this.permissions=null}},{key:"isStageQuote",value:function(){return void 0===this.order_stage_details||null===this.order_stage_details||this.order_stage_details.number<=r.STAGE_QUOTE_SELECTIONS}},{key:"isStageQuoteEditable",value:function(){return null==this.permissions||this.isStageQuote()&&this.permissions.modify_order}},{key:"isCustomerVisible",value:function(){return null==this.id||this.permissions.list_customer}},{key:"isStageOrder",value:function(){return!this.isStageQuote()}},{key:"isStockOrder",value:function(){return"Stock"==this.order_type}},{key:"isEditable",value:function(){return!(this.order_stage_details&&!this.isStockOrder())||(!("QUOTE"!=this.order_stage_details.code&&"QUOTE_SELECTIONS"!=this.order_stage_details.code&&"ORDER_REJECTED"!=this.order_stage_details.code||!this.permissions.modify_order)||(!("ORDER_REQUESTED"!=this.order_stage_details.code&&"ORDER"!=this.order_stage_details.code||!this.permissions.modify_order_requested)||!("ORDER_FINALIZED"!=this.order_stage_details.code||!this.permissions.modify_order_finalized)))}},{key:"validCustomer",value:function(){return null!==this.type}},{key:"validModel",value:function(){return(0,o.default)(this.model)}},{key:"validSeries",value:function(){return(0,o.default)(this.series)}},{key:"validModelSeries",value:function(){return this.validModel()&&this.validSeries()}},{key:"validWeightSize",value:function(){var e=this.weight_estimate_disclaimer===!0;return e}},{key:"updateAddress",value:function(e,r){e.name=(0,s.default)(r,"name"),e.street=(0,s.default)(r,"address"),e.suburb=(0,s.default)(r,"suburb.name"),e.post_code=(0,s.default)(r,"suburb.post_code.number"),e.state=(0,s.default)(r,"suburb.post_code.state.id")}},{key:"updateOrder",value:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model=e.model,this.series=e.series,this.custom_series_name=e.custom_series_name,this.custom_series_code=e.custom_series_code,this.series_description=e.series_description,this.series_code=e.series_code,this.production_month=e.production_month,this.production_start_date=e.production_start_date,this.modelSelection=e.model,this.seriesSelection=e.series,this.chassis=e.chassis,this.order_stage_details=e.order_stage_details,this.permissions=e.permissions,this.weight_estimate_disclaimer=e.weight_estimate_disclaimer_checked,this.custom_tare_weight=e.custom_tare_weight_kg,this.custom_ball_weight=e.custom_ball_weight_kg,this.price_adjustments.cost=parseFloat(e.price_adjustment_cost),this.price_adjustments.wholesale=parseFloat(e.price_adjustment_wholesale),this.price_adjustments.wholesale_comment=e.price_adjustment_wholesale_comment,this.price_adjustments.retail=parseFloat(e.price_adjustment_retail),this.dealer_load=parseFloat(e.dealer_load),this.trade_in_write_back=parseFloat(e.trade_in_write_back),this.trade_in_comment=e.trade_in_comment,this.after_sales.wholesale=parseFloat(e.after_sales_wholesale),this.after_sales.retail=parseFloat(e.after_sales_retail),this.after_sales.description=e.after_sales_description,this.price_comment=e.price_comment,this.orderconditions=e.orderconditions,this.aftermarketnote=e.aftermarketnote,this.is_expired=e.is_expired,this.base_order=e.id,this.has_missing_selections=e.has_missing_selections,this.items=e.items,this.price_changed=!1,this.customer_plans_approved=e.customer_plans_approved,this.special_features_approved=e.special_features_approved,this.salesforce_sync_error=e.salesforce_sync_error,r&&(this.id=e.id,this.customer=e.customer,this.show_id=e.show,this.show_special_id=e.show_special_id,this.delivery_date=e.delivery_date?new Date(Date.parse(e.delivery_date)):"",this.special_features=e.special_features,this.special_features_changed=!1,this.is_order_converted=e.is_order_converted,this.order_converted=e.order_converted,this.last_server_error_message=e.last_server_error_message,this.order_type=e.order_type,this.dealership=e.dealership,this.dealer_sales_rep_name=e.dealer_sales_rep_name,this.customer_manager_name=e.customer_manager_name,this.dealership_name=e.dealership_name)}},{key:"updateOrder_duplicate",value:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model=e.model,this.series=e.series,this.custom_series_name=e.custom_series_name,this.custom_series_code=e.custom_series_code,this.series_description=e.series_description,this.series_code=e.series_code,this.production_month=e.production_month,this.production_start_date=e.production_start_date,this.modelSelection=e.model,this.seriesSelection=e.series,this.chassis=e.chassis,this.order_stage_details=e.order_stage_details,this.permissions=e.permissions,this.weight_estimate_disclaimer=e.weight_estimate_disclaimer_checked,this.custom_tare_weight=e.custom_tare_weight_kg,this.custom_ball_weight=e.custom_ball_weight_kg,this.price_comment=e.price_comment,this.orderconditions=e.orderconditions,this.aftermarketnote=e.aftermarketnote,this.is_expired=e.is_expired,this.base_order=e.id,this.has_missing_selections=e.has_missing_selections,this.items=e.items,this.price_changed=!1,this.customer_plans_approved=e.customer_plans_approved,this.special_features_approved=e.special_features_approved,this.salesforce_sync_error=e.salesforce_sync_error,r&&(this.id=e.id,this.customer=e.customer,this.show_id=e.show,this.show_special_id=e.show_special_id,this.delivery_date=e.delivery_date?new Date(Date.parse(e.delivery_date)):"",this.special_features=e.special_features,this.special_features_changed=!1,this.is_order_converted=e.is_order_converted,this.order_converted=e.order_converted,this.last_server_error_message=e.last_server_error_message,this.order_type=e.order_type,this.dealership=e.dealership,this.dealer_sales_rep_name=e.dealer_sales_rep_name,this.customer_manager_name=e.customer_manager_name,this.dealership_name=e.dealership_name)}},{key:"loadOrderDetails",value:function(r){var t=this;return e.post("orders/retrieve-order",{order_id:r}).then(function(e){t.updateOrder(e.data,!1)})}},{key:"loadOrderDetails_duplicate",value:function(r){var t=this;return e.post("orders/retrieve-order",{order_id:r}).then(function(e){t.updateOrder_duplicate(e.data,!1)})}},{key:"retrieveOrder",value:function(r){var t=this,a=function(e){t.updateOrder(e.data)},s=function(e){return console.log("There was an error retrieving this order"),n.reject(e)};return e.post("orders/retrieve-order",{order_id:r}).then(a,s)}},{key:"saveOrder",value:function(){var e=this,r=function(r){return e.updateOrder(r.data),n.resolve(r)},a=function(e){return console.log("There was an error saving this order"),n.reject(e)},s={},i=1;return this.special_features.forEach(function(e){e.new_document&&(e.file_id=i++,s[e.file_id]=e.new_document)}),t.upload({method:"POST",url:"/api/orders/save-order",data:{order:this},file:s}).then(r,a)}},{key:"saveNewOrderForCustomer",value:function(){var e=this.dealership;return this.resetOrderExceptCustomer(),this.dealership=e,this.order_type="Customer",this.saveOrder()}},{key:"requestOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},a=function(e){return n.reject(e)};return e.post("orders/request-order",{order:this}).then(t,a)}},{key:"rejectOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},a=function(e){return n.reject(e)};return e.post("orders/reject-order",{order:this}).then(t,a)}},{key:"placeOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},a=function(e){return n.reject(e)};return e.post("orders/place-order",{order:this}).then(t,a)}},{key:"cancelOrder",value:function(r){var t=this,a=function(e){t.updateOrder(e.data)},s=function(e){return n.reject(e)};return e.post("orders/cancel-order",{order:this,cancel_reason:r}).then(a,s)}},{key:"finalizeOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},a=function(e){return n.reject(e)};return e.post("orders/finalize-order",{order:this}).then(t,a)}}]),a}();return new a}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(1),s=n(a);r.default=function(e){e.controller("ShowroomController",["$filter","$scope","$state","$timeout","ApiService","AppSettings","OrderService",function(e,r,n,a,i,o,l){t(92),r.order=l,window.location.href.indexOf("showroom")>-1&&$("#lnk_help").attr("href","/help/showroom"),r.post=function(e,r){return i.post("orders/"+e,r)},"showroom"===n.current.name&&n.go("showroom.splash"),r.createQuote=function(){n.go("showroom.customer")},r.current={model:null,series:null,slider:0},r.choices={models:[],series:[],states:[],referrals:[],dealerships:[]},r.info={model_detail:null,series_detail:null},r.modal={photo:null,plan_view:!1},r.errors={series_select:null},r.editCurrentCustomer=!1,r.post("showroom-data").then(function(t){r.choices.model_series=t.data.models,r.choices.states=t.data.states,r.choices.acquisition_source=t.data.acquisition_source,r.choices.source_of_awareness=t.data.source_of_awareness,r.choices.shows=t.data.shows,r.choices.dealerships=t.data.dealerships,r.choices.available_delivery_months=[];var n=!0,a=!1,i=void 0;try{for(var l,d=(0,s.default)(t.data.available_delivery_months);!(n=(l=d.next()).done);n=!0){var c=l.value,u=new Date(Date.parse(c));r.choices.available_delivery_months.push({title:e("date")(u,o.FORMAT_DATE_MONTH_SHORT_JS),value:u}),r.order.delivery_date&&r.order.delivery_date.getTime()==u.getTime()&&(r.order.delivery_date=u)}}catch(e){a=!0,i=e}finally{try{!n&&d.return&&d.return()}finally{if(a)throw i}}1==r.choices.dealerships.length&&(r.order.dealership=r.choices.dealerships[0].id)}),r.customerProceed=function(e){e&&e.$valid&&(r.order.order_type="Customer",r.choices.series=[],n.go("showroom.model"))},r.onModelClick=function(e){r.current.model=e,r.order.model=e.id,n.go("showroom.series")},r.selectSeries=function(e){r.current.series=e,r.order.series=e.id},r.onViewSeriesPhotoClick=function(e){r.selectSeries(e),n.go("showroom.seriesphotos")},r.onStartQuoteClick=function(e){r.selectSeries(e),r.onSeriesSelect()},r.onSeriesSelect=function(){r.errors.series_select=null;var e=function(e){a(function(){n.go("order.caravan.features",{orderId:e.data.id})})},t=function(e){400==e.status?r.errors.series_select=e.data:r.errors.series_select="An unexpected error has occurred"};l.saveOrder().then(e,t)},r.select_physical_suburb=function(e){r.order.customer.physical_address.suburb=e},r.select_customer=function(e){r.order.customer=e},r.clearCustomer=function(){r.order.resetCustomer(),r.search={}},r.editCustomerFields=function(){r.editCurrentCustomer=!0},r.hasModelAvailableSeries=function(e){var t=e.series.filter(r.isSeriesAvailableForDealership);return t.length},r.isSeriesAvailableForDealership=function(e){return e.dealerships.indexOf(r.order.dealership)!=-1}}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(190),s=n(a),i=t(35),o=n(i),l=t(1),d=n(l);r.default=function(e){t(125)(e),e.controller("OrderStatusController",["$scope","$state","ApiService","Upload",function(e,r,t,n){e.history={},e.new_customer_manager_id=null,e.new_sales_rep_id=null,e.loading=!1,e.cert_loading=!1,e.test_date=new Date,e.chassis_variable=!0,e.chassis_date_control=new Date,e.production_date_control=new Date,e.building_date_control=new Date;var a=function(r,t){e.status[r]&&e.status[r][t]&&e.status[r][t].data&&(e.status[r][t].data=new Date(e.status[r][t].data))},i=function(){e.post("status",{order_id:e.order.id}).then(function(r){e.status=r.data,a("delivery","delivery_date_set"),a("delivery","warranty_date"),a("delivery","pickup_date"),e.status.approval.deposit_paid.data=parseFloat(e.status.approval.deposit_paid.data),e.status.approval.senior_designer_verfied_date.data?e.senior_designer_date_control=f(e.status.approval.senior_designer_verfied_date.data):e.senior_designer_date_control="",e.status.approval.purchase_order_raised_date.data?e.purchase_order_date_control=f(e.status.approval.purchase_order_raised_date.data):e.purchase_order_date_control="",e.status.delivery.actual_production_date.data?e.production_date_control=f(e.status.delivery.actual_production_date.data):e.production_date_control="",e.status.delivery.chassis_section.data?e.chassis_date_control=f(e.status.delivery.chassis_section.data):e.chassis_date_control="",e.status.delivery.building.data?e.building_date_control=f(e.status.delivery.building.data):e.building_date_control="",e.status.delivery.prewire_section.data?e.prewire_date_control=f(e.status.delivery.prewire_section.data):e.prewire_date_control="",e.status.delivery.plumbing_date.data?e.plumbing_date_control=f(e.status.delivery.plumbing_date.data):e.plumbing_date_control="",e.status.delivery.aluminium.data?e.aluminium_date_control=f(e.status.delivery.aluminium.data):e.aluminium_date_control="",e.status.delivery.finishing.data?e.finishing_date_control=f(e.status.delivery.finishing.data):e.finishing_date_control="",e.status.delivery.detailing_date.data?e.detailing_date_control=f(e.status.delivery.detailing_date.data):e.detailing_date_control="",e.status.delivery.watertest_date.data?e.watertest_date_control=f(e.status.delivery.watertest_date.data):e.watertest_date_control="",e.status.delivery.final_qc_date.data?e.final_qc_date_control=f(e.status.delivery.final_qc_date.data):e.final_qc_date_control="",e.status.delivery.dispatch_date_planned.data?e.dispatch_date_planned_control=f(e.status.delivery.dispatch_date_planned.data):e.dispatch_date_planned_control="",e.status.delivery.collection_date.data?e.collection_date_control=f(e.status.delivery.collection_date.data):e.collection_date_control="",e.status.delivery.dispatch_date_actual.data?e.dispatch_date_actual_control=f(e.status.delivery.dispatch_date_actual.data):e.dispatch_date_actual_control="",e.status.delivery.received_date_dealership.data?e.received_date_dealership_control=f(e.status.delivery.received_date_dealership.data):e.received_date_dealership_control="",e.status.delivery.delivery_date_customer.data?e.delivery_date_customer_control=f(e.status.delivery.delivery_date_customer.data):e.delivery_date_customer_control="",e.loading=!1}),e.post("status-history",{order_id:e.order.id}).then(function(r){e.status_history=r.data.history})},l=function(){e.loading=!1,e.post("status-docs",{order_id:e.order.id}).then(function(r){e.status_docs=r.data.docs_data})};i(),l(),e.sectionComplete=function(e){if(e){var r=!0,t=!1,n=void 0;try{for(var a,s=(0,d.default)((0,o.default)(e));!(r=(a=s.next()).done);r=!0){var i=a.value;if("Complete"!==e[i].status&&"Optional"!==e[i].status)return!1}}catch(e){t=!0,n=e}finally{try{!r&&s.return&&s.return()}finally{if(t)throw n}}return!0}};var c=function(r){if(!e.loading)return e.loading=!0,r.order_id=e.order.id,t.post("orders/status-update",r).finally(function(){i(),l()})},u=function(e,r,t){console.log(r+" : "+t);var n={};n[r]=t,console.log(" Data ",n),c(n)},m=function(r){if(!e.loading)return e.loading=!0,r.order_id=e.order.id,t.post("orders/status-delete",r).finally(function(){i()})},p=function(e,r,t){if(e.$valid){var n={};n[r]=t,m(n)}};e.updateDeposit=function(e,r){u(e,"deposit",r)},e.updateChassis=function(){c({chassis_number:!0})},e.enableChassisEdition=function(){e.editingChassis=!0},e.setChassis=function(){c({chassis_number:e.status.approval.chassis_appointed.data}).then(function(){e.editingChassis=!1})},e.deleteActualProdDate=function(e,r){p(e,"del_actual_production_date",r)},e.deleteChassisSection=function(e,r){p(e,"del_chassis_section",r)},e.deleteBuildingSection=function(e,r){p(e,"del_building",r)},e.deletePrewireSection=function(e,r){p(e,"del_prewire_section",r)},e.deletePlumbingDate=function(e,r){p(e,"del_plumbing_date",r)},e.deleteAluminiumSection=function(e,r){p(e,"del_aluminium",r)},e.deleteFinishing=function(e,r){p(e,"del_finishing",r)},e.deleteWatertestDate=function(e,r){p(e,"del_watertest_date",r)},e.deleteWeighbridgeDate=function(e,r){p(e,"del_weigh_bridge_date",r)},e.deleteDetailingDate=function(e,r){p(e,"del_detailing_date",r)},e.deleteActualQC=function(e,r){p(e,"del_qc_date_actual",r)},e.deleteFinalQC=function(e,r){p(e,"del_final_qc_date",r)},e.deleteActualDispatchDate=function(e,r){p(e,"del_dispatch_date_actual",r)},e.updateActualProductionDate=function(e,r){var t=_(r);u(e,"actual_production_date",t)},e.updateActualProductionComments=function(e,r){u(e,"actual_production_comments",r)},e.updateChassisSectionDate=function(e,r){var t=_(r);u(e,"chassis_section",t)},e.updateChassisSectionComments=function(e,r){u(e,"chassis_section_comments",r)},e.updateBuildingDate=function(e,r){var t=_(r);u(e,"building",t)},e.updateBuildingComments=function(e,r){u(e,"building_comments",r)},e.updatePrewireDate=function(e,r){var t=_(r);u(e,"prewire_section",t)},e.updatePrewireComments=function(e,r){u(e,"prewire_comments",r)},e.updatePlumbingDate=function(e,r){var t=_(r);u(e,"plumbing_date",t)},e.updatePlumbingComments=function(e,r){u(e,"plumbing_comments",r)},e.updateAluminiumDate=function(e,r){var t=_(r);u(e,"aluminium",t)},e.updateAluminiumComments=function(e,r){u(e,"aluminium_comments",r)},e.updateFinishingDate=function(e,r){var t=_(r);u(e,"finishing",t)},e.updateFinishingComments=function(e,r){u(e,"finishing_comments",r)},e.updateWatertestDate=function(e,r){var t=_(r);u(e,"watertest_date",t)},e.updateWatertestComments=function(e,r){u(e,"watertest_comments",r)},e.updateWeighbridgeDate=function(e,r){u(e,"weigh_bridge_date",r)},e.updateWeighbridgeComments=function(e,r){u(e,"weigh_bridge_comments",r)},e.updateDetailingDate=function(e,r){var t=_(r);u(e,"detailing_date",t)},e.updateDetalingComments=function(e,r){u(e,"detailing_comments",r)},e.updatePlannedQcDate=function(e,r){u(e,"qc_date_planned",r)},e.updateActualQcDate=function(e,r){u(e,"qc_date_actual",r)},e.updateQCComments=function(e,r){u(e,"qc_comments",r)},e.updatePlannedWatertestDate=function(e,r){u(e,"planned_watertest_date",r)},e.updateActualWatertestDate=function(e,r){u(e,"actual_watertest_date",r)},e.updateWatertestComments=function(e,r){u(e,"watertest_comments",r)},e.updateFinalQcDate=function(e,r){var t=_(r);u(e,"final_qc_date",t)},e.updateFinalQcComments=function(e,r){u(e,"final_qc_comments",r)},e.updateSeniorDesigner=function(e,r){var t=_(r);u(e,"senior_designer_verfied_date",t)},e.updatePurchaseOrderRaised=function(e,r){var t=_(r);u(e,"purchase_order_raised_date",t)},e.updateVinNumber=function(e,r){u(e,"vin_number",r)},e.updatePlannedDispatchDate=function(e,r){u(e,"dispatch_date_planned",r)},e.updateActualDispatchDate=function(e,r){var t=_(r);u(e,"dispatch_date_actual",t)},e.updateDispatchComments=function(e,r){u(e,"dispatch_comments",r)},e.updateCollectionDate=function(e,r){var t=_(r);u(e,"collection_date",t)},e.updateCollectionComments=function(e,r){u(e,"collection_comments",r)},e.updateDealershipReceivedDate=function(e,r){var t=_(r);u(e,"received_date_dealership",t)},e.updateCustomerDeliveryDate=function(e,r){var t=_(r);u(e,"delivery_date_customer",t)},e.openWeightsModal=function(){e.status.delivery.new_weights={data:(0,s.default)({},e.status.delivery.weights.data)},$("#delivery_weights.modal").modal({backdrop:"static"})},e.saveWeights=function(){c({weights:e.status.delivery.new_weights}).then(function(){$("#delivery_weights.modal").modal("hide")})},e.updateDeliveryDate=function(e,r){var t=_(r);u(e,"delivery_date",t)},e.updateDrafter=function(e,r){u(e,"drafter",r)},e.cancelFinalization=function(){e.order_finalization_cancel_reason="",$("#order_finalization_cancel_reason.modal").modal({backdrop:"static"})},e.processCancelFinalization=function(){e.post("cancel-finalize",{order_id:e.order.id,reason:e.order_finalization_cancel_reason}).then(function(e){r.go("order.status",{},{reload:!0})})},e.approveCustomerPlan=function(){c({review_customer_plan:"approve",customer_plan_disclaimer_checked:e.status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked,weight_estimate_disclaimer_checked:e.status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked})},e.confirmRejectCustomerPlan=function(){e.customer_plan_reject_reason="",$("#customer_plan_reject_reason.modal").modal({backdrop:"static"})},e.processRejectCustomerPlan=function(){c({review_customer_plan:"reject",reject_reason:e.customer_plan_reject_reason})},e.updateDoc=function(r,t,a){if(!e.cert_loading){switch(e.cert_loading=!0,a){case"customer":a="customer_plan",e.certificate_note="Customer Plan";break;case"factory":a="factory_plan",e.certificate_note="";break;case"chassis":a="chassis_plan",e.certificate_note="";break;case"contract":a="contract",e.certificate_note="";break;case"plumbing":a="plumbing";break;case"electrical":a="electrical";break;case"weighbridge":a="weighbridge";break;case"qualitycontrol":a="qualitycontrol";break;case"others":a="others"}r.$valid&&n.upload({url:"/api/orders/status-update",data:{order_id:e.order.id,certificate_title:e.certificate_note,upload_for:a},file:t}).then(function(e){i(),l()},function(e){}).then(function(){e.cert_loading=!1,e.loading=!1})}},e.updateSalesforce=function(){c()},e.checkcertvalue=function(){return"others"==e.certificate_type};var f=function(e){var r=e,t=r.substring(0,2),n=r.substring(3,5),a=r.substring(6,10),s=new Date(a,n-1,t);return s},_=function(e){var r=e,t=r.getDate(),n=r.getMonth()+1,a=r.getFullYear(),s=t+"/"+n+"/"+a;return s};e.check_date_value=function(){console.log("Date Test"),console.log(e.status.delivery.actual_production_date.data);var r=e.status.delivery.actual_production_date.data,t=r.substring(0,2),n=r.substring(3,5),a=r.substring(6,10),s=new Date(a,n-1,t);return e.test_date=s,!0},e.emptyfun=function(){console.log("Do Nothing ! ")},e.set_date_format=function(){console.log("Selected Date "+e.test_date);var r=e.test_date,t=r.getDate(),n=r.getMonth()+1,a=r.getFullYear(),s=t+"/"+n+"/"+a;console.log("Date Requried : ",s),e.status.delivery.actual_production_date=s,console.log("Date Var Changed : ",e.status.delivery.actual_production_date)},e.populateText=function(){"plumbing"==e.certificate_type&&(e.certificate_note="Plumbing Certificate"),"electrical"==e.certificate_type&&(e.certificate_note="Electrical Certificate"),"weighbridge"==e.certificate_type&&(e.certificate_note="Weigh Bridge Certificate"),"qualitycontrol"==e.certificate_type&&(e.certificate_note="Quality Control Certificate"),"others"==e.certificate_type&&(e.certificate_note="Other Certificates")},e.updateSeparateDoc=function(r,t){r&&r.is_separated?c({add_separate_doc:t}):e.deleteDoc(r.id,t)},e.deleteDoc=function(r,t){e.cert_loading=!0,"customer"==t?c({delete_customer_plan:r}):"factory"==t?c({delete_factory_plan:r}):"chassis"==t?c({delete_chassis_plan:r}):"contract"==t?c({delete_contract:r}):"handover_to_driver_form"==t?c({delete_handover_to_driver_form:r}):"handover_to_dealership_form"==t?c({delete_handover_to_dealership_form:r}):"order_certificate_form"==t&&c({delete_order_certificate_form:r}),e.cert_loading=!1},e.updateHistory=function(r,t){r.$valid&&void 0!==t&&(void 0!==t.file_upload?n.upload({url:"/api/orders/status-history-note",data:{order_id:e.order.id,note:t.note},file:t.file_upload}).then(function(e){i()},function(e){}):t.note&&e.post("status-history-note",{order_id:e.order.id,note:t.note}).then(function(e){i()}),e.history={})},e.updateCertificate=function(r,t){r.$valid&&void 0!==t&&(void 0!==t.file_upload?n.upload({url:"/api/orders/status-history-note",data:{order_id:e.order.id,note:t.note},file:t.file_upload}).then(function(e){i()},function(e){}):t.note&&e.post("status-history-note",{order_id:e.order.id,note:t.note}).then(function(e){i()}),e.history={})},e.onOpenUpdateCustomerManager=function(){$("#update_customer_manager.modal").modal({backdrop:"static"})};var v=function(){e.post("customer_manager",{order_id:e.order.id}).then(function(r){e.customer_manager_list=r.data.customer_manager_list})};v(),e.updateCustomerManager=function(){e.new_customer_manager_id&&e.post("customer_manager",{order_id:e.order.id,customer_manager_id:e.new_customer_manager_id}).then(function(r){e.order.customer_manager_name=r.data.name})},e.canChangeSalesRep=function(){return e.order.permissions&&e.order.permissions.modify_order_sales_rep},e.canDeleteCertificates=function(){return e.status.permissions.can_delete_certificates},e.onOpenUpdateSalesRep=function(){$("#update_sales_rep.modal").modal({backdrop:"static"})};var g=function(){e.canChangeSalesRep()&&e.post("sales_rep",{order_id:e.order.id}).then(function(r){e.sales_rep_list=r.data.sales_rep_list})};g(),e.updateSalesRep=function(){e.new_sales_rep_id&&e.post("sales_rep",{order_id:e.order.id,sales_rep_id:e.new_sales_rep_id}).then(function(r){e.order.dealer_sales_rep_name=r.data.name})}}])},e.exports=r.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";var n=t(10);t(69),t(124)(n),n.config(["$stateProvider","$urlRouterProvider",function(e,r){r.otherwise("/customer"),e.state("order",{url:"/:orderId",template:t(292),controller:"OrderController",require:{default_sub_route:["order","order.customer"]},resolve:{FetchExistingOrder:["OrderService","$state","$q","$timeout","$stateParams",function(e,r,t,n,a){var s=a.orderId;if("new"!==s&&isNaN(parseInt(s)))return n(function(){r.go("order.customer",{orderId:"new"})}),t.reject();if("new"!==s){var i=function(){},o=function(){e.constructor(),n(function(){r.go("order.error",{error:"There was an error while retrieving the order.",orderId:"new"})})};return e.retrieveOrder(s).then(i,o)}return e.constructor(),t.resolve()}]}}).state("showroom",{url:"/showroom",template:t(299),controller:"ShowroomController"}).state("showroom.customer",{url:"/customer",template:t(295)}).state("showroom.model",{url:"/model",template:t(296),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,r,t,n){return e.validCustomer()?e:(n(function(){r.go("showroom.customer")}),t.reject())}]}}).state("showroom.series",{url:"/series",template:t(298),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,r,t,n){return e.validModel()?e:(n(function(){r.go("showroom.model")}),t.reject())}]}}).state("showroom.seriesphotos",{url:"/series-photos",template:t(297),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,r,t,n){return e.validSeries()?e:(n(function(){r.go("showroom.series")}),t.reject())}]}}).state("order.error",{url:"/error",template:t(288),params:{error:""},controller:["$scope","$stateParams",function(e,r){e.params=r}]}).state("order.manage",{url:"/manage/:orderId",controller:["$scope",function(e){e.order.model&&e.onModelSelect(),e.order.series&&e.onSeriesSelect()}],resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout","$stateParams",function(e,r,t,n,a,s){var i=function(){r.base_order=parseInt(s.orderId),
a(function(){t.go("order.customer")})},o=function(){return a(function(){t.go("order.error",{error:"There was an error while retrieving the order."})}),n.reject()};return r.retrieveOrder(s.orderId).then(i,o)}]}}).state("order.customer",{url:"/customer/:customerId",template:t(287),params:{customerId:""}}).state("order.caravan",{url:"/caravan",template:t(286),controller:"OrderCaravanController",require:{default_sub_route:["order.caravan","order.caravan.features"]},resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout","$stateParams",function(e,r,t,n,a,s){if(!r.validCustomer()){var i=r.id||s.orderId;return a(function(){t.go("order.customer",{orderId:i})}),n.reject()}return r}]}}).state("order.caravan.modelseries",{url:"/model-and-series",template:t(291)}).state("order.caravan.weightsize",{url:"/weight-and-size",template:t(303),resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,r,t,n,a){return r.validModelSeries()?r:(a(function(){t.go("order.caravan.modelseries",{orderId:r.id})}),n.reject())}]}}).state("order.caravan.features",{url:"/features",template:t(289),resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,r,t,n,a){return r.validModelSeries()?r:(a(function(){t.go("order.caravan.modelseries",{orderId:r.id})}),n.reject())}]}}).state("order.caravan.resources",{url:"/resources",template:t(294)}).state("order.status",{url:"/status",template:t(302),controller:"OrderStatusController",resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,r,t,n,a){return r.validModelSeries()?r:(a(function(){t.go("order.caravan.modelseries",{orderId:r.id})}),n.reject())}]}}).state("order.special_features",{url:"/special_features",template:t(300)}).state("order.order_certificates",{url:"/order_certificates",template:t(293),controller:"OrderStatusController"})}])},,,,,,,,,,,,function(e,r,t){e.exports={default:t(193),__esModule:!0}},,function(e,r,t){e.exports={default:t(196),__esModule:!0}},function(e,r,t){e.exports={default:t(198),__esModule:!0}},,,function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var a=t(186),s=n(a);r.default=s.default||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}},,function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var a=t(184),s=n(a);r.default=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return(0,s.default)(e)}},function(e,r,t){t(32),t(226),e.exports=t(4).Array.from},,,function(e,r,t){t(228),e.exports=t(4).Object.assign},,function(e,r,t){t(91),t(32),t(39),t(230),t(232),t(233),e.exports=t(4).Promise},,,,function(e,r){e.exports=function(e,r,t,n){if(!(e instanceof r)||void 0!==n&&n in e)throw TypeError(t+": incorrect invocation!");return e}},,function(e,r,t){"use strict";var n=t(11),a=t(29);e.exports=function(e,r,t){r in e?n.f(e,r,a(0,t)):e[r]=t}},,function(e,r,t){var n=t(27),a=t(80),s=t(79),i=t(12),o=t(57),l=t(61),d={},c={},r=e.exports=function(e,r,t,u,m){var p,f,_,v,g=m?function(){return e}:l(e),h=n(t,u,r?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(s(g)){for(p=o(e.length);p>b;b++)if(v=r?h(i(f=e[b])[0],f[1]):h(e[b]),v===d||v===c)return v}else for(_=g.call(e);!(f=_.next()).done;)if(v=a(_,h,f.value,r),v===d||v===c)return v};r.BREAK=d,r.RETURN=c},function(e,r){e.exports=function(e,r,t){var n=void 0===t;switch(r.length){case 0:return n?e():e.call(t);case 1:return n?e(r[0]):e.call(t,r[0]);case 2:return n?e(r[0],r[1]):e.call(t,r[0],r[1]);case 3:return n?e(r[0],r[1],r[2]):e.call(t,r[0],r[1],r[2]);case 4:return n?e(r[0],r[1],r[2],r[3]):e.call(t,r[0],r[1],r[2],r[3])}return e.apply(t,r)}},,,,,function(e,r,t){var n=t(6),a=t(90).set,s=n.MutationObserver||n.WebKitMutationObserver,i=n.process,o=n.Promise,l="process"==t(26)(i);e.exports=function(){var e,r,t,d=function(){var n,a;for(l&&(n=i.domain)&&n.exit();e;){a=e.fn,e=e.next;try{a()}catch(n){throw e?t():r=void 0,n}}r=void 0,n&&n.enter()};if(l)t=function(){i.nextTick(d)};else if(!s||n.navigator&&n.navigator.standalone)if(o&&o.resolve){var c=o.resolve(void 0);t=function(){c.then(d)}}else t=function(){a.call(n,d)};else{var u=!0,m=document.createTextNode("");new s(d).observe(m,{characterData:!0}),t=function(){m.data=u=!u}}return function(n){var a={fn:n,next:void 0};r&&(r.next=a),e||(e=a,t()),r=a}}},function(e,r,t){"use strict";var n=t(8),a=t(17),s=t(52),i=t(22),o=t(30),l=t(78),d=Object.assign;e.exports=!d||t(20)(function(){var e={},r={},t=Symbol(),n="abcdefghijklmnopqrst";return e[t]=7,n.split("").forEach(function(e){r[e]=e}),7!=d({},e)[t]||Object.keys(d({},r)).join("")!=n})?function(e,r){for(var t=o(e),d=arguments.length,c=1,u=s.f,m=i.f;d>c;)for(var p,f=l(arguments[c++]),_=u?a(f).concat(u(f)):a(f),v=_.length,g=0;v>g;)p=_[g++],n&&!m.call(f,p)||(t[p]=f[p]);return t}:d},,,,,,function(e,r,t){var n=t(15);e.exports=function(e,r,t){for(var a in r)t&&e[a]?e[a]=r[a]:n(e,a,r[a]);return e}},function(e,r,t){"use strict";var n=t(6),a=t(4),s=t(11),i=t(8),o=t(7)("species");e.exports=function(e){var r="function"==typeof a[e]?a[e]:n[e];i&&r&&!r[o]&&s.f(r,o,{configurable:!0,get:function(){return this}})}},,,function(e,r,t){var n=t(6),a=n.navigator;e.exports=a&&a.userAgent||""},,,function(e,r,t){"use strict";var n=t(27),a=t(9),s=t(30),i=t(80),o=t(79),l=t(57),d=t(204),c=t(61);a(a.S+a.F*!t(82)(function(e){Array.from(e)}),"Array",{from:function(e){var r,t,a,u,m=s(e),p="function"==typeof this?this:Array,f=arguments.length,_=f>1?arguments[1]:void 0,v=void 0!==_,g=0,h=c(m);if(v&&(_=n(_,f>2?arguments[2]:void 0,2)),void 0==h||p==Array&&o(h))for(r=l(m.length),t=new p(r);r>g;g++)d(t,g,v?_(m[g],g):m[g]);else for(u=h.call(m),t=new p;!(a=u.next()).done;g++)d(t,g,v?i(u,_,[a.value,g],!0):a.value);return t.length=g,t}})},,function(e,r,t){var n=t(9);n(n.S+n.F,"Object",{assign:t(213)})},,function(e,r,t){"use strict";var n,a,s,i,o=t(28),l=t(6),d=t(27),c=t(47),u=t(9),m=t(16),p=t(36),f=t(202),_=t(206),v=t(89),g=t(90).set,h=t(212)(),b=t(51),y=t(86),w=t(223),C=t(87),S="Promise",k=l.TypeError,O=l.process,D=O&&O.versions,x=D&&D.v8||"",A=l[S],E="process"==c(O),q=function(){},T=a=b.f,R=!!function(){try{var e=A.resolve(1),r=(e.constructor={})[t(7)("species")]=function(e){e(q,q)};return(E||"function"==typeof PromiseRejectionEvent)&&e.then(q)instanceof r&&0!==x.indexOf("6.6")&&w.indexOf("Chrome/66")===-1}catch(e){}}(),$=function(e){var r;return!(!m(e)||"function"!=typeof(r=e.then))&&r},P=function(e,r){if(!e._n){e._n=!0;var t=e._c;h(function(){for(var n=e._v,a=1==e._s,s=0,i=function(r){var t,s,i,o=a?r.ok:r.fail,l=r.resolve,d=r.reject,c=r.domain;try{o?(a||(2==e._h&&M(e),e._h=1),o===!0?t=n:(c&&c.enter(),t=o(n),c&&(c.exit(),i=!0)),t===r.promise?d(k("Promise-chain cycle")):(s=$(t))?s.call(t,l,d):l(t)):d(n)}catch(e){c&&!i&&c.exit(),d(e)}};t.length>s;)i(t[s++]);e._c=[],e._n=!1,r&&!e._h&&j(e)})}},j=function(e){g.call(l,function(){var r,t,n,a=e._v,s=I(e);if(s&&(r=y(function(){E?O.emit("unhandledRejection",a,e):(t=l.onunhandledrejection)?t({promise:e,reason:a}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",a)}),e._h=E||I(e)?2:1),e._a=void 0,s&&r.e)throw r.v})},I=function(e){return 1!==e._h&&0===(e._a||e._c).length},M=function(e){g.call(l,function(){var r;E?O.emit("rejectionHandled",e):(r=l.onrejectionhandled)&&r({promise:e,reason:e._v})})},F=function(e){var r=this;r._d||(r._d=!0,r=r._w||r,r._v=e,r._s=2,r._a||(r._a=r._c.slice()),P(r,!0))},N=function(e){var r,t=this;if(!t._d){t._d=!0,t=t._w||t;try{if(t===e)throw k("Promise can't be resolved itself");(r=$(e))?h(function(){var n={_w:t,_d:!1};try{r.call(e,d(N,n,1),d(F,n,1))}catch(e){F.call(n,e)}}):(t._v=e,t._s=1,P(t,!1))}catch(e){F.call({_w:t,_d:!1},e)}}};R||(A=function(e){f(this,A,S,"_h"),p(e),n.call(this);try{e(d(N,this,1),d(F,this,1))}catch(e){F.call(this,e)}},n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=t(219)(A.prototype,{then:function(e,r){var t=T(v(this,A));return t.ok="function"!=typeof e||e,t.fail="function"==typeof r&&r,t.domain=E?O.domain:void 0,this._c.push(t),this._a&&this._a.push(t),this._s&&P(this,!1),t.promise},catch:function(e){return this.then(void 0,e)}}),s=function(){var e=new n;this.promise=e,this.resolve=d(N,e,1),this.reject=d(F,e,1)},b.f=T=function(e){return e===A||e===i?new s(e):a(e)}),u(u.G+u.W+u.F*!R,{Promise:A}),t(37)(A,S),t(220)(S),i=t(4)[S],u(u.S+u.F*!R,S,{reject:function(e){var r=T(this),t=r.reject;return t(e),r.promise}}),u(u.S+u.F*(o||!R),S,{resolve:function(e){return C(o&&this===i?A:this,e)}}),u(u.S+u.F*!(R&&t(82)(function(e){A.all(e).catch(q)})),S,{all:function(e){var r=this,t=T(r),n=t.resolve,a=t.reject,s=y(function(){var t=[],s=0,i=1;_(e,!1,function(e){var o=s++,l=!1;t.push(void 0),i++,r.resolve(e).then(function(e){l||(l=!0,t[o]=e,--i||n(t))},a)}),--i||n(t)});return s.e&&a(s.v),t.promise},race:function(e){var r=this,t=T(r),n=t.reject,a=y(function(){_(e,!1,function(e){r.resolve(e).then(t.resolve,n)})});return a.e&&n(a.v),t.promise}})},,function(e,r,t){"use strict";var n=t(9),a=t(4),s=t(6),i=t(89),o=t(87);n(n.P+n.R,"Promise",{finally:function(e){var r=i(this,a.Promise||s.Promise),t="function"==typeof e;return this.then(t?function(t){return o(r,e()).then(function(){return t})}:e,t?function(t){return o(r,e()).then(function(){throw t})}:e)}})},function(e,r,t){"use strict";var n=t(9),a=t(51),s=t(86);n(n.S,"Promise",{try:function(e){var r=a.f(this),t=s(e);return(t.e?r.reject:r.resolve)(t.v),r.promise}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){function n(e){return"number"==typeof e&&e==a(e)}var a=t(100);e.exports=n},,,,,,,,,,,,,,function(e,r){e.exports='<tabs data="tabData" type="tabs" class="secondary" />\r\n<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n<ui-view></ui-view>'},function(e,r){e.exports='<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n\r\n<div class="row" ng-hide="order.isCustomerVisible()">\r\n    <div class="col-sm-11 col-sm-offset-1">\r\n        <div class="panel panel-warning">\r\n            <div class="panel-body">\r\n                    You do not have the required permissions to view or edit Customer information\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div ng-hide="!order.isCustomerVisible()">\r\n    <div class="row">\r\n        <div class="col-sm-11 col-sm-offset-1">\r\n        <h3>Create a stock order</h3>\r\n\r\n        <form name="stock_form" class="form top-margin-30">\r\n            <fieldset>\r\n\r\n                <div class="form-group col-sm-6">\r\n                    <label class="form-label">DEALERSHIP</label>\r\n                    <select class="form-control"\r\n                            ng-model="order.dealership"\r\n                            ng-options="dealer.id as dealer.title for dealer in choices.dealerships"\r\n                            ng-disabled="!order.isEditable() && !permissions.reassign_stock_orders"\r\n                            required>\r\n                        <option value="">\r\n                            {{ order.isStageQuoteEditable() ? \'Select a dealership\' : order.dealership_name }}\r\n                        </option>\r\n                    </select>\r\n\r\n                    <br>                \r\n                \r\n                 \r\n                    <button type="submit" class="btn btn-primary" ng-click="proceedDealerOrder(stock_form)">\r\n                        <span ng-if="!order.id">Create Dealership Order</span>\r\n                        <span ng-if="order.id && order.order_type==\'Stock\'">Save and Proceed</span>\r\n                        <span ng-if="order.id && order.order_type!=\'Stock\'">Convert to Dealership Order</span>\r\n                    </button>\r\n                </div>\r\n            </fieldset>\r\n        </form>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <div class="row">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <div class="dashed-divider-horizontal">\r\n                <span>OR</span>\r\n                <hr>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <div class="row">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <h3>Create a quote/order for a customer</h3>\r\n\r\n            <form name="customer_form" novalidate class="form top-margin-30">\r\n                <fieldset>\r\n                    <div class="row">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">DEALERSHIP</label>\r\n                            <select class="form-control"\r\n                                    name="dealership"\r\n                                    ng-model="order.dealership"\r\n                                    ng-options="dealer.id as dealer.title for dealer in choices.dealerships" required>\r\n                                <option value="">\r\n                                    {{ order.isEditable() ? \'Select a dealership\' : order.dealership_name }}\r\n                                </option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.dealership.$error" ng-if="customer_form.dealership.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">SHOW</label>\r\n                            <select class="form-control"\r\n                                    ng-model="order.show_id"\r\n                                    ng-disabled="order.show_id && order.is_expired"\r\n                                    ng-options="show.id as show.title for show in choices.shows">\r\n                                <option value="">\r\n                                    Select a Show\r\n                                </option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Customer details -->\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-6"><h4>Customer Details</h4></div>\r\n                    </div>\r\n\r\n                    <div class="row" ng-if="order.isEditable() || order.is_order_converted">\r\n                        <div class="col-sm-6" ng-if="!order.isEditable()"></div>\r\n                        <div class="col-sm-6" ng-if="order.isEditable()">\r\n                            <label class="form-label">LOOKUP EXISTING CUSTOMER</label>\r\n                            <lookup result="search.customer" min-length="3" min-wait="100"\r\n                                    ng-model="order.customer"\r\n                                    on-select="select_customer" type="customer_lookup" name="customer"\r\n                                    autocomplete="off"></lookup>\r\n                        </div>\r\n                        <div class="form-group col-sm-6" ng-if="order.is_order_converted">\r\n                            <label class="form-label">\r\n                                SALES DATE - STOCK ORDER CONVERSION</label>\r\n                            <input type="text" class="form-control" ng-model="order.order_converted" name="order_converted" placeholder="dd/mm/yyyy" ng-required="order.is_order_converted"/>\r\n                             <div ng-messages="customer_form.order_converted.$error">\r\n                             <p ng-message="required">This field is required.</p>  \r\n                             </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                FIRST NAME</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.first_name.$error" ng-if="customer_form.first_name.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                LAST NAME</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.last_name.$error" ng-if="customer_form.last_name.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                EMAIL</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.email" name="email"\r\n                                   ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                                   ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.email.$error" ng-if="customer_form.email.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">OPT IN FOR MAILING LIST\r\n                                <input type="checkbox" class="form-control form-control-small"\r\n                                       ng-model="order.customer.mailing_list" name="mailling_list"\r\n                                       ng-disabled="!isCustomerEditable()" />\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                PHONE NUMBER</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\r\n                                   ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                                   ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.phone_number.$error" ng-if="customer_form.phone_number.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">PARTNER\'S NAME</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name" ng-disabled="!isCustomerEditable()"/>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                      \r\n\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">TOW VEHICLE</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.tow_vehicle.$error" ng-if="customer_form.tow_vehicle.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                WHERE DID YOU HEAR FROM US?</label>\r\n                            <select class="form-control"\r\n                                    ng-model="order.customer.source_of_awareness"\r\n                                    name="referral"\r\n                                    ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\r\n                                    ng-disabled="!isCustomerEditable()">\r\n                                <option value="">Select an option</option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                METHOD OF CONTACT?</label>\r\n                            <select class="form-control"\r\n                                    ng-model="order.customer.acquisition_source"\r\n                                    name="referral"\r\n                                    ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\r\n                                    ng-disabled="!isCustomerEditable()">\r\n                                <option value="">Select an option</option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div ng-if="!isCustomerEditable()" class="row">\r\n                        <div class="col-sm-offset-6 col-sm-3">\r\n                            <button type="button" class="btn btn-primary" ng-click="clearCustomer()">Create new customer</button>\r\n                        </div>\r\n                        <div class="col-sm-3">\r\n                            <button type="button" class="btn btn-primary" ng-click="editCustomerFields()">Edit customer details</button>\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                    <!-- Address -->\r\n\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-6"><h4>Address</h4></div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">REGISTERED OWNER</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\r\n                                   name="registered_owner" required\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.registered_owner.$error" ng-if="customer_form.registered_owner.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">STREET ADDRESS</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" required\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.street.$error" ng-if="customer_form.street.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\r\n                            <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                            <lookup result="search.physical_suburb" min-length="3" min-wait="100"\r\n                                    ng-model="order.customer.physical_address.suburb.name"\r\n                                    on-select="select_physical_suburb" type="suburb_lookup" name="physical_address_suburb"\r\n                                    autocomplete="off"></lookup>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">CITY</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" required\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.suburb.$error" ng-if="customer_form.suburb.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-4">\r\n                            <label class="form-label">STATE</label>\r\n                            <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                    ng-model="order.customer.physical_address.suburb.post_code.state.code" name="state" required\r\n                                    ng-disabled="!isCustomerEditable()">\r\n                                <option value="">Select State</option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.state.$error" ng-if="customer_form.state.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-2">\r\n                            <label class="form-label">POSTCODE</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required ng-pattern="/^\\d{4}$/"\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.post_code.$error" ng-if="customer_form.post_code.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                                <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-40">\r\n\r\n                        <uib-accordion class="red">\r\n\r\n                            <!-- Delivery -->\r\n\r\n                            <uib-accordion-group>\r\n                                <uib-accordion-heading>\r\n                                    <div>Add Delivery details (if different)</div>\r\n                                </uib-accordion-heading>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">NAME</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.name"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">PHONE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.phone_delivery"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">STREET ADDRESS</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.address"\r\n                                               name="delivery_street" ng-required="order.customer.delivery_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.delivery_street.$error" ng-if="customer_form.delivery_street.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\r\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                                        <lookup result="search.delivery_suburb" min-length="3" min-wait="100"\r\n                                                ng-model="order.customer.delivery_address.suburb.name"\r\n                                                on-select="select_delivery_suburb" type="suburb_lookup"\r\n                                                name="delivery_address_suburb" autocomplete="off"></lookup>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">CITY</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.suburb.name"\r\n                                               name="delivery_suburb" ng-required="order.customer.delivery_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.delivery_suburb.$error" ng-if="customer_form.delivery_suburb.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-4">\r\n                                        <label class="form-label">STATE</label>\r\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                                ng-model="order.customer.delivery_address.suburb.post_code.state.code"\r\n                                                name="delivery_state" ng-required="order.customer.delivery_address.name.length"\r\n                                                ng-disabled="!isCustomerEditable()">\r\n                                            <option value="">Select State</option>\r\n                                        </select>\r\n\r\n\r\n                                        <div ng-messages="customer_form.delivery_state.$error" ng-if="customer_form.delivery_state.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-2">\r\n                                        <label class="form-label">POSTCODE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.suburb.post_code.number"\r\n                                               name="delivery_post_code" ng-required="order.customer.delivery_address.name.length" ng-pattern="/^\\d{4}$/"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.delivery_post_code.$error" ng-if="customer_form.delivery_post_code.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                            </uib-accordion-group>\r\n\r\n\r\n                            <!-- Invoice -->\r\n\r\n                            <uib-accordion-group>\r\n                                <uib-accordion-heading>\r\n                                    <div>Add Invoice details (if different)</div>\r\n                                </uib-accordion-heading>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">NAME</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.name"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">PHONE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.phone_invoice"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">STREET ADDRESS</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.address"\r\n                                               name="invoice_street" ng-required="order.customer.postal_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.invoice_street.$error" ng-if="customer_form.invoice_street.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\r\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                                        <lookup result="search.invoice_suburb"\r\n                                                on-select="select_invoice_suburb" type="suburb_lookup"\r\n                                                ng-model="order.customer.postal_address.suburb.name"\r\n                                                name="invoice_address_suburb" autocomplete="off"></lookup>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">CITY</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.suburb.name"\r\n                                               name="invoice_suburb" ng-required="order.customer.postal_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.invoice_suburb.$error" ng-if="customer_form.invoice_suburb.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-4">\r\n                                        <label class="form-label">STATE</label>\r\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                                ng-model="order.customer.postal_address.suburb.post_code.state.code"\r\n                                                name="invoice_state" ng-required="order.customer.postal_address.name.length"\r\n                                                ng-disabled="!isCustomerEditable()">\r\n                                            <option value="">Select State</option>\r\n                                        </select>\r\n\r\n                                        <div ng-messages="customer_form.invoice_state.$error" ng-if="customer_form.invoice_state.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-2">\r\n                                        <label class="form-label">POSTCODE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.suburb.post_code.number"\r\n                                               name="invoice_post_code" ng-required="order.customer.postal_address.name.length" ng-pattern="/^\\d{4}$/"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.invoice_post_code.$error" ng-if="customer_form.invoice_post_code.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                            </uib-accordion-group>\r\n                        </uib-accordion>\r\n\r\n                    </div>\r\n\r\n                    <div class="form-group">\r\n                        <button type="submit" class="btn btn-primary"\r\n                                ng-click="proceedCustomerOrder(customer_form)">\r\n                            <span ng-if="!order.id">Create Customer Order</span>\r\n                            <span ng-if="order.id && order.order_type==\'Customer\'">Save and Proceed</span>\r\n                            <span ng-if="order.id && order.order_type!=\'Customer\'">Convert to Customer Order</span>\r\n                        </button>\r\n                    </div>\r\n\r\n                </fieldset>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Not used as of 10/08/2016\r\n<div class="modal fade" id="lead-lookup">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\r\n                        aria-hidden="true">&times;</span></button>\r\n                <h4 class="modal-title">Lookup a Lead</h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <form name="lead_lookup_form">\r\n                    <div class="form-group">\r\n                        <label class="control-label">Lookup by First Name or Last Name</label>\r\n                        <lookup result="search.lead_lookup" min-length="3" min-wait="100"\r\n                                type="lead_lookup" name="physical_address_suburb"\r\n                                autocomplete="off"></lookup>\r\n                    </div>\r\n                </form>\r\n\r\n                <div class="alert alert-warning" ng-if="clone.message">{{ clone.message }}</div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-primary" ng-click="on_lead_lookup_select(lead_lookup_form)">Select</button>\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div-->\r\n';
},function(e,r){e.exports='<div class="row top-margin-40">\r\n    <div class="col-sm-12">\r\n        <div class="alert alert-warning">\r\n            {{ params.error }}\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="features">\r\n\r\n    <div class="row top-margin-40 series-info-header">\r\n        <div class="col-sm-6">\r\n            <a href="" ng-click="onOpenSeriesPhotos()">\r\n                <img ng-if="info.series_detail.photos.length" class="series-thumbnail"\r\n                     ng-src="{{ info.series_detail.photos[0].url }}"/></a>\r\n\r\n            <div class="series-caption">\r\n                <h2>{{ info.series_detail.title }}</h2>\r\n                <a ng-if="info.series_detail.photos.length > 1" href=""\r\n                   ng-click="onOpenSeriesPhotos()">View {{ info.series_detail.photos.length }}\r\n                    images</a><br>\r\n                <a ng-if="info.series_detail.plans.length" href=""\r\n                   ng-click="onOpenSeriesPlans()">View plans</a><br>\r\n            </div>\r\n        </div>\r\n        <div class="col-sm-6 pull-right">\r\n            <div ng-if="info.show_price">\r\n                Retail sales price: <span class="series-cost">{{ calculatePrice().price | currency }}</span>\r\n                <a href="" ng-click="info.show_price = !info.show_price">Hide</a>\r\n            </div>\r\n\r\n            <div ng-if="!info.show_price">\r\n                <button class="btn btn-default" ng-click="info.show_price = !info.show_price">Show Retail Price</button>\r\n            </div>\r\n\r\n            <div class="top-margin-20">\r\n                <button class="btn btn-default" ng-click="onOpenTotals()">Display Totals</button>\r\n                <button class="btn btn-default" ng-if="specials.length" ng-click="onOpenSpecials()">Special Offers and Packs</button>\r\n\r\n                <div class="btn-group" uib-dropdown>\r\n                    <button id="print-menu-button" type="button" class="btn btn-default" uib-dropdown-toggle>\r\n                        Print Menu <span class="caret"></span>\r\n                    </button>\r\n\r\n                    <ul id="print-menu" class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="print-menu-button">\r\n                        <li role="menuitem">\r\n                            <a ng-href="/orders/spec/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Specs</a>\r\n                        </li>\r\n                        <li role="menuitem">\r\n                            <a ng-href="/orders/brochure/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Brochure</a>\r\n                        </li>\r\n                        <li role="menuitem" ng-if="permissions.print_invoice">\r\n                            <a ng-href="/orders/invoice/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Invoice</a>\r\n                        </li>\r\n                        <li role="menuitem" ng-if="permissions.print_for_autocad">\r\n                            <a ng-href="/orders/autocad/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print for AutoCAD (PDF)</a>\r\n                        </li>\r\n                        <li role="menuitem" ng-if="permissions.print_for_autocad">\r\n                            <a ng-href="/orders/autocad/{{ order.id }}/?is_jpg=1" ng-click="onPrintPdfClick($event);">Print for AutoCAD (JPG)</a>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n\r\n                <br/>\r\n                <button class="btn btn-default" ng-click="onOpenTradeInComment()">\r\n                    <span class="glyphicon" ng-class="order.trade_in_comment ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\r\n                    Trade-in comment\r\n                </button>\r\n                <button class="btn" ng-class="order.orderconditions.details ? (order.orderconditions.fulfilled ? \'btn-success\' : \'btn-warning\') : \'btn-default\'" ng-click="onOpenConditions()">\r\n                    <span class="glyphicon" ng-class="order.orderconditions.details ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\r\n                    Subject To...\r\n                </button>\r\n                <button class="btn btn-default" ng-click="onOpenAfterMarketNote()">\r\n                    <span class="glyphicon" ng-class="order.aftermarketnote.note ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\r\n                    After-market note\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Specials -->\r\n    <div class="row top-margin-40 applied-specials" ng-if="hasAppliedShowSpecial()">\r\n        <label class="form-label">ADDED SPECIALS:</label>\r\n\r\n        <div class="applied-special row">\r\n            <div class="col-sm-4"><b>{{ order.show_special.name }}</b></div>\r\n            <div class="col-sm-offset-4 col-sm-2">\r\n                <div class="price-tag">\r\n                    <span class="glyphicon glyphicon-tag"></span>\r\n                    {{ (order.show_special.price || 0) | currency }}\r\n                </div>\r\n            </div>\r\n            <div class="col-sm-2">\r\n                <a ng-click="unapplyShowSpecial(order.show_special)"><i class="glyphicon glyphicon-remove"></i> Remove</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-margin-40" ng-if="internal.file_uploads | hasKeys">\r\n        <div class="alert alert-info">\r\n            <h4>File Uploads in progress:</h4>\r\n            <ul>\r\n                <li ng-repeat="(k, v) in internal.file_uploads"><b>{{ v.name }}</b>: {{ v.percentage }}%</li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-margin-40 selections-key">\r\n        <div class="col-sm-4"><b>Upgrades and Optional Extras</b></div>\r\n        <div class="col-sm-4" ng-if="order.isEditable()"><b>Key: </b>\r\n            <div class="new-selections-key-box"></div>\r\n            New selections for this customer\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-margin-20">\r\n        <bar-spinner ng-if="loading.items"></bar-spinner>\r\n\r\n        <uib-accordion ng-if="!loading.items" class="features">\r\n            <uib-accordion-group ng-repeat="category in info.items">\r\n\r\n                <uib-accordion-heading>\r\n                    <div ng-class="{\'missing-selections\': getDepartmentsMissingSelection(category).length > 0}">\r\n                        <i class="glyphicon glyphicon-chevron-right"></i>\r\n                        <i class="glyphicon glyphicon-chevron-down"></i>\r\n                        {{ category.name }}\r\n                        <span ng-if="getDepartmentsMissingSelection(category).length">: {{ getDepartmentsMissingSelection(category).length }} Selection(s) To Be Made</span>\r\n                        <!--span ng-if="order.special_features[category.id].length > 0" class="pull-right glyphicon glyphicon-exclamation-sign" title="There are special features within this category."></span-->\r\n                    </div>\r\n                </uib-accordion-heading>\r\n\r\n                <div class="row">\r\n                    <div ng-repeat="department in category.departments"\r\n                         class="col-sm-6 item-group-panel"\r\n                         ng-if="department.selections.length || department.upgrades.length">\r\n\r\n                        <form>\r\n                            <div class="btn-group" uib-dropdown\r\n                                 ng-class="{\'dirty\':department.changed, \'needs-selection\':!order.items[department.id]}">\r\n\r\n                                <div id="single-button" type="button" class="btn btn-primary" uib-dropdown-toggle ng-disabled="!order.isEditable()">\r\n\r\n                                    <div ng-if="!hasSpecialFeatureForDepartment(category, department)" ng-click="onItemPhotoClick(order.items[department.id]); $event.stopPropagation();" class="item-thumbnail">\r\n                                        <i ng-if="order.items[department.id].photo" class="glyphicon glyphicon-camera"></i>\r\n                                    </div>\r\n\r\n                                    <div ng-if="order.items[department.id]" class="item-name" truncate truncate-title="order.items[department.id].public_description">\r\n                                        <span ng-if="hasSpecialFeatureForDepartment(category, department)" class="item-special-feature">Special feature</span>\r\n                                        <span ng-if="!hasSpecialFeatureForDepartment(category, department)">{{ order.items[department.id].public_description }}</span>\r\n                                    </div>\r\n\r\n                                    <div ng-if="!order.items[department.id]" class="item-name"><b>{{ department.name }}</b></div>\r\n\r\n                                    <div ng-if="isUpgrade(department, order.items[department.id]) && (+order.items[department.id].retail_price > 0)" class="price-tag">\r\n                                        <span class="glyphicon glyphicon-tag"></span>\r\n                                        <span ng-if="order.items[department.id].price_multiply">{{ order.items[department.id].price_multiply }} x </span>\r\n                                        {{ order.items[department.id].retail_price | currency }}\r\n                                    </div>\r\n\r\n                                    <span ng-if="!department.read_only && (department.selections.length > 1 || department.upgrades.length)" class="caret"></span>\r\n\r\n                                </div>\r\n\r\n                                <ul class="dropdown-menu" role="menu" aria-labelledby="single-button"\r\n                                    ng-if="!department.read_only && (department.selections.length > 1 || department.upgrades.length || (department.selections.length == 1 && !order.items[department.id]))">\r\n\r\n                                    <li role="menuitem" ng-repeat="item in department.selections">\r\n                                        <a href="javascript:void(0);" ng-click="onItemSelect(department, item)">\r\n\r\n                                            <span ng-if="item.photo" class="pull-left" ng-click="onItemPhotoClick(item); $event.stopPropagation();">\r\n                                                <i class="glyphicon glyphicon-camera item-thumbnail"></i>\r\n                                            </span>\r\n\r\n                                            <div truncate truncate-title="item.public_description">{{ item.public_description }}</div>\r\n                                        </a>\r\n                                    </li>\r\n\r\n                                    <li ng-if="department.upgrades.length" class="divider"></li>\r\n\r\n                                    <li role="menuitem" ng-repeat="item in department.upgrades">\r\n                                        <a href="javascript:void(0);" ng-click="onItemSelect(department, item)">\r\n\r\n                                            <span class="pull-right">\r\n                                                <span class="glyphicon glyphicon-tag"></span>\r\n                                                {{ item.retail_price | currency }}\r\n                                            </span>\r\n\r\n                                            <span ng-if="item.photo" class="pull-left"\r\n                                                  ng-click="onItemPhotoClick(item); $event.stopPropagation();">\r\n                                                <i class="glyphicon glyphicon-camera item-thumbnail"></i>\r\n                                            </span>\r\n\r\n                                            <div truncate truncate-title="item.public_description">{{ item.public_description }}</div>\r\n                                        </a>\r\n                                    </li>\r\n\r\n                                </ul>\r\n                            </div>\r\n\r\n                        </form>\r\n                    </div>\r\n\r\n                    <div ng-repeat="item in getSelectedOptions(category)" class="col-sm-6 item-group-panel">\r\n                        <div class="btn-group dirty" uib-dropdown>\r\n                            <div id="single-button" type="button" class="btn btn-primary" uib-dropdown-toggle ng-class="{\'has-special\': item.special_name}" ng-disabled="!order.isEditable()">\r\n\r\n                                <span ng-if="!item.special_name && order.isEditable()" class="pull-right option-remove-icon" ng-click="onOptionSelect(item); $event.stopPropagation();">\r\n                                    <i class="glyphicon glyphicon-remove"></i>\r\n                                </span>\r\n\r\n                                <div ng-click="onItemPhotoClick(item); $event.stopPropagation();"\r\n                                     class="item-thumbnail">\r\n                                    <i ng-if="item.photo" class="glyphicon glyphicon-camera"></i>\r\n                                </div>\r\n                                <div class="item-name" truncate truncate-title="item.public_description">\r\n                                    {{ item.public_description }}\r\n                                    <div ng-if="item.special_name" class="item-special">{{ item.special_name }}</div>\r\n                                </div>\r\n                                <div class="price-tag">\r\n                                    <span class="glyphicon glyphicon-tag"></span>\r\n                                    {{ item.retail_price | currency }}\r\n                                </div>\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-30" ng-if="hasCategoryOptions(category)">\r\n                    <div class="form-group col-sm-3">\r\n                        <button type="submit" class="btn btn-primary form-control" ng-click="onOpenOptions(category)" ng-if="order.isEditable()">\r\n                            + Add Optional Extra\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </uib-accordion-group>\r\n        </uib-accordion>\r\n    </div>\r\n\r\n    <div id="options" class="modal fade">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\r\n                            aria-hidden="true">&times;</span></button>\r\n                    <h4 class="modal-title">Options</h4>\r\n                </div>\r\n                <div class="modal-body">\r\n\r\n                    <div ng-repeat="department in optionsByDepartment">\r\n                        <h4>{{ department.name }}</h4>\r\n\r\n                        <div ng-repeat="item in department.options">\r\n                            <div class="option-panel item-panel" ng-click="onOptionSelect(item)" ng-class="item.available ? \'\' : \'disabled\'">\r\n                                <div ng-click="onItemPhotoClick(item); $event.stopPropagation();" class="item-thumbnail">\r\n                                    <i ng-if="item.photo" class="glyphicon glyphicon-camera"></i>\r\n                                </div>\r\n                                <div class="item-name">{{ item.public_description }}</div>\r\n                                <div class="price-tag"><span class="glyphicon glyphicon-tag"></span>\r\n                                    {{ item.retail_price | currency }}\r\n                                </div>\r\n                                <i ng-if="!isItemSelected(item, department)" class="glyphicon glyphicon-plus indicator"></i>\r\n                                <i ng-if="isItemSelected(item, department)" class="glyphicon glyphicon-ok indicator"></i>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <div id="totals" class="modal fade">\r\n        <div class="modal-dialog wide">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\r\n                            aria-hidden="true">&times;</span></button>\r\n                    <h4 class="modal-title">Totals</h4>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <div class="totals-modal">\r\n\r\n                        <table class="table">\r\n                            <thead>\r\n                            <tr>\r\n                                <th></th>\r\n                                <th ng-if="permissions.view_order_cost_price">Manufacturing Cost</th>\r\n                                <th ng-if="permissions.view_order_cost_price">Your Margin</th>\r\n                                <th ng-if="permissions.view_order_trade_price">Wholesale</th>\r\n                                <th ng-if="permissions.view_order_trade_price">Margin</th>\r\n                                <th>Retail</th>\r\n                            </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            <tr>\r\n                                <td><h4>Adjustments</h4><i ng-if="permissions.modify_order_retail_price || order.permissions.modify_retail_prices_finalized">Please enter adjustments in these fields ></i></td>\r\n                                <td ng-if="permissions.view_order_cost_price" ng-disabled="!isModelEditable()">\r\n                                    <input ng-if="permissions.modify_order_cost_price" class="form-control" type="number" ng-model="order.price_adjustments.cost" ng-change="order.price_changed = true" />\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ order.price_adjustments.wholesale | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price" ng-disabled="!isModelEditable()">\r\n                                    <div ng-if="permissions.modify_order_trade_price">\r\n                                        <div class="row">\r\n                                            <input class="form-control" type="number" ng-model="order.price_adjustments.wholesale" ng-change="order.price_changed = true" />\r\n                                        </div>\r\n                                        <div class="row">\r\n                                            <input class="form-control" type="text" ng-model="order.price_adjustments.wholesale_comment" placeholder="Comment" ng-change="order.price_changed = true" />\r\n                                            <div ng-if="order.price_adjustments.wholesale && !order.price_adjustments.wholesale_comment">\r\n                                                <span id="wholesale_comment-error" class="error">A comment is required if a value is entered.</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ order.price_adjustments.retail | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    <input ng-if="permissions.modify_order_retail_price || order.permissions.modify_retail_prices_finalized" class="form-control" type="number" ng-model="order.price_adjustments.retail" ng-change="order.price_changed = true" />\r\n                                    <div class="top-margin-10" ng-if="!(permissions.modify_order_retail_price|| order.permissions.modify_retail_prices_finalized)">{{ order.price_adjustments.retail | currency }}</div>\r\n                                </td>\r\n                            </tr>\r\n                            <tr ng-if="permissions.view_order_trade_price">\r\n                                <td>Dealer Load Price</td>\r\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\r\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\r\n                                <td>\r\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.dealer_load" ng-change="order.price_changed = true" />\r\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.dealer_load | currency }}</span>\r\n                                </td>\r\n                                <td>\r\n                                    {{ (-order.dealer_load) | currency }}\r\n                                </td>\r\n                                <td>&nbsp;</td>\r\n                            </tr>\r\n                            <tr ng-if="permissions.view_order_trade_price">\r\n                                <td>Trade-in w/back</td>\r\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\r\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\r\n                                <td>\r\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.trade_in_write_back" ng-change="order.price_changed = true" />\r\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.trade_in_write_back | currency }}</span>\r\n                                </td>\r\n                                <td>\r\n                                    {{ (-order.trade_in_write_back) | currency }}\r\n                                </td>\r\n                                <td>&nbsp;</td>\r\n                            </tr>\r\n\r\n                            <tr ng-if="permissions.view_order_trade_price">\r\n                                <td>After Sales</td>\r\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\r\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\r\n                                <td>\r\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.after_sales.wholesale" ng-change="order.price_changed = true" />\r\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.after_sales.wholesale | currency }}</span>\r\n                                </td>\r\n                                <td>\r\n                                    {{ order.after_sales.retail-order.after_sales.wholesale | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.after_sales.retail" ng-change="order.price_changed = true" />\r\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.after_sales.retail | currency }}</span>\r\n                                </td>\r\n                            </tr>\r\n                            <tr ng-if="permissions.view_order_trade_price" >\r\n                                <td>Description</td>\r\n                                <td colspan="999">\r\n                                    <input class="form-control comments" type="text" ng-model="order.after_sales.description" ng-change="order.price_changed = true" />\r\n                                </td>\r\n                            </tr>\r\n\r\n                            <tr>\r\n                                <td>Basic Caravan Prices</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ totals.manufacture.caravan | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.wholesale.caravan - totals.manufacture.caravan) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ totals.wholesale.caravan | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.retail.caravan - totals.wholesale.caravan) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ totals.retail.caravan | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr ng-hide="options_upgrades_expanded">\r\n                                <td>Options & Upgrades (<a ng-click="options_upgrades_expanded=true">show</a>)</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ totals.manufacture.options + totals.manufacture.upgrades | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.wholesale.options - totals.manufacture.options) + (totals.wholesale.upgrades - totals.manufacture.upgrades) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ totals.wholesale.options + totals.wholesale.upgrades | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.retail.options - totals.wholesale.options) + (totals.retail.upgrades - totals.wholesale.upgrades) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ totals.retail.options + totals.retail.upgrades | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr class="totals-item totals-item-header" ng-show="options_upgrades_expanded">\r\n                                <td>Options & Upgrades (<a ng-click="options_upgrades_expanded=false">hide</a>)</td>\r\n                                <td colspan="5"></td>\r\n                            </tr>\r\n                            <tr class="totals-item totals-item-entry" ng-repeat="item in totals.options_upgrades track by $index" ng-show="options_upgrades_expanded">\r\n                                <td>{{ item.name }}</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ item.manufacture | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (item.wholesale - item.manufacture) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ item.wholesale | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (item.retail - item.wholesale) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ item.retail | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr class="totals-item totals-item-totals" ng-show="options_upgrades_expanded">\r\n                                <td>Option & Upgrades Total</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ totals.manufacture.options + totals.manufacture.upgrades | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.wholesale.options - totals.manufacture.options) + (totals.wholesale.upgrades - totals.manufacture.upgrades) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ totals.wholesale.options + totals.wholesale.upgrades | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.retail.options - totals.wholesale.options) + (totals.retail.upgrades - totals.wholesale.upgrades) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ totals.retail.options + totals.retail.upgrades | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr ng-hide="special_features_expanded">\r\n                                <td>Special Features (<a ng-click="special_features_expanded=true">show</a>)</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ totals.manufacture.special_features | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.wholesale.special_features - totals.manufacture.special_features) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ totals.wholesale.special_features | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.retail.special_features - totals.wholesale.special_features) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ totals.retail.special_features | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr class="totals-item totals-item-header" ng-show="special_features_expanded">\r\n                                <td>Special Features (<a ng-click="special_features_expanded=false">hide</a>)</td>\r\n                                <td colspan="5"></td>\r\n                            </tr>\r\n                            <tr class="totals-item totals-item-entry" ng-repeat="item in totals.special_features track by $index" ng-show="special_features_expanded">\r\n                                <td>{{ item.name }}</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ item.manufacture | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (item.wholesale - item.manufacture) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ item.wholesale | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (item.retail - item.wholesale) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ item.retail | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr class="totals-item totals-item-totals" ng-show="special_features_expanded">\r\n                                <td>Special Features Total</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ totals.manufacture.special_features | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.wholesale.special_features - totals.manufacture.special_features) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ totals.wholesale.special_features | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.retail.special_features - totals.wholesale.special_features) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ totals.retail.special_features | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr ng-if="hasAppliedShowSpecial()">\r\n                                <td>Show Special</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                </td>\r\n                                <td>\r\n                                    {{ order.show_special.price | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr id="totals--grand-totals">\r\n                                <td>Grand Totals</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ totals.manufacture.totalNoAdjustment + order.price_adjustments.cost | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale + order.dealer_load + order.trade_in_write_back + order.after_sales.wholesale| currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) - (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - order.after_sales.wholesale - order.dealer_load - order.trade_in_write_back | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>Total Excluding GST</td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost) / (1 + GST_PERCENT) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_cost_price">\r\n                                    {{ ((totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost)) / (1 + GST_PERCENT) | currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale + order.dealer_load + order.after_sales.wholesale + order.trade_in_write_back) / (1 + GST_PERCENT)| currency }}\r\n                                </td>\r\n                                <td ng-if="permissions.view_order_trade_price">\r\n                                    {{ ((totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) - (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - order.after_sales.wholesale - order.dealer_load - order.trade_in_write_back) / (1 + GST_PERCENT) | currency }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ (totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) / (1 + GST_PERCENT) | currency }}\r\n                                </td>\r\n                            </tr>\r\n                            <tr ng-if="order.permissions.modify_order_other_prices" >\r\n                                <td>Other comments</td>\r\n                                <td colspan="999">\r\n                                    <input class="form-control comments" type="text" ng-model="order.price_comment" ng-change="order.price_changed = true" />\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button ng-if="canOrderPricesBeSaved()" class="btn btn-primary" data-dismiss="modal" ng-click="saveOrder()">Save Prices</button>\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="photos" class="modal fade">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <h3><b>{{ view_header }}</b></h3>\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\r\n                            aria-hidden="true">&times;</span></button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <ul ng-if="view_photos.length" rn-carousel rn-carousel-controls class="image">\r\n                        <li ng-repeat="image in view_photos">\r\n                            <div class="layer"><img ng-src="{{ image.url }}"/></div>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="rules" class="modal fade">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <h3>Rules when choosing {{ info.rules[0].item.public_description }}</h3>\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\r\n                            aria-hidden="true">&times;</span></button>\r\n                </div>\r\n                <form name="rules_form" novalidate ng-submit="acceptRules(rules_form, rules_plan_upload)">\r\n                    <div class="modal-body">\r\n                        <div ng-repeat="rule in info.rules">\r\n                            <h3>Rule: {{ rule.title }}</h3>\r\n                            <div ng-if="rule.type_code==\'ADD_EXTRAS\'" class="alert alert-info">\r\n                                <h4>The following extras will be automatically added:</h4>\r\n                                <ul>\r\n                                    <li ng-repeat="item in rule.items">{{ item.public_description }}</li>\r\n                                </ul>\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'MAKE_SELECTION\'" class="alert alert-info">\r\n                                <h4>Please select from the following:</h4>\r\n                                <select name="make_selection" class="form-control" ng-model="rule.selection"\r\n                                        ng-options="{item:item} as item.public_description for item in rule.items" required>\r\n                                    <option value="">-- Please select --</option>\r\n                                </select>\r\n                                <div ng-messages="rules_form.make_selection.$error" ng-if="rules_form.$submitted && rules_form.$invalid">\r\n                                    <p ng-message="required">Please make a selection</p>\r\n                                </div>\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'WARNING\'" class="alert alert-warning">\r\n                                {{ rule.text }}\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'PRICE_MULTIPLY\'" class="alert alert-info" ng-init="items = priceMultiplyItems(rule.item, rule.items)">\r\n                                <h4>The price of this item will be multiplied by:</h4>\r\n                                <ul><li ng-repeat="item in items.applicableItems">\r\n                                    {{ item.quantity }} x {{ item.public_description }}\r\n                                </li></ul>\r\n                                <b>Total cost based on current selections: </b>{{ items.totalPrice | currency }}<br><br>\r\n                                <h4>Price also depends on the following items, when selected:</h4>\r\n                                <ul><li ng-repeat="item in items.otherItems">\r\n                                    {{ item.quantity }} x {{ item.public_description }}\r\n                                </li></ul>\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'CUSTOMER_ENTRY\'" class="alert alert-info">\r\n                                <h4>Please specify additional information:</h4>\r\n                                <textarea class="form-control" name="customer_entry" ng-model="rule.customer_entry" required></textarea>\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'PRODUCTION_NOTE\'" class="alert alert-info">\r\n                                <h4>The following will be added as a production note on the order:</h4>\r\n                                <p>{{ rule.text }}</p>\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'MARK_PLAN\'" class="alert alert-info">\r\n                                <p>\r\n                                    <h4>Upload a new plan for this item:</h4>\r\n                                    <button class="btn btn-primary" ngf-select ng-model="rule.file_upload" name="mark_plan"\r\n                                            ngf-max-size="20MB" required>\r\n                                        Choose Plan to Upload\r\n                                    </button>\r\n                                    <span class=\'file-upload-filename\' ng-if="rule.file_upload">{{ rule.file_upload.name }}</span>\r\n                                    <div ng-messages="rules_form.mark_plan.$error"\r\n                                         ng-if="rules_form.$submitted && rules_form.$invalid">\r\n                                        <p ng-message="required">Please select a file to upload</p>\r\n                                    </div>\r\n                                </p>\r\n                                <br>\r\n                                <p>\r\n                                <h4>Describe the location for the new item:</h4>\r\n                                <textarea class="form-control" name="mark_plan_notes" ng-model="rule.file_upload_notes"\r\n                                          required></textarea>\r\n\r\n                                <div ng-messages="rules_form.mark_plan_notes.$error"\r\n                                     ng-if="rules_form.$submitted && rules_form.$invalid">\r\n                                    <p ng-message="required">Please describe the item\'s location</p>\r\n                                </div>\r\n                                </p>\r\n                            </div>\r\n                            <div ng-if="rule.type_code==\'FORCE_SELECTION\'" class="alert alert-info">\r\n                                <h4>The following items will be automatically selected:</h4>\r\n                                <ul>\r\n                                    <li ng-repeat="item in rule.items">{{ item.public_description }}</li>\r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div class="modal-footer">\r\n                        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelRules()">\r\n                            Cancel\r\n                        </button>\r\n                        <button type="submit" class="btn btn-primary">Accept</button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="specials" class="modal fade specials">\r\n        <div class="modal-dialog medium">\r\n            <div class="modal-content">\r\n                <div class="modal-body">\r\n                    <div ng-repeat="special in specials">\r\n                        <hr ng-if="$index > 0" />\r\n                        <div class="row">\r\n                            <div class="col-sm-12">\r\n                                <h1>{{ special.name }}</h1>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class="row">\r\n                            <div class="col-sm-3">\r\n                                <h2>Offer:</h2>\r\n                            </div>\r\n                            <div class="col-sm-6">\r\n                                <h2>Availability:</h2>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class="row">\r\n                            <div class="col-sm-3">\r\n                                <h3>\r\n                                    {{ special.description }} <i ng-if="special.applied" class="applied-special glyphicon glyphicon-ok"></i>\r\n                                </h3>\r\n                            </div>\r\n                            <div class="col-sm-6">\r\n                                <p>{{ special.availability_description }}</p>\r\n                                <small ng-if="special.tac_url"><a href="{{ special.tac_url }}" target="_blank">Terms and Conditions</a></small>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div ng-if="special.price !== undefined && special.price >= 0">\r\n                            <div class="row">\r\n                                <div class="col-sm-offset-3 col-sm-2">\r\n                                    <h2>Cost:</h2>\r\n                                </div>\r\n                                <div ng-if="special.normal_price != special.price && special.price > 0" class="col-sm-2">\r\n                                    <h2>Normal price:</h2>\r\n                                </div>\r\n                            </div>\r\n                            <div class="row">\r\n                                <div class="col-sm-offset-3 col-sm-2">\r\n                                    <strong ng-if="special.price != 0">{{ special.price | currency}}</strong>\r\n                                    <strong ng-if="special.price == 0">FREE</strong>\r\n                                </div>\r\n                                <div ng-if="special.normal_price != special.price && special.price > 0" class="col-sm-2">\r\n                                    <strong>{{ special.normal_price | currency }}</strong>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class="buttons">\r\n                            <button ng-if="!special.applied" class="btn btn-primary apply" ng-click="applyShowSpecial(special)" ng-disabled="!info.items" ng-attr-title="{{ info.items?\'\':\'Loading series items...\' }}">Apply this special</button>\r\n                            <button ng-if="special.applied" class="btn btn-primary apply" ng-click="unapplyShowSpecial(special)" ng-disabled="!info.items" ng-attr-title="{{ info.items?\'\':\'Loading series items...\' }}">Unapply this special</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <div id="order_conditions" class="modal fade">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <h3>Subject to conditions:</h3>\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                        <span aria-hidden="true">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <textarea rows="10" cols="65" placeholder="Enter the specific conditions for this order..."\r\n                              class="form-control"\r\n                              ng-model="order.orderconditions.details" ></textarea>\r\n                    <div>\r\n                        <label>\r\n                            <input type="checkbox" ng-model="order.orderconditions.fulfilled" ng-disabled="!order.orderconditions.details.length"/>\r\n                            These conditions are met.\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button ng-if="order.order_stage_details.code != \'ORDER_FINALIZED\' && order.order_stage_details.code != \'ORDER\'" type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="after_market_note" class="modal fade">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <h3>After-Market notes</h3>\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                        <span aria-hidden="true">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <textarea rows="10" cols="65" placeholder="Enter your after-market notes here..."\r\n                              class="form-control"\r\n                              ng-model="order.aftermarketnote.note"></textarea>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="trade_in_comment" class="modal fade">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header">\r\n                    <h3>Trade-in comments</h3>\r\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                        <span aria-hidden="true">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <textarea rows="10" cols="65" placeholder="Enter your trade-in comments here..."\r\n                              class="form-control"\r\n                              ng-model="order.trade_in_comment"></textarea>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n';
},function(e,r){e.exports='<p ng-message="required">This field is required</p>'},function(e,r){e.exports='<form name="modelseries_form" class="form">\r\n    <div class="row top-margin-40">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <div class="row">\r\n                <div class="col-sm-6 divider dashed-divider-vertical">\r\n                    <h3>Select from base model and series</h3>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">MODEL</label>\r\n                        <select class="form-control" ng-disabled="!isModelEditable()"\r\n                                ng-model="order.modelSelection"\r\n                                ng-change="onModelChange()"\r\n                                ng-options="model.id as model.title for model in choices.models">\r\n                            <option value="">Select Model</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">SERIES</label>\r\n                        <select class="form-control" ng-disabled="!isModelEditable()"\r\n                                ng-model="order.seriesSelection"\r\n                                ng-change="onSeriesChange()"\r\n                                ng-options="series.id as series.title for series in choices.series">\r\n                            <option value="">Select Series</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">DESIRED DELIVERY MONTHS</label>\r\n                        <select class="form-control" \r\n                                ng-model="order.delivery_date"\r\n                                ng-change="onDeliveryChange()"\r\n                                ng-options="date.value as date.title for date in choices.available_delivery_months">\r\n                                <option value=""> Select Date </option> \r\n                    </select>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-12">\r\n                            <button class="btn btn-primary" ng-click="proceed()" ng-if="isModelEditable()">Continue with this Series</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <span>OR</span>\r\n                </div>\r\n\r\n                <div class="col-sm-6 divider">\r\n                    <h3>Select a previous customer/stock model</h3>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">CUSTOMER NAME OR CHASSIS NUMBER</label>\r\n                        <lookup result="order_lookup_result" placeholder="Search by Customer Name or Chassis Number"\r\n                                on-select="onOrderLookupSelect" ng-disabled="!isModelEditable()"\r\n                                url="orders/search-orders" get-extra-data="orderLookupData" min-length="2"\r\n                                min-wait="100"></lookup>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-12">\r\n                            <button class="btn btn-primary" ng-click="assignSelectedOrderAndProceed()" ng-if="isModelEditable()">Continue with items from selected order</button>\r\n                        </div>\r\n                     \r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <div ng-if="modelseries_form.$submitted && (!order.validModel() || !order.validSeries())" class="row top-margin-20">\r\n        <div class="col-sm-12">\r\n            <div class="alert alert-warning">\r\n                Please select a model and series to proceed.\r\n            </div>\r\n        </div>\r\n    </div>\r\n</form>\r\n'},function(e,r){e.exports='<top-bar>\r\n    <h4>{{ current_dealership().title }}</h4>\r\n    <h2>\r\n        <span ng-if="!order.id">New </span>\r\n        {{ order.order_stage_details ? order.order_stage_details.label : \' Quote\' }}\r\n        {{ order.id }}<span ng-if="order.chassis">, Chassis # {{ order.chassis }}</span>\r\n        {{ order.order_stage_details.code == \'CANCELLED\' ? \' (Cancelled)\' : \'\' }}\r\n    </h2>\r\n\r\n    <div class="pull-right">\r\n        <div class="row text-right">\r\n            <button ng-if="canOrderApprovalBeRequested()" class="btn btn-primary pull-right header-right-button" ng-click="requestOrderApproval()" ng-disabled="!info.items">Request to Place Order</button>\r\n\r\n            <button ng-if="canOrderBePlaced()" class="btn btn-primary pull-right header-right-button" ng-click="confirmPlaceOrder()" ng-disabled="!info.items">Place Order</button>\r\n            <button ng-if="canOrderApprovalBeRejected()" class="btn btn-primary pull-right header-right-button" ng-click="rejectOrderApproval()" ng-disabled="!info.items">Reject Order</button>\r\n            <button ng-if="canOrderBeCancelled()" class="btn btn-primary pull-right header-right-button" ng-click="confirmCancelOrder()" ng-disabled="!info.items">Cancel Order</button>\r\n\r\n            <button ng-if="canOrderBeFinalized()" class="btn btn-primary pull-right header-right-button" ng-click="finalizeOrder()" ng-disabled="!info.items">Lock Order</button>\r\n\r\n            <button ng-if="canOrderBeSaved()" class="btn btn-primary pull-right header-right-button" ng-click="saveOrder()" ng-disabled="!info.items">Save {{ order.order_stage_details.label }}</button>\r\n            <div class="spinner-container"><bar-spinner ng-if="loading.order"></bar-spinner></div>\r\n        </div>\r\n        <div class="row text-right top-margin-10">\r\n            <button ng-if="canCreateOrderForSameCustomer()" class="btn btn-primary pull-right header-right-button" ng-click="newOrderForCustomer()">Start a new Quote for this customer</button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-bar-info">\r\n        <div class="col-sm-2" ng-if="current_dealership()">\r\n            <h5>Customer</h5>\r\n            <h4 ng-if="!order.customer">(STOCK)</h4>\r\n            <h4 ng-if="order.customer">{{ order.customer.first_name }} {{ order.customer.last_name }}</h4>\r\n        </div>\r\n        <div class="col-sm-2" ng-if="order.model && order.series">\r\n            <h5>Model</h5>\r\n            <h4>{{ order.series_code }}</h4>\r\n        </div>\r\n        <div class="col-sm-2" ng-if="order.model && order.series">\r\n            <h5>Retail Sale price</h5>\r\n            <h4 name="order_retailprice" ng-if="info.show_price">{{ calculatePrice().price | currency }}</h4>\r\n            <a href="" ng-click="info.show_price = !info.show_price">\r\n                <span ng-if="info.show_price">Hide </span>\r\n                <span ng-if="!info.show_price">Show </span>price\r\n            </a>\r\n        </div>\r\n        <div class="col-sm-2" ng-if="order.model && order.series">\r\n            <h5>Stage</h5>\r\n            <h4 name="order_stage">{{ order.order_stage_details.label }}{{ order.is_expired? " (Expired)" : "" }}{{ order.order_stage_details.code == \'CANCELLED\' ? \' (Cancelled)\' : \'\' }}</h4>\r\n        </div>\r\n\r\n    </div>\r\n    <div class="row top-bar-info">\r\n        <div class="col-sm-4" ng-if="order.model && order.series">\r\n            <h5>Production Month</h5>\r\n            <h4>{{ order.production_month?order.production_month:"N/A" }}</h4>\r\n        </div>\r\n        <div class="col-sm-4" ng-if="order.model && order.series" ng-hide="true">\r\n            <h5>Production Date</h5>\r\n            <h4>{{ order.production_start_date?order.production_start_date:"N/A" }}</h4>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-bar-info alert alert-danger" ng-if="order.salesforce_sync_error">\r\n        <div class="col-sm-6">\r\n            There was an issue on the last sync with Salesforce. Please try again.\r\n        </div>\r\n        <div class="col-sm-2">\r\n            <button ng-click="updateSalesforce()">Update Salesforce</button>\r\n        </div>\r\n    </div>\r\n</top-bar>\r\n\r\n<div>\r\n    <tabs data="tabData" type="tabs" />\r\n    <a id="message-anchor"></a>\r\n    <ui-view></ui-view>\r\n</div>\r\n\r\n<div id="cancel_order" class="modal fade">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h3>Cancelling order</h3>\r\n            </div>\r\n            <div class="modal-body">\r\n                <textarea rows="10" cols="65" placeholder="Please enter the reason for cancellation..."\r\n                          maxlength="2000"\r\n                          class="form-control"\r\n                          ng-model="cancelReason"></textarea>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelOrder()">Cancel Order</button>\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<div id="place_order" class="modal fade">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h4>Confirm Order Placement</h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <div>\r\n                    <p>\r\n                        By selecting “<strong>Place Order</strong>” you acknowledge that this order becomes irrevocable for a stock unit or will attract $1000 cancellation fee if it is a customer order.\r\n                    </p>\r\n                    <p>\r\n                        If any customer order has passed the lockdown date then that order also becomes irrevocable.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">Decline</button>\r\n                <button type="button" class="btn btn-primary" ng-click="placeOrder()" data-dismiss="modal">Place Order</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="status" xmlns="http://www.w3.org/1999/html">\r\n    <div class="status-spinner"><bar-spinner ng-if="cert_loading" /></div>\r\n \r\n    <div ng-if="message" class="alert {{ message.type }}">\r\n         <div ng-repeat="text in message.message_list">{{ text }}</div> \r\n    </div>\r\n\r\n<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n    \r\n</div>\r\n\r\n<div id="status">\r\n \r\n \r\n <CENTER><h3 class="top-margin-40">CERTIFICATES FOR # {{ order.chassis }} </h3> </CENTER>\r\n \r\n    <div class="row top-margin-20">\r\n        <div class="row">\r\n        <form name="order_certificate_form" ng-submit="updateDoc(order_certificate_form, certificate.file_upload, certificate_type)">\r\n           <div class="col-sm-2">\r\n           <label class="form-label">&nbsp;</label>\r\n            </div>\r\n            <div class="col-sm-2">\r\n                <select class="form-control" ng-model="certificate_type" name="certificate_type" ng-change="populateText()">\r\n                <option value="" selected disabled hidden>Certificate Type</option>\r\n                <option value="plumbing" >Plumbing</option>\r\n                <option value="electrical">Electrical</option>">\r\n                <option value="weighbridge">Weighbridge</option>">\r\n                <option value="qualitycontrol">Quality Control</option>">\r\n                <option value="others">Others</option>">\r\n            </select>\r\n            </div>\r\n            \r\n            <div class="col-sm-2" ng-show="checkcertvalue()">\r\n                <input type="text" class="form-control" ng-model="certificate_note" name="certificate_note">\r\n            </div>\r\n            <div class="col-sm-2">\r\n                <label class="form-label"></label>\r\n                <label ng-if="certificate.file_upload">\r\n                    Selected: {{ certificate.file_upload.name }}\r\n                </label>\r\n            </div>\r\n                <div class="col-sm-2">\r\n                <button class="form-control btn btn-default" ngf-select\r\n                        ng-model="certificate.file_upload"\r\n                        name="certificate">\r\n                    Select File\r\n                </button>\r\n            </div>\r\n            <div class="col-sm-2">\r\n                <button type="submit" class="btn btn-primary form-control">Submit</button>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</div>\r\n\r\n    <div class="row header-top">\r\n        <div class="col-sm-2">Cert Id</div>\r\n        <div class="col-sm-3">Certificate Title</div>\r\n        <div class="col-sm-3">File Name</div>\r\n        <div class="col-sm-2">View</div>\r\n        <div class="col-sm-2">Delete</div>\r\n    </div>\r\n\r\n\r\n            <div class="row" ng-repeat="doc in status_docs">\r\n                        <div class="col-sm-2"> {{ doc.id }} </div>\r\n                        <div class="col-sm-3"> {{ doc.title }} </div>\r\n                        <div class="col-sm-3"> {{ doc.file }} </div>\r\n                        <div class="col-sm-2"><a target="_blank" href="{{ doc.url }}" > Download <a/></div>\r\n                        <div class="col-sm-2" ng-if="canDeleteCertificates()">\r\n                            <a href="" ng-click="deleteDoc(doc.id, \'order_certificate_form\')">Delete</a>\r\n\r\n                        </div>\r\n            </div>\r\n\r\n\r\n               \r\n            </div>\r\n\r\n\r\n\r\n\r\n\r\n'},function(e,r){e.exports=""},function(e,r){e.exports='<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n\r\n<div class="container">\r\n    <div class="row">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n\r\n            <form name="customer_form" novalidate class="top-margin-40">\r\n\r\n                <div class="row">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">SHOW</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.show_id"\r\n                                ng-options="show.id as show.title for show in choices.shows">\r\n                            <option value="">\r\n                                Select a Show\r\n                            </option>\r\n                        </select>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">DEALERSHIP</label>\r\n                        <select class="form-control"\r\n                                name="dealership"\r\n                                ng-model="order.dealership"\r\n                                ng-options="dealer.id as dealer.title for dealer in choices.dealerships" required>\r\n                            <option value="">\r\n                                {{ order.isEditable() ? \'Select a dealership\' : order.dealership_name }}\r\n                            </option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.dealership.$error" ng-if="customer_form.dealership.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-40">\r\n                    <div class="col-sm-6"><h4>Customer Details</h4></div>\r\n                </div>\r\n\r\n                <div class="row">\r\n                    <div class="col-sm-6">\r\n                        <label class="form-label">LOOKUP EXISTING CUSTOMER</label>\r\n                        <lookup result="search.customer" min-length="3" min-wait="100"\r\n                                ng-model="order.customer"\r\n                                on-select="select_customer" type="customer_lookup" name="customer"\r\n                                autocomplete="off"></lookup>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            FIRST NAME</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer"/>\r\n                        <div ng-messages="customer_form.first_name.$error" ng-if="customer_form.first_name.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            LAST NAME</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.last_name.$error" ng-if="customer_form.last_name.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            EMAIL</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.email" name="email"\r\n                               ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.email.$error" ng-if="customer_form.email.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">OPT IN FOR MAILING LIST\r\n                            <input type="checkbox" class="form-control form-control-small" ng-model="order.customer.mailing_list" name="mailling_list"\r\n                                   ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            PHONE NUMBER</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\r\n                               ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.phone_number.$error" ng-if="customer_form.phone_number.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">PARTNER\'S NAME</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">TOW VEHICLE</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.tow_vehicle.$error" ng-if="customer_form.tow_vehicle.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            WHERE DID YOU HEAR FROM US?</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.customer.source_of_awareness"\r\n                                name="referral"\r\n                                ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\r\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\r\n                            <option value="">Select an option</option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            METHOD OF CONTACT?</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.customer.acquisition_source"\r\n                                name="referral"\r\n                                ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\r\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\r\n                            <option value="">Select an option</option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div ng-if="order.customer.id" class="row">\r\n                    <div class="col-sm-offset-6 col-sm-3">\r\n                        <button type="button" class="btn btn-primary" ng-click="clearCustomer()">Create new customer</button>\r\n                    </div>\r\n                    <div class="col-sm-3">\r\n                        <button type="button" class="btn btn-primary" ng-click="editCustomerFields()">Edit customer details</button>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                <!-- Address -->\r\n\r\n\r\n                <div class="row top-margin-40">\r\n                    <div class="col-sm-6"><h4>Address</h4></div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">REGISTERED OWNER</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\r\n                               name="registered_owner" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.registered_owner.$error" ng-if="customer_form.registered_owner.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">STREET ADDRESS</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.street.$error" ng-if="customer_form.street.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6" ng-if="!order.customer.id || editCurrentCustomer">\r\n                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                        <lookup result="search.physical_suburb" min-length="3" min-wait="100"\r\n                                ng-model="order.customer.physical_address.suburb.name"\r\n                                on-select="select_physical_suburb" type="suburb_lookup" name="physical_address_suburb"\r\n                                autocomplete="off"></lookup>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">CITY</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.suburb.$error" ng-if="customer_form.suburb.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-4">\r\n                        <label class="form-label">STATE</label>\r\n                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                ng-model="order.customer.physical_address.suburb.post_code.state.code" name="state" required\r\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\r\n                            <option value="">Select State</option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.state.$error" ng-if="customer_form.state.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-2">\r\n                        <label class="form-label">POSTCODE</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required ng-pattern="/^\\d{4}$/"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.post_code.$error" ng-if="customer_form.post_code.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                            <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="form-group col-sm-6 col-sm-offset-3 top-margin-40">\r\n                    <label class="control-label"></label>\r\n\r\n                    <div class="col-sm-4 pull-right">\r\n                        <button type="submit" class="btn btn-primary form-control"\r\n                                ng-click="customerProceed(customer_form)">Continue\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="container model-select">\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            <h2>Select a model</h2>\r\n\r\n            <div class="model-panel" ng-repeat="model in choices.model_series|filter:hasModelAvailableSeries" ng-click="onModelClick(model)">\r\n                <div class="model-logo">\r\n                    <img ng-src="{{ model.logo }}" class="series-image"/>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</div>'},function(e,r){e.exports='<div class="container series-photos">\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            <h2><span class="series-code">{{ current.series.code }}</span> {{ current.series.name }}</h2>\r\n        </div>\r\n    </div>\r\n    <div class="row" ng-repeat="photo in current.series.photos">\r\n        <div class="col-sm-12">\r\n            <img ng-src="{{ photo.url }}" class="series-photo" width="600px" />\r\n        </div>\r\n    </div>\r\n\r\n    <button class="btn btn-primary" ng-click="onSeriesSelect()">Select Series</button>\r\n    <div ng-if="errors.series_select" class="top-margin-30 alert alert-danger">{{ errors.series_select }}</div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="container series-select">\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            <h2>Select a series</h2>\r\n\r\n            <div class="model-banner"><img ng-src="{{ current.model.logo }}" class="model-logo"/></div>\r\n\r\n            <div class="series-panel" ng-repeat="series in current.model.series|filter:isSeriesAvailableForDealership">\r\n                <div ng-if="series.photos.length">\r\n                    <img ng-src="{{ series.photos[0].url }}" class="series-image"/>\r\n                </div>\r\n                <h4><span class="series-code">{{ series.code }}</span> {{ series.name }}</h4>\r\n                <div class=\'row\'>\r\n                    <button class=\'col-sm-6\' ng-click="onViewSeriesPhotoClick(series)">View Series photos</button>\r\n                    <button class=\'col-sm-6\' ng-click="onStartQuoteClick(series)">Start a quote</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},function(e,r){e.exports='<div class="showroom">\r\n    <ui-view></ui-view>\r\n</div>\r\n'},function(e,r){e.exports='<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n    \r\n</div>\r\n\r\n<div id="special_features">\r\n    <!-- <label ><b>{{ order.model }} </b></label>\r\n    <p> Is Dealership User<label>{{ permissions.user_details }}</label> -->\r\n        \r\n        <div ng-if=checkdisplayview()>  \r\n        \r\n\r\n    <div class="row top-row" ng-if="permissions.set_custom_series">\r\n        <div class="col-sm-5 col-sm-offset-1">\r\n            <label for="custom_series_name">Custom series name:</label>\r\n            <input id="custom_series_name" ng-model="order.custom_series_name" />\r\n        </div>\r\n        <div class="col-sm-5">\r\n            <label for="custom_series_code">Custom series code:</label>\r\n            <input id="custom_series_code" ng-model="order.custom_series_code" />\r\n        </div>\r\n    </div>\r\n\r\n    <table>\r\n        <tr>\r\n            <th>Customer Description</th>\r\n            <th ng-if="permissions.modify_special_features_wholesale" class="price-header">$ Wholesale</th>\r\n            <th class="price-header">$ Retail</th>\r\n            <th class="attachment-header">Attachment</th>\r\n            <th class="button-header">Remove</th>\r\n            <th class="button-header">Approved</th>\r\n        </tr>\r\n\r\n    <tr ng-repeat-start="feature in order.special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td>\r\n                <input type="text" class="form-control" placeholder="e.g. ..." ng-disabled="!order.isEditable()"\r\n                    ng-change="onFeatureDetailChange(feature)"\r\n                    ng-model="feature.customer_description"/>\r\n            </td>\r\n\r\n            <td ng-if="permissions.modify_special_features_wholesale">\r\n                <input ng-disabled="order.customer_plans_approved"\r\n                    type="text" class="form-control"  maxlength="8"\r\n                    ng-change="onFeatureDetailChange(feature)"\r\n                    ng-model="feature.wholesale_price" />\r\n            </td>\r\n\r\n            <td>\r\n                <input type="text" class="form-control" maxlength="8"\r\n                    ng-change="onFeatureDetailChange(feature)"\r\n                    ng-model="feature.retail_price" ng-disabled="!order.isEditable()" />\r\n            </td>\r\n\r\n            <td>\r\n                <div class="form-group attachment">\r\n                    <div ng-if="feature.new_document || feature.document">\r\n                        <label>\r\n                            Specification doc:\r\n                        </label>\r\n                        <a ng-if="!feature.new_document" href="{{ feature.document.url }}" target="_blank">{{ feature.document.name }}</a>\r\n                        <span ng-if="feature.new_document">{{ feature.new_document.name }}</span>\r\n                        <button class="form-control btn btn-default" ng-if="order.isEditable()"\r\n                            ng-click="removeFeatureDocument(feature)">\r\n                            Remove Document\r\n                        </button>\r\n                    </div>\r\n                    <div ng-if="!feature.new_document && !feature.document">\r\n                        <button class="form-control btn btn-default" ngf-select ng-disabled="!order.isEditable()"\r\n                            ng-model="feature.new_document">\r\n                            Add Document\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </td>\r\n\r\n            <td>\r\n                <button type="text" class="form-control btn btn-primary remove-special-feature" ng-disabled="!order.isEditable()"\r\n                        ng-click="removeSpecialFeature($index)">\r\n                    <span class="glyphicon glyphicon-minus"></span>\r\n                </button>\r\n            </td>\r\n\r\n            <td class="approval-state">\r\n                <span ng-if="feature.approved !== null"\r\n                      class="status glyphicon {{ feature.approved ? \'glyphicon-ok-sign\' : \'glyphicon-remove-sign\' }}"\r\n                      ng-class="permissions.approve_special_features ? \'clickable\' : \'\'"\r\n                      ng-click="permissions.approve_special_features ? feature.approved = null : \'\'"></span>\r\n\r\n                <span ng-if="!permissions.approve_special_features && feature.approved === null" class="status glyphicon glyphicon-question-sign"></span>\r\n\r\n                <div ng-if="permissions.approve_special_features && feature.approved === null">\r\n                    <button type="button" class="btn btn-xs btn-success" ng-click="feature.approved = true">\r\n                        <span class="glyphicon glyphicon-ok-sign"></span>\r\n                    </button>\r\n                    <button type="button" class="btn btn-xs btn-danger" ng-click="feature.approved = false">\r\n                        <span class="glyphicon glyphicon-remove-sign"></span>\r\n                    </button>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n\r\n        <tr ng-if="feature.approved === false" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td colspan="999">\r\n                <input class="form-control error" ng-model="feature.reject_reason" ng-readonly="!permissions.approve_special_features" placeholder="Enter reason for rejection.."/>\r\n            </td>\r\n        </tr>\r\n\r\n        <tr ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td class="label">Work Centre:</td>\r\n            <td colspan="3">\r\n                <label>  {{ getCategory(feature) }}  \r\n                    \r\n                 </label>\r\n                <select class="form-control"\r\n                    ng-model="feature.selectedCategory"\r\n                    ng-change="onSpecialFeatureCategorySelect(feature)"\r\n                    ng-options="c as c.title for c in choices.categories track by c.id">\r\n\r\n                    <option value="">(None)</option>\r\n                </select>\r\n            </td>\r\n            <td colspan="999"></td>\r\n        </tr>\r\n\r\n        <tr ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td class="label">Replaces Item:</td>\r\n            <td colspan="3">\r\n                <label>     Item : {{  replaceItem }} \r\n                </label>\r\n                <select class="form-control"\r\n                    ng-model="feature.selectedDepartment"\r\n                    ng-change="onSpecialFeatureDepartmentSelect(feature)"\r\n                    ng-options="d as d.title disable when d.id == null for d in feature.departmentList track by d.id">\r\n\r\n                    <option value="">(None)</option>\r\n                </select>\r\n            </td>\r\n            <td colspan="999"></td>\r\n        </tr>\r\n\r\n        <tr ng-repeat-end ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td class="label">Factory Description / Production Note:</td>\r\n            <td colspan="3">\r\n                <input class="form-control" type="text" ng-model="feature.factory_description" />\r\n            </td>\r\n            <td colspan="999"></td>\r\n        </tr>\r\n\r\n        <tr class="spacer"><td></td></tr>\r\n\r\n        <tr ng-if="order.isEditable()">\r\n            <td colspan="{{ permissions.modify_special_features_wholesale ? \'4\' : \'3\' }}">&nbsp;</td>\r\n            <td>\r\n                <button type="text" class="form-control btn btn-info add-special-feature" ng-click="addSpecialFeature()">\r\n                    <span class="glyphicon glyphicon-plus"></span>\r\n                </button>\r\n            </td>\r\n        </div>\r\n\r\n    </table>\r\n</div>\r\n\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n\r\n';
},function(e,r){e.exports='<div class="row task-row" ng-if="permission">\r\n    <div class="col-sm-2">{{ title }}</div>\r\n    <div ng-if="stage" class="col-sm-2 stage-badge {{ statusClass(stage) }}">{{ stage.status }}<i ng-if="stage.status==\'Complete\'" class="glyphicon glyphicon-ok"></i><i ng-if="stage.status==\'Rejected\'" class="glyphicon glyphicon-remove"></i></div>\r\n    <div ng-if="!stage" class="col-sm-2"><i>Not yet required</i></div>\r\n    <div class="col-sm-6"><div ng-transclude></div></div>\r\n    <div class="col-sm-2"><span ng-if="stage.submitted_on">{{ stage.submitted_on | date : AppSettings.FORMAT_DATE_JS }}</span><br><span ng-if="stage.submitted_by">{{ stage.submitted_by }}</span></div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="status" xmlns="http://www.w3.org/1999/html">\n    <div class="status-spinner"><bar-spinner ng-if="loading" /></div>\n \n    <div ng-if="message" class="alert {{ message.type }}">\n         <div ng-repeat="text in message.message_list">{{ text }}</div> \n    </div>\n \n    <div>\n        <div class="row">\n            <div class="col-sm-6">\n                <label>Dealer Sales Representative:</label> {{ order.dealer_sales_rep_name }}\n                <br />\n                <button class="btn btn-default" ng-if="canChangeSalesRep()" ng-click="onOpenUpdateSalesRep()" type="button">Change Sales Representative</button>\n            </div>\n            <div class="col-sm-6">\n                <label>Customer Manager:</label> {{ order.customer_manager_name }}\n                <br />\n                <button class="btn btn-default" ng-click="onOpenUpdateCustomerManager()" type="button">Change Customer Manager</button>\n            </div>\n        </div>\n    </div>\n\n\n    <div class="row header-top">\n        <div class="col-sm-2">Stage / Task</div>\n        <div class="col-sm-2">Status</div>\n        <div class="col-sm-6">Data and Documents</div>\n        <div class="col-sm-2">Submitted</div>\n    </div>\n\n    <div class="status-container">\n        <div class="row task-row sub-header" ng-if="status.permissions.any_quote">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':sectionComplete(status.quote)}"></i>\n                    Quote\n                </h4>\n            </div>\n        </div>\n\n        <status-row title="Customer Details Captured" stage="status.quote.customer_details_captured" permission="status.permissions.view_status_customer_details_captured"></status-row>\n        <status-row title="Selections Completed" stage="status.quote.caravan_details_saved" permission="status.permissions.view_status_caravan_details_saved"></status-row>\n        <status-row title="Order Placement Requested" stage="status.quote.caravan_order_requested" permission="status.permissions.view_status_caravan_order_requested"></status-row>\n        <status-row title="Deposit Paid" stage="status.approval.deposit_paid" permission="status.permissions.view_status_deposit_paid">\n            <form ng-if="status.approval.deposit_paid"\n                  name="deposit_form"\n                  ng-submit="updateDeposit(deposit_form, status.approval.deposit_paid.data)">\n                <div class="form-group col-md-6">\n                    <label class="form-label">$ DEPOSIT AMOUNT</label>\n                    <input type="number" class="form-control" ng-model="status.approval.deposit_paid.data"\n                           name="deposit_amount" required ng-disabled="!status.approval.deposit_paid.permission"/>\n                </div>\n                <div class="col-md-6" ng-if="status.approval.deposit_paid.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Confirm Payment</button>\n                </div>\n            </form>\n        </status-row>\n        <status-row title="Order Placed" stage="status.quote.caravan_ordered" permission="status.permissions.view_status_caravan_ordered">\n            <span ng-if="status.quote.caravan_ordered.schedule_date">\n                The order is currently scheduled for {{ status.quote.caravan_ordered.schedule_date | date: AppSettings.FORMAT_DATE_MONTH_JS }}.\n            </span>\n        </status-row>\n        <status-row title="Special features reviewed" stage="status.approval.special_features_reviewed" permission="status.permissions.view_status_special_features_reviewed">\n            <div ng-if="status.approval.special_features_reviewed && status.approval.special_features_reviewed.status == \'Requires Action\' && status.approval.special_features_reviewed.permission">\n                <a ui-sref="order.special_features">Review special features</a>\n            </div>\n        </status-row>\n\n        <status-row title="Order Locked" stage="status.quote.caravan_order_finalized_at" permission="status.permissions.view_status_caravan_finalized">\n            <div ng-if="status.quote.caravan_order_finalized_at.cancelled_at">\n                The order lock has been cancelled on {{ status.quote.caravan_order_finalized_at.cancelled_at | date: AppSettings.FORMAT_DATETIME_JS }} by {{ status.quote.caravan_order_finalized_at.cancelled_by }}.<br>\n                Reason: {{ status.quote.caravan_order_finalized_at.cancel_reason }}\n            </div>\n            <div ng-if="status.quote.caravan_order_finalized_at.status == \'Complete\' && status.quote.caravan_order_finalized_at.permission">\n                <div class="form-group col-md-6 col-md-offset-3">\n                    <button type="button" ng-click="cancelFinalization()" class="btn btn-primary form-control">Cancel Order Lock</button>\n                    <span ng-if="status.quote.caravan_order_finalized_at.auto_finalization">\n                     This order has been auto locked.\n                    </span>\n                </div>\n            </div>\n        </status-row>\n\n        <div class="row task-row sub-header" ng-if="status.permissions.any_order_awaiting_approval">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':status.approval.marked_as_approved.status === \'Complete\'}"></i>\n                    Order Awaiting Approval\n                </h4>\n            </div>\n        </div>\n\n        <status-row title="Chassis Number Appointed" stage="status.approval.chassis_appointed" permission="status.permissions.view_status_chassis_number_appointed">\n            <form ng-if="status.approval.chassis_appointed" name="chassis_number_form"\n                  ng-submit="updateChassis()">\n                <div class="form-group col-md-6">\n                    <label class="form-label">CHASSIS NUMBER</label>\n                    <input type="text" class="form-control" ng-model="status.approval.chassis_appointed.data"\n                           name="chassis_number" required ng-disabled="!status.approval.chassis_appointed.permission && !status.approval.chassis_appointed.override_permission"\n                           ng-readonly="!editingChassis"\n                           focus-me="{{ editingChassis }}" />\n\n                </div>\n                <div class="form-group col-md-6" ng-if="status.approval.chassis_appointed.permission && !status.approval.chassis_appointed.data">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Assign Chassis Number</button>\n                </div>\n\n                <div class="col-sm-12"></div>\n\n                <div class="form-group col-md-6" ng-if="status.approval.chassis_appointed.override_permission">\n                    <button ng-if="!editingChassis" type="button" ng-click="enableChassisEdition()" class="btn btn-primary form-control">Manually Set Chassis Number</button>\n                    <button ng-if="editingChassis" type="button" ng-click="setChassis()" class="btn btn-primary form-control">Confirm</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Drafter Appointed" stage="status.approval.drafter_appointed" permission="status.permissions.view_status_drafter_appointed">\n            <form ng-if="status.approval.drafter_appointed" name="drafter_form"\n                  ng-submit="updateDrafter(drafter_form, status.approval.drafter_appointed.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">DRAFTER</label>\n                    <select type="date" class="form-control" ng-model="status.approval.drafter_appointed.data"\n                            ng-options="u[0] as u[1] for u in status.approval.drafter_appointed.choices"\n                            name="drafter" required ng-disabled="!status.approval.drafter_appointed.permission"></select>\n                </div>\n                <div class="col-md-4" ng-if="status.approval.drafter_appointed.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Appoint</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Customer Plans & Specs Produced" stage="status.approval.customer_plans_produced" permission="status.permissions.view_status_customer_plans_specs_produced">\n            <form name="customer_plans_form"\n                  ng-submit="updateDoc(customer_plans_form, status.approval.customer_plans_produced.file_upload, \'customer\')">\n                <div class="form-group col-md-4" ng-if="status.approval.customer_plans_produced.permission">\n                    <label class="form-label">CUSTOMER PLANS</label>\n                    <label ng-if="status.approval.customer_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.customer_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.customer_plans_produced.file_upload"\n                            name="customer_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.customer_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div class="view-specifications" ng-if="permissions.print_for_autocad">\n                        <a href="javascript:void(0);" ng-click="onPrintAutocad()">View Specifications</a>\n                    </div>\n                    <div ng-repeat="plan in status.approval.customer_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a  ng-if="status.approval.customer_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'customer\')">Delete</a></span>\n                    </div>\n                </div>\n            </form>\n        </status-row>\n\n        <!-- TODO: Client wants this removed but has indicated they may bring it back -->\n        <!--\n            <status-row class="hide" title="Customer plan approval" stage="status.approval.customer_plan_reviewed" permission="status.permissions.view_status_customer_plan_approval">\n                <div ng-if="status.approval.customer_plan_reviewed">\n                    <div ng-if="status.approval.customer_plan_reviewed.status == \'Requires Action\' && status.approval.customer_plan_reviewed.permission">\n                        <div class="checkbox">\n                            <label>\n                                <input type="checkbox" ng-model="status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked" />\n                                <i>I acknowledge that once the plan is approved, no changes can be made and production will be as per the current plan. NAC will not take responsibility for any loss due to any future change.</i>\n                            </label>\n                        </div>\n                        <div class="checkbox">\n                            <label>\n                                <input type="checkbox" ng-model="status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked" />\n                                <i>I understand that the weights and dimensions provided are an estimate only and that the final weights and dimensions will depend on the customer\'s final specifications</i>\n                            </label>\n                        </div>\n\n                        <div class="form-group col-md-6">\n                            <button type="button" ng-click="confirmRejectCustomerPlan()" class="btn btn-primary form-control">\n                                Reject Customer Plan\n                            </button>\n                        </div>\n                        <div class="form-group col-md-6">\n                            <button type="button" ng-click="approveCustomerPlan()" class="btn btn-primary form-control btn-success"\n                                    ng-disabled="!status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked || !status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked">\n                                Approve Customer Plan\n                            </button>\n                        </div>\n                    </div>\n\n                    <div ng-if="status.approval.customer_plan_reviewed.status == \'Rejected\'">\n                        Reject reason: {{ status.approval.customer_plan_reviewed.reject_reason }}\n                    </div>\n                </div>\n            </status-row>\n        -->\n\n        <status-row title="Factory Plans Produced" stage="status.approval.factory_plans_produced" permission="status.permissions.view_status_factory_plans_produced">\n            <form name="factory_plans_form"\n                  ng-submit="updateDoc(factory_plans_form, status.approval.factory_plans_produced.file_upload, \'factory\')">\n\n                <div class="form-group col-md-4" ng-if="status.approval.factory_plans_produced.permission">\n                    <label class="form-label">FACTORY PLANS</label>\n                    <label ng-if="status.approval.factory_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.factory_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.factory_plans_produced.file_upload"\n                            name="factory_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.factory_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="plan in status.approval.factory_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span ng-if="plan.file"><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a ng-if="status.approval.factory_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'factory\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.factory_plans_produced && (status.approval.factory_plans_produced.status != \'Complete\' || !status.approval.factory_plans_produced.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.factory_plans_produced.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.factory_plans_produced.data[0], \'factory\')"/>\n                        Plans attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Chassis Plans Produced" stage="status.approval.chassis_plans_produced" permission="status.permissions.view_status_chassis_plans_produced">\n            <form name="chassis_plans_form"\n                  ng-submit="updateDoc(chassis_plans_form, status.approval.chassis_plans_produced.file_upload, \'chassis\')">\n                <div class="form-group col-md-4" ng-if="status.approval.chassis_plans_produced.permission">\n                    <label class="form-label">CHASSIS PLANS</label>\n                    <label ng-if="status.approval.chassis_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.chassis_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.chassis_plans_produced.file_upload"\n                            name="chassis_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.chassis_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="plan in status.approval.chassis_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span ng-if="plan.file"><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a ng-if="status.approval.chassis_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'chassis\')">Delete</a></span>\n                        <p>\n                         \n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.chassis_plans_produced && (status.approval.chassis_plans_produced.status != \'Complete\' || !status.approval.chassis_plans_produced.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.chassis_plans_produced.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.chassis_plans_produced.data[0], \'chassis\')"/>\n                        Plans attached separately\n                    </label>\n                   \n\n                </div>\n            </form>\n        </status-row>\n<!-- status.permissions.can_delete_certificates -->\n         <status-row title="Verified By Senior Designer" stage="status.approval.senior_designer_verfied_date" permission="status.permissions.view_status_senior_designer_verfied_date">\n           \n            <form ng-if="status.approval.senior_designer_verfied_date" name="senior_designer_verfied_date_form"\n                  ng-submit="updateSeniorDesigner(senior_designer_verfied_date_form,senior_designer_date_control)">\n                \n                <div class="form-group col-md-8">\n                    <label class="form-label">Senior Designer Verfied Date</label>\n                    \n              \n\n                <input type="date" class="form-control" ng-model="senior_designer_date_control"  ng-disabled="!status.permissions.can_update_senior_designer_verfied_date">\n\n                         \n                </div>\n\n\n                <div class="col-md-4" ng-if="status.permissions.can_update_senior_designer_verfied_date">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n\n            </form>\n        </status-row>\n\n        \n        <status-row title="Purchase Order Raised " stage="status.approval.purchase_order_raised_date" permission="status.permissions.view_status_purchase_order_raised_date">\n            \n            <form ng-if="status.approval.purchase_order_raised_date" name="purchase_order_raised_date_form"\n                  ng-submit="updatePurchaseOrderRaised(purchase_order_raised_date_form, purchase_order_date_control)">\n                \n                <div class="form-group col-md-8">\n                    <label class="form-label">Purchase Order Raised</label>\n                    \n\n            <input type="date" class="form-control" ng-model="purchase_order_date_control"  ng-disabled="!status.permissions.can_update_senior_designer_verfied_date">         \n\n                </div>\n                <div class="col-md-4" ng-if="status.permissions.can_update_purchase_order_raised_date">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n       \n\n\n        <div class="row task-row sub-header" ng-if="status.permissions.any_delivery">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':sectionComplete(status.delivery)}"></i>\n                    Production \n                </h4>\n            </div>\n        </div>\n\n        <status-row title="VIN Number Assigned" stage="status.delivery.vin_number" permission="status.permissions.view_status_vin_number">\n            <form ng-if="status.delivery.vin_number" name="vin_number_form"\n                  ng-submit="updateVinNumber(vin_number_form, status.delivery.vin_number.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">VIN</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.vin_number.data"\n                           name="vin_number" required ng-disabled="!status.delivery.vin_number.permission"\n                           ng-pattern="/^.{11}\\d{6}$/" />\n                    <span class="error" ng-show="vin_number_form.vin_number.$error.pattern">VIN Number must be AAAAAAAAAAANNNNNN</span>\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.vin_number.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n        <!-- New Code -->\n        <status-row title="Actual Production Date" stage="status.delivery.actual_production_date" permission=" status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_production_date" name="actual_production_date_form"\n                  ng-submit="updateActualProductionDate(actual_production_date_form,production_date_control)">\n              \n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Production Date</label>\n                   \n                           \n                             <br>\n                     <input type="date" class="form-control" ng-model="production_date_control" >\n\n                </div>\n\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n                </form>\n                <form name="del_actual_production_date_form"  ng-submit="deleteActualProdDate(del_actual_production_date_form,status.delivery.actual_production_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n       <!--  <status-row title=" Production Comments " stage="status.delivery.actual_production_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_production_comments" name="actual_production_comments_form"\n                  ng-submit="updateActualProductionComments(actual_production_comments_form, status.delivery.actual_production_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Production Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_production_comments.data"\n                           name="actual_production_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row> -->\n\n        <!-- Chassis Section -->\n         <status-row title="Chassis Section Date" stage="status.delivery.chassis_section" permission="status.permissions.view_status_qc_date_planned">\n            \n            <form ng-if="status.delivery.chassis_section" name="chassis_section"\n                  ng-submit="updateChassisSectionDate(chassis_section, chassis_date_control)">\n\n                  <!-- status.delivery.chassis_section.data)"> -->\n                \n                <div class="form-group col-md-8">\n                    <label class="form-label"> Chassis Section Date </label>\n                   \n\n                    <input type="date" class="form-control" ng-model="chassis_date_control" name="chassis_date_id" \n                    id="chassis_date_id" >\n                    \n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n\n            </form>\n\n                <form  name="del_chassis_section" ng-submit="deleteChassisSection(del_chassis_section,status.delivery.chassis_section.data)"  >\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Chassis Section Comments" stage="status.delivery.chassis_section_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.chassis_section_comments" name="chassis_section_comments"\n                  ng-submit="updateChassisSectionComments(chassis_section_comments, status.delivery.chassis_section_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Chassis Section Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.chassis_section_comments.data"\n                           name="chassis_section_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Building Section -->\n         <status-row title="Building Section Date" stage="status.delivery.building" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.building" name="building"\n                  ng-submit="updateBuildingDate(building, building_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Building Date</label>\n                     \n                    <input type="date" class="form-control" ng-model="building_date_control" name="build_date_id" \n                    id="build_date_id" >\n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n            <form name="del_building_section" ng-submit="deleteBuildingSection(del_building_section,status.delivery.building.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n            </form>\n                \n        </status-row>\n\n        <status-row title="Building Comments" stage="status.delivery.building_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.building_comments" name="building_comments"\n                  ng-submit="updateBuildingComments(building_comments, status.delivery.building_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Building Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.building_comments.data"\n                           name="building_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n\n<!-- Pre-Wire Section -->\n         <status-row title="Pre-Wire Section Date" stage="status.delivery.prewire_section" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.prewire_section" name="prewire_section"\n                  ng-submit="updatePrewireDate(prewire_section, prewire_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Pre-Wire Date</label>\n                 \n                  <input type="date" class="form-control" ng-model="prewire_date_control" name="prewire_date_id" \n                    id="prewire_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n              <form name="del_prewire_section" ng-submit="deletePrewireSection(del_prewire_section,status.delivery.prewire_section.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Prewire Comments" stage="status.delivery.prewire_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.prewire_comments" name="prewire_comments"\n                  ng-submit="updatePrewireComments(prewire_comments, status.delivery.prewire_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Prewire Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.prewire_comments.data"\n                           name="prewire_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Plumbing Date -->\n         <status-row title="Plumbing Section Date" stage="status.delivery.plumbing_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.plumbing_date" name="plumbing_date"\n                  ng-submit="updatePlumbingDate(plumbing_date, plumbing_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Plumbing Date</label>\n                    <input type="date" class="form-control" ng-model="plumbing_date_control" name="plumbing_date_id" id="plumbing_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n              <form name="del_plumbing_date" ng-submit="deletePlumbingDate(del_plumbing_date,status.delivery.plumbing_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Plumbing Comments" stage="status.delivery.plumbing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.plumbing_comments" name="plumbing_comments"\n                  ng-submit="updatePlumbingComments(plumbing_comments, status.delivery.plumbing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Plumbing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.plumbing_comments.data"\n                           name="plumbing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n\n<!-- Aluminium Section -->\n         <status-row title="Aluminium / Fit Off" stage="status.delivery.aluminium" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.aluminium" name="aluminium"\n                  ng-submit="updateAluminiumDate(aluminium, aluminium_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Aluminium / Fit Off</label>\n                  \n                  <input type="date" class="form-control" ng-model="aluminium_date_control" name="aluminium_date_id" id="aluminium_date_id" >\n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_aluminium_section" ng-submit="deleteAluminiumSection(del_aluminium_section,status.delivery.aluminium.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Aluminium / Fit Off Comments" stage="status.delivery.aluminium_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.aluminium_comments" name="aluminium_comments"\n                  ng-submit="updateAluminiumComments(aluminium_comments, status.delivery.aluminium_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Aluminium Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.aluminium_comments.data"\n                           name="aluminium_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Finishing Section -->\n         <status-row title="Finishing Date" stage="status.delivery.finishing" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.finishing" name="finishing"\n                  ng-submit="updateFinishingDate(finishing, finishing_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Finishing Date</label>\n                  <input type="date" class="form-control" ng-model="finishing_date_control" name="finishing_date_id" id="finishing_date_id" >\n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_finishing" ng-submit="deleteFinishing(del_finishing,status.delivery.finishing.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Finishing Comments" stage="status.delivery.finishing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.finishing_comments" name="finishing_comments"\n                  ng-submit="updateFinishingComments(finishing_comments, status.delivery.finishing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Finishing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.finishing_comments.data"\n                           name="finishing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n<!-- Detailing Section -->\n        <status-row title="Detailing Canopy Date" stage="status.delivery.detailing_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.detailing_date" name="detailing_date"\n                  ng-submit="updateDetailingDate(detailing_date,detailing_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Detailing Canopy Date</label>\n                   \n        <input type="date" class="form-control" ng-model="detailing_date_control" name="detailing_date_id" id="detailing_date_id" >\n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_detailing_date" ng-submit="deleteDetailingDate(del_detailing_date,status.delivery.detailing_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Detailing Canopy Comments" stage="status.delivery.detailing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.detailing_comments" name="detailing_comments"\n                  ng-submit="updateDetalingComments(detailing_comments, status.delivery.detailing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Detailing Canopy Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.detailing_comments.data"\n                           name="detailing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Water Testing Section -->\n        <status-row title="Water Testing Date" stage="status.delivery.watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_date" name="watertest_date"\n                  ng-submit="updateWatertestDate(watertest_date, watertest_date_control)">\n                <div class="form-group col-md-8">\n                <label class="form-label">Water Test Date</label>\n        \n        <input type="date" class="form-control" ng-model="watertest_date_control" name="watertest_date_id" id="watertest_date_id" >\n        \n        </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_watertest_date" ng-submit="deleteWatertestDate(del_watertest_date,status.delivery.watertest_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n\n\n        <status-row title="Water Test Comments" stage="status.delivery.watertest_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_comments" name="watertest_comments"\n                  ng-submit="updateWatertestComments(watertest_comments, status.delivery.watertest_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Water Test Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.watertest_comments.data"\n                           name="watertest_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n        \n<!-- Weights Section -->\n        <status-row title="Weights" stage="status.delivery.weights" permission="status.permissions.view_status_weights">\n            <div class="row" ng-if="status.delivery.weights.permission">\n                <div class="form-group">\n                    <div class="row">\n                        <div class="col-md-4"><label>TARE:</label> {{ status.delivery.weights.data.weight_tare }}{{ status.delivery.weights.data.weight_tare == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>ATM:</label> {{ status.delivery.weights.data.weight_atm }}{{ status.delivery.weights.data.weight_atm == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>TOW BALL:</label> {{ status.delivery.weights.data.weight_tow_ball }}{{ status.delivery.weights.data.weight_tow_ball == null ? \'\' : \' kg\' }}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4"><label>WOB:</label> {{ status.delivery.weights.data.weight_tare - status.delivery.weights.data.weight_tow_ball }} kg</div>\n                        <div class="col-md-4"><label>GTM:</label> {{ status.delivery.weights.data.weight_atm - status.delivery.weights.data.weight_tow_ball }} kg</div>\n                        <div class="col-md-4"><label>TYRES:</label> {{ status.delivery.weights.data.weight_tyres }}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4"><label>CHASSIS GTM:</label> {{ status.delivery.weights.data.weight_chassis_gtm }}{{ status.delivery.weights.data.weight_chassis_gtm == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>GAS COMP:</label> {{ status.delivery.weights.data.weight_gas_comp }}</div>\n                        <div class="col-md-4"><label>PAYLOAD:</label> {{ status.delivery.weights.data.weight_payload }}{{ status.delivery.weights.data.weight_payload == null ? \'\' : \' kg\' }}</div>\n                    </div>\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.weights.permission">\n                    <button type="button" class="btn btn-primary form-control" ng-click="openWeightsModal()">Set Weights</button>\n                </div>\n            </div>\n        </status-row>\n        <!-- planned QC -->\n        <!--     <status-row title="Planned QC Date" stage="status.delivery.qc_date_planned" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.qc_date_planned" name="qc_date_planned_form"\n                  ng-submit="updatePlannedQcDate(qc_date_planned_form, status.delivery.qc_date_planned.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_date_planned.data"\n                           name="qc_date_planned" ng-disabled="!status.delivery.qc_date_planned.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n        -->\n        <!-- The below QC section is removed as per client instruction and merged with Final QC -->\n        <!-- <status-row title="QC Date" stage="status.delivery.qc_date_actual" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.qc_date_actual" name="qc_date_actual_form"\n                  ng-submit="updateActualQcDate(qc_date_actual_form, status.delivery.qc_date_actual.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_date_actual.data"\n                           name="qc_date_actual" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_qc_date_actual" ng-submit="deleteActualQC(del_qc_date_actual,status.delivery.qc_date_actual.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title=" QC Comments " stage="status.delivery.qc_comments" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.qc_comments" name="qc_comments_form"\n                  ng-submit="updateQCComments(qc_comments_form, status.delivery.qc_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  QC Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_comments.data"\n                           name="qc_comments" ng-disabled="!status.delivery.qc_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row> -->\n\n     <!--    <status-row title="Planned Water Test  Date" stage="status.delivery.planned_watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.planned_watertest_date" name="planned_watertest_date_form"\n                  ng-submit="updatePlannedWatertestDate(planned_watertest_date_form, status.delivery.planned_watertest_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned Water Test Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.planned_watertest_date.data"\n                           name="planned_watertest_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row> -->\n    \n      <!--  <status-row title="Actual Water Test  Date" stage="status.delivery.actual_watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_watertest_date" name="actual_watertest_date_form"\n                  ng-submit="updateActualWatertestDate(actual_watertest_date_form, status.delivery.actual_watertest_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Water Test Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_watertest_date.data"\n                           name="actual_watertest_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title=" Water Test Comments " stage="status.delivery.watertest_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_comments" name="watertest_comments_form"\n                  ng-submit="updateWatertestComments(watertest_comments_form, status.delivery.watertest_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Water Testing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.watertest_comments.data"\n                           name="watertest_comments" ng-disabled="!status.delivery.qc_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update </button>\n                </div>\n            </form>\n        </status-row>\n\n       -->\n\n         <status-row title="QC Date" stage="status.delivery.final_qc_date" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.final_qc_date" name="final_qc_date_form"\n                  ng-submit="updateFinalQcDate(final_qc_date_form, final_qc_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> QC Date</label>\n                    \n        <input type="date" class="form-control" ng-model="final_qc_date_control" name="final_qc_date_id" id="final_qc_date_id" >\n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_final_qc_date" ng-submit="deleteFinalQC(del_final_qc_date,status.delivery.final_qc_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n            \n        </status-row>\n\n        <status-row title=" QC Comments " stage="status.delivery.final_qc_comments" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.final_qc_comments" name="final_qc_comments_form"\n                  ng-submit="updateFinalQcComments(final_qc_comments_form, status.delivery.final_qc_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">   QC Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.final_qc_comments.data"\n                           name="final_qc_comments" ng-disabled="!status.delivery.final_qc_comments.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.final_qc_comments.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update  </button>\n                </div>\n            </form>\n        </status-row>\n\n        \n        <status-row title="Off-Line Date" stage="status.delivery.dispatch_date_planned" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="dispatch_date_planned_form"\n                  ng-submit="updatePlannedDispatchDate(dispatch_date_planned_form, dispatch_date_planned_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Off-Line Date</label>\n                      <input type="date" class="form-control" ng-model="dispatch_date_planned_control" name="dispatch_date_planned_id" id="dispatch_date_planned_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Collection Date" stage="status.delivery.collection_date" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="collection_date_planned_form"\n                  ng-submit="updateCollectionDate(collection_date_planned_form,collection_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Collection Date</label>\n        <input type="date" class="form-control" ng-model="collection_date_control" name="collection_date_id" id="collection_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Collection Comments" stage="status.delivery.collection_comments" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="collection_comments_planned_form"\n                  ng-submit="updateCollectionComments(collection_comments_planned_form, status.delivery.collection_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Collection Date Comments</label>\n            <input type="text" class="form-control" ng-model="status.delivery.collection_comments.data"\n                           name="collection_comments" ng-disabled="!status.delivery.dispatch_date_planned.permission"\n                           placeholder="Enter Comments" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n        <status-row title="Actual Dispatch Date" stage="status.delivery.dispatch_date_actual" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_actual" name="dispatch_date_actual_form"\n                  ng-submit="updateActualDispatchDate(dispatch_date_actual_form, dispatch_date_actual_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Dispatch Date</label>\n            <input type="date" class="form-control" ng-model="dispatch_date_actual_control" name="dispatch_date_actual_id" id="dispatch_date_actual_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n            \n            <form name="del_dispatch_date_actual" ng-submit="deleteActualDispatchDate(del_dispatch_date_actual,status.delivery.dispatch_date_actual.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title=" Dispatch Comments " stage="status.delivery.dispatch_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.dispatch_comments" name="dispatch_comments_form"\n                  ng-submit="updateDispatchComments(dispatch_comments_form, status.delivery.dispatch_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Dispatch Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.dispatch_comments.data"\n                           name="dispatch_comments" ng-disabled="!status.delivery.dispatch_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update  </button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Upload Driver Handover Form" stage="status.approval.handover_to_driver_form" permission="status.permissions.view_status_handover_to_driver_form">\n            <div class="row">\n                <form name="handover_to_driver_form"\n                      ng-submit="updateDoc(handover_to_driver_form, status.approval.handover_to_driver_form.file_upload, \'handover_to_driver_form\')">\n                    <div class="form-group col-md-4" ng-if="status.approval.handover_to_driver_form.permission">\n                        <label class="form-label">Handover Form</label>\n                        <label ng-if="status.approval.handover_to_driver_form.file_upload.name">\n                            Selected: {{ status.approval.handover_to_driver_form.file_upload.name }}\n                        </label>\n                        <button class="form-control btn btn-default" ngf-select\n                                ng-model="status.approval.handover_to_driver_form.file_upload"\n                                name="handover_to_driver" required>\n                            Select Form\n                        </button>\n                        <button type="submit" class="btn btn-primary form-control">Upload</button>\n                    </div>\n                    <div class="col-md-8" ng-if="status.approval.handover_to_driver_form">\n                        <label class="form-label">UPLOADED</label>\n                        <div ng-repeat="doc in status.approval.handover_to_driver_form.data">\n                            <b>{{ doc.file }}</b>\n                            <span ng-if="doc.file"><a target="_blank" href="{{ doc.url }}">View</a>&nbsp;<a  ng-if="status.approval.handover_to_driver_form.permission" href="" ng-click="deleteDoc(doc.id, \'handover_to_driver_form\')">Delete</a></span>\n                        </div>\n                    </div>\n                    <div class="col-md-8 col-md-offset-4" ng-if="status.approval.handover_to_driver_form && (status.approval.handover_to_driver_form.status != \'Complete\' || !status.approval.handover_to_driver_form.data[0].file)">\n                        <label>\n                            <input type="checkbox" ng-model="status.approval.handover_to_driver_form.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.handover_to_driver_form.data[0], \'handover_to_driver_form\')"/>\n                            Handover form attached separately\n                        </label>\n                    </div>\n                </form>\n            </div>\n            <div class="row" ng-if="status.approval.handover_to_driver_form.status == \'Complete\'">\n                <div class="col-md-6" ng-if="status.approval.handover_to_driver_form">\n                    <label>Recorded in Salesforce:</label>\n                </div>\n                <div class="col-md-6">\n                    {{ status.approval.handover_to_driver_form.extra_data.salesforce_handover_recorded_at | date :AppSettings.FORMAT_DATETIME_JS }}\n                </div>\n            </div>\n        </status-row>\n\n        <status-row title="Van Received at Dealership" stage="status.delivery.received_date_dealership" permission="status.permissions.view_status_received_date_dealership">\n            <form ng-if="status.delivery.received_date_dealership" name="received_date_dealership_form"\n                  ng-submit="updateDealershipReceivedDate(received_date_dealership_form, received_date_dealership_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Van Received at Dealership</label>\n          <input type="date" class="form-control" ng-model="received_date_dealership_control" name="received_date_dealership_id" id="received_date_dealership_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.received_date_dealership.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Upload Driver Handover To Dealership Form" stage="status.approval.handover_to_dealership_form" permission="status.permissions.view_status_handover_to_dealership_form">\n            <form name="handover_to_dealership_form"\n                  ng-submit="updateDoc(handover_to_dealership_form, status.approval.handover_to_dealership_form.file_upload, \'handover_to_dealership_form\')">\n                <div class="form-group col-md-4" ng-if="status.approval.handover_to_dealership_form.permission">\n                    <label class="form-label">Handover Form</label>\n                    <label ng-if="status.approval.handover_to_dealership_form.file_upload.name">\n                        Selected: {{ status.approval.handover_to_dealership_form.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.handover_to_dealership_form.file_upload"\n                            name="handover_to_dealership" required>\n                        Select Form\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.handover_to_dealership_form">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="doc in status.approval.handover_to_dealership_form.data">\n                        <b>{{ doc.file }}</b>\n                        <span ng-if="doc.file"><a target="_blank" href="{{ doc.url }}">View</a>&nbsp;<a  ng-if="status.approval.handover_to_dealership_form.permission" href="" ng-click="deleteDoc(doc.id, \'handover_to_dealership_form\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.handover_to_dealership_form && (status.approval.handover_to_dealership_form.status != \'Complete\' || !status.approval.handover_to_dealership_form.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.handover_to_dealership_form.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.handover_to_dealership_form.data[0], \'handover_to_dealership_form\')"/>\n                        Handover form attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Customer Delivery Date" stage="status.delivery.delivery_date_customer" permission="status.permissions.view_status_delivery_date_customer">\n            <div class="row">\n                <form ng-if="status.delivery.delivery_date_customer" name="delivery_date_customer_form"\n                      ng-submit="updateCustomerDeliveryDate(delivery_date_customer_form, delivery_date_customer_control)">\n                    <div class="form-group col-md-8">\n                        <label class="form-label">Customer Delivery Date</label>\n\n           <input type="date" class="form-control" ng-model="delivery_date_customer_control" name="delivery_date_customer_id" id="delivery_date_customer_id"\n           ng-disabled="!status.delivery.delivery_date_customer.permission">\n                        \n                        <span ng-show = "delivery_date_customer_form.delivery_date_customer.$error.required">This field is required!</span>\n                        <span>{{errMessage}}</span>\n                    </div>\n                    <div class="col-md-4" ng-if="status.delivery.delivery_date_customer.permission" >\n                        <label class="form-label">&nbsp;</label>\n                        <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                    </div>\n                </form>\n\n            </div>\n            <div class="row" ng-if="status.delivery.delivery_date_customer.status == \'Complete\'">\n                <div class="col-md-6">\n                    <label>Recorded in Salesforce:</label>\n                </div>\n                <div class="col-md-6">\n                    {{ status.delivery.delivery_date_customer.data.salesforce_delivery_recorded_at | date :AppSettings.FORMAT_DATETIME_JS }}\n                </div>\n            </div>\n        </status-row>\n    </div>\n\n    <h3 class="top-margin-40">Order History</h3>\n\n    <div class="row top-margin-20" ng-if="status.history.permission">\n        <form name="order_history_note_form" ng-submit="updateHistory(order_history_note_form, history)">\n            <div class="form-group col-md-6">\n                <label class="form-label">Manually add notes and/or relevant files for this order</label>\n                <textarea class="form-control" ng-model="history.note" name="history_note"></textarea>\n            </div>\n            <div class="form-group col-md-4">\n                <label class="form-label"></label>\n                <label ng-if="history.file_upload">\n                    Selected: {{ history.file_upload.name }}\n                </label>\n                <button class="form-control btn btn-default" ngf-select\n                        ng-model="history.file_upload"\n                        name="contract">\n                    Select File\n                </button>\n            </div>\n            <div class="col-md-2"> <!-- ng-if="status.history.add.permission" -->\n                <label class="form-label">&nbsp;</label>\n                <button type="submit" class="btn btn-primary form-control">Submit</button>\n            </div>\n        </form>\n    </div>\n\n    <div class="history-container">\n        <div class="row header-top top-margin-40">\n            <div class="col-sm-3">Date & Time</div>\n            <div class="col-sm-3">User</div>\n            <div class="col-sm-3">Action</div>\n            <div class="col-sm-3">Action Details</div>\n\n        </div>\n\n        <div class="row" ng-repeat="history in status_history" permission="status.permissions.view_status_qc_date_actual" >\n            <div class="col-sm-3">{{ history.update_on | date :AppSettings.FORMAT_DATETIME_JS}}</div>\n            <div class="col-sm-3">{{ history.update_by }}</div>\n            <div class="col-sm-3">{{ history.action}}</div>\n\n<!--            <div class="col-sm-2" ng-if="history.action ==\'Customer Changed\'">-->\n<!--              {{order.order_converted}}-->\n<!--            </div>-->\n<!--            <div class="col-sm-2" ng-if="history.action !=\'Customer Changed\'">-->\n<!--              &#45;&#45;-->\n<!--            </div>-->\n\n\n\n\n\n\n            <div class="col-sm-3"><div ng-repeat="note in history.notes" ng-bind-html="note">\n\n            </div>\n              <div ng-if="history.action ==\'Customer Changed\'">\n                sales date :{{order.order_converted}}\n              </div>\n            </div>\n\n\n        </div>\n    </div>\n\n\n    <div id="update_customer_manager" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Change Customer Manager</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <div>\n                        <label>Select new Customer Manager:</label>\n                        <select ng-options="u.id as u.title for u in customer_manager_list" ng-model="new_customer_manager_id"></select>\n                    </div>\n                    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateCustomerManager()">Update</button>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="update_sales_rep" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Change Sales Representative</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <div>\n                        <label>Select new Sales Representative:</label>\n                        <select ng-options="u.id as u.title for u in sales_rep_list" ng-model="new_sales_rep_id"></select>\n                    </div>\n                    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateSalesRep()">Update</button>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="customer_plan_reject_reason" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Rejection reason</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter here the reason why the customer plan is being rejected..."\n                              class="form-control"\n                              ng-model="customer_plan_reject_reason"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="processRejectCustomerPlan()">Reject</button>\n                    &nbsp;\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="order_finalization_cancel_reason" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Cancellation reason</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter here the reason why the order finalisation is cancelled..."\n                              class="form-control"\n                              ng-model="order_finalization_cancel_reason"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="processCancelFinalization()" ng-disabled="!order_finalization_cancel_reason">Cancel Order Lock</button>\n                    &nbsp;\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="delivery_weights" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Weights</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n\n                <form name="save_weight_form" ng-submit="saveWeights()">\n                    <div class="modal-body">\n                        <div class="row">\n                            <div class="col-md-4">\n                                TARE:<br>\n                                <input class="form-control" type="number" name="weight_tare" ng-model="status.delivery.new_weights.data.weight_tare" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tare.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tare.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                ATM:<br>\n                                <input class="form-control" type="number" name="weight_atm" ng-model="status.delivery.new_weights.data.weight_atm" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_atm.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_atm.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                TOW BALL:<br>\n                                <input class="form-control" type="number" name="weight_tow_ball" ng-model="status.delivery.new_weights.data.weight_tow_ball" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tow_ball.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tow_ball.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-4">WOB:<br> {{ status.delivery.new_weights.data.weight_tare - status.delivery.new_weights.data.weight_tow_ball }}  kg</div>\n                            <div class="col-md-4">GTM:<br> {{ status.delivery.new_weights.data.weight_atm - status.delivery.new_weights.data.weight_tow_ball }} kg</div>\n                            <div class="col-md-4">\n                                TYRES:<br>\n                                <input class="form-control" type="text" name="weight_tyres" ng-model="status.delivery.new_weights.data.weight_tyres" ng-min="0" />\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tyres.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tyres.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-4">\n                                CHASSIS GTM:<br>\n                                <input class="form-control" type="number" name="weight_chassis_gtm" ng-model="status.delivery.new_weights.data.weight_chassis_gtm" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_chassis_gtm.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_chassis_gtm.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                GAS COMP:<br>\n                                <input class="form-control" type="number" name="weight_gas_comp" ng-model="status.delivery.new_weights.data.weight_gas_comp" ng-pattern="/^\\d{8}$/" />\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_gas_comp.$error.pattern">Must be 8 digits</span>\n                            </div>\n                            <div class="col-md-4">\n                                PAYLOAD:<br>\n                                <input class="form-control" type="number" name="weight_payload" ng-model="status.delivery.new_weights.data.weight_payload" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_payload.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_payload.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="modal-footer">\n                        <button type="submit" class="btn btn-default" ng-disabled="!save_weight_form.$valid">Save Weights</button>\n                        &nbsp;\n                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>';
},function(e,r){e.exports='<form name="weightsize_form" novalidate class="form">\r\n    <div class="row top-margin-40">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <h2>Avg Measurements -- Estimates Only</h2>\r\n            <h5>The measurements displayed below are representing the STOCK version of this product and are not specific to the order (with all of the added options).</h5>\t\r\n            <div class="row">\r\n                <div class="col-sm-2 th">\r\n                    Travel Length : \r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Max External Travel Height: \r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Max Internal Living Height: \r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Max Travel Width:\r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Avg. Tare weight:\r\n                     \r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Avg. Tow Ball weight:\r\n                    \r\n                </div>\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.length_aframe }} mm\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.length_bumper }} mm\r\n                </div>\r\n                \r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.height_ac }} mm\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.width_awning }} mm\r\n                </div>\r\n                <div class="col-sm-2">\r\n                     {{ info.series_detail.avg_tare_weight }} kg\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.avg_ball_weight }} kg\r\n                </div>\r\n            </div>\r\n\r\n        <div class="row top-margin-40">\r\n                <div class="col-sm-3">\r\n                    <button class="btn btn-primary form-control" type="submit" ng-click="proceed(weightsize_form)" ng-if="order.isEditable()">Save and proceed\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</form>'}]);