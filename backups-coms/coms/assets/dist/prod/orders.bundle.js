webpackJsonp([6],[function(e,r,t){e.exports=t(172)},,function(e,r){"use strict";r.__esModule=!0,r.default=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var s=t(23),a=n(s);r.default=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,a.default)(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}()},,,,,,,,,,,,,,,,,,,,function(e,r,t){e.exports={default:t(25),__esModule:!0}},,function(e,r,t){t(31);var n=t(4).Object;e.exports=function(e,r,t){return n.defineProperty(e,r,t)}},,,,,,function(e,r,t){var n=t(9);n(n.S+n.F*!t(8),"Object",{defineProperty:t(11).f})},,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";function n(e){var r,t;this.promise=new e(function(e,n){if(void 0!==r||void 0!==t)throw TypeError("Bad Promise constructor");r=e,t=n}),this.resolve=s(r),this.reject=s(t)}var s=t(36);e.exports.f=function(e){return new n(e)}},,,,,,,,,,,,,,,,,,function(e,r,t){var n;(function(e,s){(function(){function a(e,r){return e.set(r[0],r[1]),e}function i(e,r){return e.add(r),e}function o(e,r,t){var n=t?t.length:0;switch(n){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}function l(e,r){for(var t=-1,n=e.length,s=-1,a=r.length,i=Array(n+a);++t<n;)i[t]=e[t];for(;++s<a;)i[t++]=r[s];return i}function d(e,r){for(var t=-1,n=e.length;++t<n&&r(e[t],t,e)!==!1;);return e}function c(e,r){for(var t=e.length;t--&&r(e[t],t,e)!==!1;);return e}function u(e,r){for(var t=-1,n=e.length;++t<n;)if(!r(e[t],t,e))return!1;return!0}function m(e,r){for(var t=-1,n=e.length,s=-1,a=[];++t<n;){var i=e[t];r(i,t,e)&&(a[++s]=i)}return a}function p(e,r){return!!e.length&&C(e,r,0)>-1}function f(e,r,t){for(var n=-1,s=e.length;++n<s;)if(t(r,e[n]))return!0;return!1}function _(e,r){for(var t=-1,n=e.length,s=Array(n);++t<n;)s[t]=r(e[t],t,e);return s}function v(e,r){for(var t=-1,n=r.length,s=e.length;++t<n;)e[s+t]=r[t];return e}function g(e,r,t,n){var s=-1,a=e.length;for(n&&a&&(t=e[++s]);++s<a;)t=r(t,e[s],s,e);return t}function h(e,r,t,n){var s=e.length;for(n&&s&&(t=e[--s]);s--;)t=r(t,e[s],s,e);return t}function b(e,r){for(var t=-1,n=e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}function y(e,r,t){for(var n=-1,s=e.length;++n<s;){var a=e[n],i=r(a);if(null!=i&&(o===Y?i===i:t(i,o)))var o=i,l=a}return l}function w(e,r,t,n){var s;return t(e,function(e,t,a){if(r(e,t,a))return s=n?t:e,!1}),s}function S(e,r,t){for(var n=e.length,s=t?n:-1;t?s--:++s<n;)if(r(e[s],s,e))return s;return-1}function C(e,r,t){if(r!==r)return N(e,t);for(var n=t-1,s=e.length;++n<s;)if(e[n]===r)return n;return-1}function O(e,r,t,n,s){return s(e,function(e,s,a){t=n?(n=!1,e):r(t,e,s,a)}),t}function k(e,r){var t=e.length;for(e.sort(r);t--;)e[t]=e[t].value;return e}function x(e,r){for(var t,n=-1,s=e.length;++n<s;){var a=r(e[n]);a!==Y&&(t=t===Y?a:t+a)}return t}function A(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}function E(e,r){return _(r,function(r){return[r,e[r]]})}function D(e){return function(r){return e(r)}}function q(e,r){return _(r,function(r){return e[r]})}function $(e,r){for(var t=-1,n=e.length;++t<n&&C(r,e[t],0)>-1;);return t}function R(e,r){for(var t=e.length;t--&&C(r,e[t],0)>-1;);return t}function T(e){return e&&e.Object===Object?e:null}function P(e,r){if(e!==r){var t=null===e,n=e===Y,s=e===e,a=null===r,i=r===Y,o=r===r;if(e>r&&!a||!s||t&&!i&&o||n&&o)return 1;if(e<r&&!t||!o||a&&!n&&s||i&&s)return-1}return 0}function j(e,r,t){for(var n=-1,s=e.criteria,a=r.criteria,i=s.length,o=t.length;++n<i;){var l=P(s[n],a[n]);if(l){if(n>=o)return l;var d=t[n];return l*("desc"==d?-1:1)}}return e.index-r.index}function I(e){return bt[e]}function M(e){return yt[e]}function F(e){return"\\"+Ct[e]}function N(e,r,t){for(var n=e.length,s=r+(t?0:-1);t?s--:++s<n;){var a=e[s];if(a!==a)return s}return-1}function L(e){var r=!1;if(null!=e&&"function"!=typeof e.toString)try{r=!!(e+"")}catch(e){}return r}function U(e,r){return e="number"==typeof e||kr.test(e)?+e:-1,r=null==r?we:r,e>-1&&e%1==0&&e<r}function W(e){for(var r,t=[];!(r=e.next()).done;)t.push(r.value);return t}function B(e){var r=-1,t=Array(e.size);return e.forEach(function(e,n){t[++r]=[n,e]}),t}function z(e,r){for(var t=-1,n=e.length,s=-1,a=[];++t<n;)e[t]===r&&(e[t]=Ae,a[++s]=t);return a}function Q(e){var r=-1,t=Array(e.size);return e.forEach(function(e){t[++r]=e}),t}function H(e){if(!e||!ut.test(e))return e.length;for(var r=ct.lastIndex=0;ct.test(e);)r++;return r}function G(e){return e.match(ct)}function V(e){return wt[e]}function K(e){function r(e){if(Si(e)&&!ec(e)&&!(e instanceof s)){if(e instanceof n)return e;if(kl.call(e,"__wrapped__"))return ws(e)}return new n(e)}function t(){}function n(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=Y}function s(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Oe,this.__views__=[]}function T(){var e=new s(this.__wrapped__);return e.__actions__=xn(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=xn(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=xn(this.__views__),e}function We(){if(this.__filtered__){var e=new s(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function kr(){var e=this.__wrapped__.value(),r=this.__dir__,t=ec(e),n=r<0,s=t?e.length:0,a=ts(0,s,this.__views__),i=a.start,o=a.end,l=o-i,d=n?o:i-1,c=this.__iteratees__,u=c.length,m=0,p=Vl(l,this.__takeCount__);if(!t||s<fe||s==l&&p==l)return vn(e,this.__actions__);var f=[];e:for(;l--&&m<p;){d+=r;for(var _=-1,v=e[d];++_<u;){var g=c[_],h=g.iteratee,b=g.type,y=h(v);if(b==ve)v=y;else if(!y){if(b==_e)continue e;break e}}f[m++]=v}return f}function Dr(){}function qr(e,r){return Rr(e,r)&&delete e[r]}function $r(e,r){if(rd){var t=e[r];return t===be?Y:t}return kl.call(e,r)?e[r]:Y}function Rr(e,r){return rd?e[r]!==Y:kl.call(e,r)}function Tr(e,r,t){e[r]=rd&&t===Y?be:t}function Pr(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function jr(){this.__data__={hash:new Dr,map:Zl?new Zl:[],string:new Dr}}function Ir(e){var r=this.__data__;return cs(e)?qr("string"==typeof e?r.string:r.hash,e):Zl?r.map.delete(e):Kr(r.map,e)}function Mr(e){var r=this.__data__;return cs(e)?$r("string"==typeof e?r.string:r.hash,e):Zl?r.map.get(e):Yr(r.map,e)}function Fr(e){var r=this.__data__;return cs(e)?Rr("string"==typeof e?r.string:r.hash,e):Zl?r.map.has(e):Jr(r.map,e)}function Nr(e,r){var t=this.__data__;return cs(e)?Tr("string"==typeof e?t.string:t.hash,e,r):Zl?t.map.set(e,r):Xr(t.map,e,r),this}function Lr(e){var r=-1,t=e?e.length:0;for(this.__data__=new Pr;++r<t;)this.push(e[r])}function Ur(e,r){var t=e.__data__;if(cs(r)){var n=t.__data__,s="string"==typeof r?n.string:n.hash;return s[r]===be}return t.has(r)}function Wr(e){var r=this.__data__;if(cs(e)){var t=r.__data__,n="string"==typeof e?t.string:t.hash;n[e]=be}else r.set(e,be)}function Br(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}function zr(){this.__data__={array:[],map:null}}function Qr(e){var r=this.__data__,t=r.array;return t?Kr(t,e):r.map.delete(e)}function Hr(e){var r=this.__data__,t=r.array;return t?Yr(t,e):r.map.get(e)}function Gr(e){var r=this.__data__,t=r.array;return t?Jr(t,e):r.map.has(e)}function Vr(e,r){var t=this.__data__,n=t.array;n&&(n.length<fe-1?Xr(n,e,r):(t.array=null,t.map=new Pr(n)));var s=t.map;return s&&s.set(e,r),this}function Kr(e,r){var t=Zr(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():Ul.call(e,t,1),!0}function Yr(e,r){var t=Zr(e,r);return t<0?Y:e[t][1]}function Jr(e,r){return Zr(e,r)>-1}function Zr(e,r){for(var t=e.length;t--;)if(si(e[t][0],r))return t;return-1}function Xr(e,r,t){var n=Zr(e,r);n<0?e.push([r,t]):e[n][1]=t}function et(e,r,t,n){return e===Y||si(e,Cl[t])&&!kl.call(n,t)?r:e}function rt(e,r,t){(t===Y||si(e[r],t))&&("number"!=typeof r||t!==Y||r in e)||(e[r]=t)}function tt(e,r,t){var n=e[r];si(n,t)&&(!si(n,Cl[r])||kl.call(e,r))&&(t!==Y||r in e)||(e[r]=t)}function nt(e,r){return e&&An(r,ao(r),e)}function st(e,r){for(var t=-1,n=null==e,s=r.length,a=Array(s);++t<s;)a[t]=n?Y:ro(e,r[t]);return a}function at(e,r,t){return e===e&&(t!==Y&&(e=e<=t?e:t),r!==Y&&(e=e>=r?e:r)),e}function it(e,r,t,n,s,a){var i;if(t&&(i=s?t(e,n,s,a):t(e)),i!==Y)return i;if(!wi(e))return e;var o=ec(e);if(o){if(i=ss(e),!r)return xn(e,i)}else{var l=rs(e),c=l==Te||l==Pe;if(l!=Me&&l!=Ee&&(!c||s))return ht[l]?is(e,l,r):s?e:{};if(L(e))return s?e:{};if(i=as(c?{}:e),!r)return Dn(e,nt(i,e))}a||(a=new Br);var u=a.get(e);return u?u:(a.set(e,i),(o?d:xt)(e,function(n,s){tt(i,s,it(n,r,t,s,e,a))}),o?i:Dn(e,i))}function ot(e){var r=ao(e),t=r.length;return function(n){if(null==n)return!t;for(var s=t;s--;){var a=r[s],i=e[a],o=n[a];if(o===Y&&!(a in Object(n))||!i(o))return!1}return!0}}function lt(e,r,t){if("function"!=typeof e)throw new wl(he);return Ll(function(){e.apply(Y,t)},r)}function ct(e,r,t,n){var s=-1,a=p,i=!0,o=e.length,l=[],d=r.length;if(!o)return l;t&&(r=_(r,D(t))),n?(a=f,i=!1):r.length>=fe&&(a=Ur,i=!1,r=new Lr(r));e:for(;++s<o;){var c=e[s],u=t?t(c):c;if(i&&u===u){for(var m=d;m--;)if(r[m]===u)continue e;l.push(c)}else a(r,u,n)||l.push(c)}return l}function bt(e,r){var t=!0;return cd(e,function(e,n,s){return t=!!r(e,n,s)}),t}function yt(e,r,t,n){var s=e.length;for(t=Li(t),t<0&&(t=-t>s?0:s+t),n=n===Y||n>s?s:Li(n),n<0&&(n+=s),n=t>n?0:Ui(n);t<n;)e[t++]=r;return e}function wt(e,r){var t=[];return cd(e,function(e,n,s){r(e,n,s)&&t.push(e)}),t}function St(e,r,t,n){n||(n=[]);for(var s=-1,a=e.length;++s<a;){var i=e[s];di(i)&&(t||ec(i)||oi(i))?r?St(i,r,t,n):v(n,i):t||(n[n.length]=i)}return n}function Ct(e,r){return null==e?e:md(e,r,io)}function xt(e,r){return e&&md(e,r,ao)}function At(e,r){return e&&pd(e,r,ao)}function Et(e,r){return m(r,function(r){return hi(e[r])})}function Dt(e,r){r=ds(r,e)?[r+""]:mn(r);for(var t=0,n=r.length;null!=e&&t<n;)e=e[r[t++]];return t&&t==n?e:Y}function qt(e,r){return kl.call(e,r)||"object"==typeof e&&r in e&&null===Il(e)}function $t(e,r){return r in Object(e)}function Pt(e,r,t){return e>=Vl(r,t)&&e<Gl(r,t)}function jt(e,r,t){for(var n=t?f:p,s=e.length,a=s,i=Array(s),o=[];a--;){var l=e[a];a&&r&&(l=_(l,D(r))),i[a]=!t&&(r||l.length>=120)?new Lr(a&&l):Y}l=e[0];var d=-1,c=l.length,u=i[0];e:for(;++d<c;){var m=l[d],v=r?r(m):m;if(!(u?Ur(u,v):n(o,v,t))){for(var a=s;--a;){var g=i[a];if(!(g?Ur(g,v):n(e[a],v,t)))continue e}u&&u.push(v),o.push(m)}}return o}function It(e,r,t){ds(r,e)||(r=mn(r),e=vs(e,r),r=Ns(r));var n=null==e?e:e[r];return null==n?Y:o(n,e,t)}function Mt(e,r,t,n,s){return e===r||(null==e||null==r||!wi(e)&&!Si(r)?e!==e&&r!==r:Ft(e,r,Mt,t,n,s))}function Ft(e,r,t,n,s,a){var i=ec(e),o=ec(r),l=De,d=De;i||(l=rs(e),l==Ee?l=Me:l!=Me&&(i=ji(e))),o||(d=rs(r),d==Ee?d=Me:d!=Me&&(o=ji(r)));var c=l==Me&&!L(e),u=d==Me&&!L(r),m=l==d;if(m&&!i&&!c)return Kn(e,r,l,t,n,s);var p=s&de;if(!p){var f=c&&kl.call(e,"__wrapped__"),_=u&&kl.call(r,"__wrapped__");if(f||_)return t(f?e.value():e,_?r.value():r,n,s,a)}return!!m&&(a||(a=new Br),(i?Vn:Yn)(e,r,t,n,s,a))}function Nt(e,r,t,n){var s=t.length,a=s,i=!n;if(null==e)return!a;for(e=Object(e);s--;){var o=t[s];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++s<a;){o=t[s];var l=o[0],d=e[l],c=o[1];if(i&&o[2]){if(d===Y&&!(l in e))return!1}else{var u=new Br,m=n?n(d,c,l,e,r,u):Y;if(!(m===Y?Mt(c,d,n,le|de,u):m))return!1}}return!0}function Lt(e){var r=typeof e;return"function"==r?e:null==e?Ko:"object"==r?ec(e)?Qt(e[0],e[1]):zt(e):nl(e)}function Ut(e){return Hl(Object(e))}function Wt(e){e=null==e?e:Object(e);var r=[];for(var t in e)r.push(t);return r}function Bt(e,r){var t=-1,n=li(e)?Array(e.length):[];return cd(e,function(e,s,a){n[++t]=r(e,s,a)}),n}function zt(e){var r=Xn(e);if(1==r.length&&r[0][2]){var t=r[0][0],n=r[0][1];return function(e){return null!=e&&(e[t]===n&&(n!==Y||t in Object(e)))}}return function(t){return t===e||Nt(t,e,r)}}function Qt(e,r){return function(t){var n=ro(t,e);return n===Y&&n===r?no(t,e):Mt(r,n,Y,le|de)}}function Ht(e,r,t,n,s){if(e!==r){var a=ec(r)||ji(r)?Y:io(r);d(a||r,function(i,o){if(a&&(o=i,i=r[o]),wi(i))s||(s=new Br),Gt(e,r,o,t,Ht,n,s);else{var l=n?n(e[o],i,o+"",e,r,s):Y;l===Y&&(l=i),rt(e,o,l)}})}}function Gt(e,r,t,n,s,a,i){var o=e[t],l=r[t],d=i.get(l)||i.get(o);if(d)return void rt(e,t,d);var c=a?a(o,l,t+"",e,r,i):Y,u=c===Y;u&&(c=l,ec(l)||ji(l)?c=ec(o)?n?xn(o):o:di(o)?xn(o):it(l):qi(l)||oi(l)?c=oi(o)?Bi(o):!wi(o)||n&&hi(o)?it(l):n?it(o):o:u=!1),i.set(l,c),u&&s(c,l,n,a,i),rt(e,t,c)}function Vt(e,r,t){var n=-1,s=Zn();r=_(r.length?r:Array(1),function(e){return s(e)});var a=Bt(e,function(e,t,s){var a=_(r,function(r){return r(e)});return{criteria:a,index:++n,value:e}});return k(a,function(e,r){return j(e,r,t)})}function Kt(e,r){return e=Object(e),g(r,function(r,t){return t in e&&(r[t]=e[t]),r},{})}function Yt(e,r){var t={};return Ct(e,function(e,n){r(e,n)&&(t[n]=e)}),t}function Jt(e){return function(r){return null==r?Y:r[e]}}function Zt(e){return function(r){return Dt(r,e)}}function Xt(e,r){return en(e,r)}function en(e,r,t){var n=-1,s=r.length,a=e;for(t&&(a=_(e,function(e){return t(e)}));++n<s;)for(var i=0,o=r[n],l=t?t(o):o;(i=C(a,l,i))>-1;)a!==e&&Ul.call(a,i,1),Ul.call(e,i,1);return e}function rn(e,r){for(var t=e?r.length:0,n=t-1;t--;){var s=r[t];if(n==t||s!=a){var a=s;if(U(s))Ul.call(e,s,1);else if(ds(s,e))delete e[s];else{var i=mn(s),o=vs(e,i);null!=o&&delete o[Ns(i)]}}}return e}function tn(e,r){return e+Bl(Yl()*(r-e+1))}function nn(e,r,t,n){for(var s=-1,a=Gl(Wl((r-e)/(t||1)),0),i=Array(a);a--;)i[n?a:++s]=e,e+=t;return i}function sn(e,r,t,n){r=ds(r,e)?[r+""]:mn(r);for(var s=-1,a=r.length,i=a-1,o=e;null!=o&&++s<a;){var l=r[s];if(wi(o)){var d=t;if(s!=i){var c=o[l];d=n?n(c,l,o):Y,d===Y&&(d=null==c?U(r[s+1])?[]:{}:c)}tt(o,l,d)}o=o[l]}return e}function an(e,r,t){var n=-1,s=e.length;r<0&&(r=-r>s?0:s+r),t=t>s?s:t,t<0&&(t+=s),s=r>t?0:t-r>>>0,r>>>=0;for(var a=Array(s);++n<s;)a[n]=e[n+r];return a}function on(e,r){var t;return cd(e,function(e,n,s){return t=r(e,n,s),!t}),!!t}function ln(e,r,t){var n=0,s=e?e.length:n;if("number"==typeof r&&r===r&&s<=xe){for(;n<s;){var a=n+s>>>1,i=e[a];(t?i<=r:i<r)&&null!==i?n=a+1:s=a}return s}return dn(e,r,Ko,t)}function dn(e,r,t,n){r=t(r);for(var s=0,a=e?e.length:0,i=r!==r,o=null===r,l=r===Y;s<a;){var d=Bl((s+a)/2),c=t(e[d]),u=c!==Y,m=c===c;if(i)var p=m||n;else p=o?m&&u&&(n||null!=c):l?m&&(n||u):null!=c&&(n?c<=r:c<r);p?s=d+1:a=d}return Vl(a,ke)}function cn(e){return un(e)}function un(e,r){for(var t=0,n=e.length,s=e[0],a=r?r(s):s,i=a,o=0,l=[s];++t<n;)s=e[t],a=r?r(s):s,si(a,i)||(i=a,l[++o]=s);return l}function mn(e){return ec(e)?e:hs(e)}function pn(e,r,t){var n=-1,s=p,a=e.length,i=!0,o=[],l=o;if(t)i=!1,s=f;else if(a>=fe){var d=r?null:_d(e);if(d)return Q(d);i=!1,s=Ur,l=new Lr}else l=r?[]:o;e:for(;++n<a;){var c=e[n],u=r?r(c):c;if(i&&u===u){for(var m=l.length;m--;)if(l[m]===u)continue e;r&&l.push(u),o.push(c)}else s(l,u,t)||(l!==o&&l.push(u),o.push(c))}return o}function fn(e,r){r=ds(r,e)?[r+""]:mn(r),e=vs(e,r);var t=Ns(r);return null==e||!to(e,t)||delete e[t]}function _n(e,r,t,n){for(var s=e.length,a=n?s:-1;(n?a--:++a<s)&&r(e[a],a,e););return t?an(e,n?0:a,n?a+1:s):an(e,n?a+1:0,n?s:a)}function vn(e,r){var t=e;return t instanceof s&&(t=t.value()),g(r,function(e,r){return r.func.apply(r.thisArg,v([e],r.args))},t)}function gn(e,r,t){for(var n=-1,s=e.length;++n<s;)var a=a?v(ct(a,e[n],r,t),ct(e[n],a,r,t)):e[n];return a&&a.length?pn(a,r,t):[]}function hn(e){var r=e.constructor,t=new r(e.byteLength),n=new Tl(t);return n.set(new Tl(e)),t}function bn(e){var r=e.constructor;return g(B(e),a,new r)}function yn(e){var r=e.constructor,t=new r(e.source,br.exec(e));return t.lastIndex=e.lastIndex,t}function wn(e){var r=e.constructor;return g(Q(e),i,new r)}function Sn(e){return Rl?Object(id.call(e)):{}}function Cn(e,r){var t=e.buffer,n=e.constructor;return new n(r?hn(t):t,e.byteOffset,e.length)}function On(e,r,t){for(var n=t.length,s=-1,a=Gl(e.length-n,0),i=-1,o=r.length,l=Array(o+a);++i<o;)l[i]=r[i];for(;++s<n;)l[t[s]]=e[s];for(;a--;)l[i++]=e[s++];return l}function kn(e,r,t){for(var n=-1,s=t.length,a=-1,i=Gl(e.length-s,0),o=-1,l=r.length,d=Array(i+l);++a<i;)d[a]=e[a];for(var c=a;++o<l;)d[c+o]=r[o];for(;++n<s;)d[c+t[n]]=e[a++];return d}function xn(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}function An(e,r,t){return En(e,r,t)}function En(e,r,t,n){t||(t={});for(var s=-1,a=r.length;++s<a;){var i=r[s],o=n?n(t[i],e[i],i,t,e):e[i];tt(t,i,o)}return t}function Dn(e,r){return An(e,hd(e),r)}function qn(e,r){return function(t,n){var s=r?r():{};if(n=Zn(n),ec(t))for(var a=-1,i=t.length;++a<i;){var o=t[a];e(s,o,n(o),t)}else cd(t,function(r,t,a){e(s,r,n(r),a)});return s}}function $n(e){return Ka(function(r,t){var n=-1,s=t.length,a=s>1?t[s-1]:Y,i=s>2?t[2]:Y;for(a="function"==typeof a?(s--,a):Y,i&&ls(t[0],t[1],i)&&(a=s<3?Y:a,s=1),r=Object(r);++n<s;){var o=t[n];o&&e(r,o,n,a)}return r})}function Rn(e,r){return function(t,n){if(null==t)return t;if(!li(t))return e(t,n);for(var s=t.length,a=r?s:-1,i=Object(t);(r?a--:++a<s)&&n(i[a],a,i)!==!1;);return t}}function Tn(e){return function(r,t,n){for(var s=-1,a=Object(r),i=n(r),o=i.length;o--;){var l=i[e?o:++s];if(t(a[l],l,a)===!1)break}return r}}function Pn(e,r,t){function n(){var r=this&&this!==Rt&&this instanceof n?a:e;return r.apply(s?t:this,arguments)}var s=r&Z,a=Mn(e);return n}function jn(e){return function(r){r=Qi(r);var t=ut.test(r)?G(r):Y,n=t?t[0]:r.charAt(0),s=t?t.slice(1).join(""):r.slice(1);return n[e]()+s}}function In(e){return function(r){return g(Qo(ko(r)),e,"")}}function Mn(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var t=dd(e.prototype),n=e.apply(t,r);return wi(n)?n:t}}function Fn(e,r,t){function n(){for(var a=arguments.length,i=a,l=Array(a),d=this&&this!==Rt&&this instanceof n?s:e,c=n.placeholder;i--;)l[i]=arguments[i];var u=a<3&&l[0]!==c&&l[a-1]!==c?[]:z(l,c);return a-=u.length,a<t?Qn(e,r,Ln,c,Y,l,u,Y,Y,t-a):o(d,this,l)}var s=Mn(e);return n}function Nn(e){return Ka(function(r){r=St(r);var t=r.length,s=t,a=n.prototype.thru;for(e&&r.reverse();s--;){var i=r[s];if("function"!=typeof i)throw new wl(he);if(a&&!o&&"wrapper"==Jn(i))var o=new n([],!0)}for(s=o?s:t;++s<t;){i=r[s];var l=Jn(i),d="wrapper"==l?vd(i):Y;o=d&&us(d[0])&&d[1]==(ae|re|ne|ie)&&!d[4].length&&1==d[9]?o[Jn(d[0])].apply(o,d[3]):1==i.length&&us(i)?o[l]():o.thru(i)}return function(){var e=arguments,n=e[0];if(o&&1==e.length&&ec(n)&&n.length>=fe)return o.plant(n).value();for(var s=0,a=t?r[s].apply(this,e):n;++s<t;)a=r[s].call(this,a);return a}})}function Ln(e,r,t,n,s,a,i,o,l,d){function c(){for(var h=arguments.length,b=h,y=Array(h);b--;)y[b]=arguments[b];if(n&&(y=On(y,n,s)),a&&(y=kn(y,a,i)),f||_){var w=c.placeholder,S=z(y,w);if(h-=S.length,h<d)return Qn(e,r,Ln,w,t,y,S,o,l,d-h)}var C=m?t:this,O=p?C[e]:e;return o?y=gs(y,o):v&&y.length>1&&y.reverse(),u&&l<y.length&&(y.length=l),this&&this!==Rt&&this instanceof c&&(O=g||Mn(O)),O.apply(C,y)}var u=r&ae,m=r&Z,p=r&X,f=r&re,_=r&te,v=r&oe,g=p?Y:Mn(e);return c}function Un(e){return Ka(function(r){return r=_(St(r),Zn()),Ka(function(t){var n=this;return e(r,function(e){return o(e,n,t)})})})}function Wn(e,r,t){r=Li(r);var n=H(e);if(!r||n>=r)return"";var s=r-n;t=t===Y?" ":t+"";var a=To(t,Wl(s/H(t)));return ut.test(t)?G(a).slice(0,s).join(""):a.slice(0,s)}function Bn(e,r,t,n){function s(){for(var r=-1,l=arguments.length,d=-1,c=n.length,u=Array(c+l),m=this&&this!==Rt&&this instanceof s?i:e;++d<c;)u[d]=n[d];for(;l--;)u[d++]=arguments[++r];return o(m,a?t:this,u)}var a=r&Z,i=Mn(e);return s}function zn(e){return function(r,t,n){return n&&"number"!=typeof n&&ls(r,t,n)&&(t=n=Y),r=Wi(r),r=r===r?r:0,t===Y?(t=r,r=0):t=Wi(t)||0,n=n===Y?r<t?1:-1:Wi(n)||0,nn(r,t,n,e)}}function Qn(e,r,t,n,s,a,i,o,l,d){var c=r&re,u=o?xn(o):Y,m=c?i:Y,p=c?Y:i,f=c?a:Y,_=c?Y:a;r|=c?ne:se,r&=~(c?se:ne),r&ee||(r&=~(Z|X));var v=[e,r,s,f,m,_,p,u,l,d],g=t.apply(Y,v);return us(e)&&bd(g,v),g.placeholder=n,g}function Hn(e){var r=bl[e];return function(e,t){if(e=Wi(e),t=Li(t)){var n=(Qi(e)+"e").split("e"),s=r(n[0]+"e"+(+n[1]+t));return n=(Qi(s)+"e").split("e"),+(n[0]+"e"+(+n[1]-t))}return r(e)}}function Gn(e,r,t,n,s,a,i,o){var l=r&X;if(!l&&"function"!=typeof e)throw new wl(he);var d=n?n.length:0;if(d||(r&=~(ne|se),n=s=Y),i=i===Y?i:Gl(Li(i),0),o=o===Y?o:Li(o),d-=s?s.length:0,r&se){var c=n,u=s;n=s=Y}var m=l?Y:vd(e),p=[e,r,t,n,s,c,u,a,i,o];if(m&&fs(p,m),e=p[0],r=p[1],t=p[2],n=p[3],s=p[4],o=p[9]=null==p[9]?l?0:e.length:Gl(p[9]-d,0),!o&&r&(re|te)&&(r&=~(re|te)),r&&r!=Z)f=r==re||r==te?Fn(e,r,o):r!=ne&&r!=(Z|ne)||s.length?Ln.apply(Y,p):Bn(e,r,t,n);else var f=Pn(e,r,t);var _=m?fd:bd;return _(f,p)}function Vn(e,r,t,n,s,a){var i=-1,o=s&de,l=s&le,d=e.length,c=r.length;if(d!=c&&!(o&&c>d))return!1;var u=a.get(e);if(u)return u==r;var m=!0;for(a.set(e,r);++i<d;){var p=e[i],f=r[i];if(n)var _=o?n(f,p,i,r,e,a):n(p,f,i,e,r,a);if(_!==Y){if(_)continue;m=!1;break}if(l){if(!b(r,function(e){return p===e||t(p,e,n,s,a)})){m=!1;break}}else if(p!==f&&!t(p,f,n,s,a)){m=!1;break}}return a.delete(e),m}function Kn(e,r,t,n,s,a){switch(t){case Be:return!(e.byteLength!=r.byteLength||!n(new Tl(e),new Tl(r)));case qe:case $e:return+e==+r;case Re:return e.name==r.name&&e.message==r.message;case Ie:return e!=+e?r!=+r:e==+r;case Fe:case Le:return e==r+"";case je:var i=B;case Ne:var o=a&de;return i||(i=Q),(o||e.size==r.size)&&n(i(e),i(r),s,a|le);case Ue:return!!Rl&&id.call(e)==id.call(r)}return!1}function Yn(e,r,t,n,s,a){var i=s&de,o=ao(e),l=o.length,d=ao(r),c=d.length;if(l!=c&&!i)return!1;for(var u=l;u--;){var m=o[u];if(!(i?m in r:qt(r,m)))return!1}var p=a.get(e);if(p)return p==r;var f=!0;a.set(e,r);for(var _=i;++u<l;){m=o[u];var v=e[m],g=r[m];if(n)var h=i?n(g,v,m,r,e,a):n(v,g,m,e,r,a);if(!(h===Y?v===g||t(v,g,n,s,a):h)){f=!1;break}_||(_="constructor"==m)}if(f&&!_){var b=e.constructor,y=r.constructor;b!=y&&"constructor"in e&&"constructor"in r&&!("function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y)&&(f=!1)}return a.delete(e),f}function Jn(e){for(var r=e.name+"",t=ld[r],n=kl.call(ld,r)?t.length:0;n--;){var s=t[n],a=s.func;if(null==a||a==e)return s.name}return r}function Zn(){var e=r.iteratee||Yo;return e=e===Yo?Lt:e,arguments.length?e(arguments[0],arguments[1]):e}function Xn(e){for(var r=_o(e),t=r.length;t--;)r[t][2]=ps(r[t][1]);return r}function es(e,r){var t=null==e?Y:e[r];return xi(t)?t:Y}function rs(e){return El.call(e)}function ts(e,r,t){for(var n=-1,s=t.length;++n<s;){var a=t[n],i=a.size;switch(a.type){case"drop":e+=i;break;case"dropRight":r-=i;break;case"take":r=Vl(r,e+i);break;case"takeRight":e=Gl(e,r-i)}}return{start:e,end:r}}function ns(e,r,t){if(null==e)return!1;var n=t(e,r);return n||ds(r)||(r=mn(r),e=vs(e,r),null!=e&&(r=Ns(r),n=t(e,r))),n||yi(e&&e.length)&&U(r,e.length)&&(ec(e)||Ti(e)||oi(e))}function ss(e){var r=e.length,t=e.constructor(r);return r&&"string"==typeof e[0]&&kl.call(e,"index")&&(t.index=e.index,t.input=e.input),t}function as(e){var r=e.constructor;return dd(hi(r)?r.prototype:Y)}function is(e,r,t){var n=e.constructor;switch(r){case Be:return hn(e);case qe:case $e:return new n(+e);case ze:case Qe:case He:case Ge:case Ve:case Ke:case Ye:case Je:case Ze:return Cn(e,t);case je:return bn(e);case Ie:case Le:return new n(e);case Fe:return yn(e);case Ne:return wn(e);case Ue:return Sn(e)}}function os(e){var r=e?e.length:Y;return yi(r)&&(ec(e)||Ti(e)||oi(e))?A(r,String):null}function ls(e,r,t){if(!wi(t))return!1;var n=typeof r;return!!("number"==n?li(t)&&U(r,t.length):"string"==n&&r in t)&&si(t[r],e)}function ds(e,r){return"number"==typeof e||!ec(e)&&(cr.test(e)||!dr.test(e)||null!=r&&e in Object(r))}function cs(e){var r=typeof e;return"number"==r||"boolean"==r||"string"==r&&"__proto__"!==e||null==e}function us(e){var t=Jn(e),n=r[t];if("function"!=typeof n||!(t in s.prototype))return!1;if(e===n)return!0;var a=vd(n);return!!a&&e===a[0]}function ms(e){var r=e&&e.constructor,t="function"==typeof r&&r.prototype||Cl;return e===t}function ps(e){return e===e&&!wi(e)}function fs(e,r){var t=e[1],n=r[1],s=t|n,a=s<(Z|X|ae),i=n==ae&&t==re||n==ae&&t==ie&&e[7].length<=r[8]||n==(ae|ie)&&r[7].length<=r[8]&&t==re;if(!a&&!i)return e;n&Z&&(e[2]=r[2],s|=t&Z?0:ee);var o=r[3];if(o){var l=e[3];e[3]=l?On(l,o,r[4]):xn(o),e[4]=l?z(e[3],Ae):xn(r[4])}return o=r[5],o&&(l=e[5],e[5]=l?kn(l,o,r[6]):xn(o),e[6]=l?z(e[5],Ae):xn(r[6])),o=r[7],o&&(e[7]=xn(o)),n&ae&&(e[8]=null==e[8]?r[8]:Vl(e[8],r[8])),null==e[9]&&(e[9]=r[9]),e[0]=r[0],e[1]=s,e}function _s(e,r,t,n,s,a){return wi(e)&&wi(r)&&(a.set(r,e),Ht(e,r,Y,_s,a)),e}function vs(e,r){return 1==r.length?e:ro(e,an(r,0,-1))}function gs(e,r){for(var t=e.length,n=Vl(r.length,t),s=xn(e);n--;){var a=r[n];e[n]=U(a,t)?s[a]:Y}return e}function hs(e){var r=[];return Qi(e).replace(ur,function(e,t,n,s){r.push(n?s.replace(gr,"$1"):t||e)}),r}function bs(e){return di(e)?e:[]}function ys(e){return"function"==typeof e?e:Ko}function ws(e){if(e instanceof s)return e.clone();var r=new n(e.__wrapped__,e.__chain__);return r.__actions__=xn(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function Ss(e,r){r=Gl(Li(r),0);var t=e?e.length:0;if(!t||r<1)return[];for(var n=0,s=-1,a=Array(Wl(t/r));n<t;)a[++s]=an(e,n,n+=r);return a}function Cs(e){for(var r=-1,t=e?e.length:0,n=-1,s=[];++r<t;){var a=e[r];a&&(s[++n]=a)}return s}function Os(e,r,t){var n=e?e.length:0;return n?(r=t||r===Y?1:Li(r),an(e,r<0?0:r,n)):[]}function ks(e,r,t){var n=e?e.length:0;return n?(r=t||r===Y?1:Li(r),r=n-r,an(e,0,r<0?0:r)):[]}function xs(e,r){return e&&e.length?_n(e,Zn(r,3),!0,!0):[]}function As(e,r){return e&&e.length?_n(e,Zn(r,3),!0):[]}function Es(e,r,t,n){var s=e?e.length:0;return s?(t&&"number"!=typeof t&&ls(e,r,t)&&(t=0,n=s),yt(e,r,t,n)):[]}function Ds(e,r){return e&&e.length?S(e,Zn(r,3)):-1}function qs(e,r){return e&&e.length?S(e,Zn(r,3),!0):-1}function $s(e,r){var t=e?e.length:0;return t?St(_(e,Zn(r,3))):[]}function Rs(e){var r=e?e.length:0;return r?St(e):[]}function Ts(e){var r=e?e.length:0;return r?St(e,!0):[]}function Ps(e){for(var r=-1,t=e?e.length:0,n={};++r<t;){var s=e[r];n[s[0]]=s[1]}return n}function js(e){return e?e[0]:Y}function Is(e,r,t){var n=e?e.length:0;return n?(t=Li(t),t<0&&(t=Gl(n+t,0)),C(e,r,t)):-1}function Ms(e){return ks(e,1)}function Fs(e,r){return e?Ql.call(e,r):""}function Ns(e){var r=e?e.length:0;return r?e[r-1]:Y}function Ls(e,r,t){var n=e?e.length:0;if(!n)return-1;var s=n;if(t!==Y&&(s=Li(t),s=(s<0?Gl(n+s,0):Vl(s,n-1))+1),r!==r)return N(e,s,!0);for(;s--;)if(e[s]===r)return s;return-1}function Us(e,r){return e&&e.length&&r&&r.length?Xt(e,r):e}function Ws(e,r,t){return e&&e.length&&r&&r.length?en(e,r,Zn(t)):e}function Bs(e,r){var t=[];if(!e||!e.length)return t;var n=-1,s=[],a=e.length;for(r=Zn(r,3);++n<a;){var i=e[n];r(i,n,e)&&(t.push(i),s.push(n))}return rn(e,s),t}function zs(e){return e?Jl.call(e):e}function Qs(e,r,t){var n=e?e.length:0;return n?(t&&"number"!=typeof t&&ls(e,r,t)?(r=0,t=n):(r=null==r?0:Li(r),t=t===Y?n:Li(t)),an(e,r,t)):[]}function Hs(e,r){return ln(e,r)}function Gs(e,r,t){return dn(e,r,Zn(t))}function Vs(e,r){var t=e?e.length:0;if(t){var n=ln(e,r);if(n<t&&si(e[n],r))return n}return-1}function Ks(e,r){return ln(e,r,!0)}function Ys(e,r,t){return dn(e,r,Zn(t),!0)}function Js(e,r){var t=e?e.length:0;if(t){var n=ln(e,r,!0)-1;if(si(e[n],r))return n}return-1}function Zs(e){return e&&e.length?cn(e):[]}function Xs(e,r){return e&&e.length?un(e,Zn(r)):[]}function ea(e){return Os(e,1)}function ra(e,r,t){return e&&e.length?(r=t||r===Y?1:Li(r),an(e,0,r<0?0:r)):[]}function ta(e,r,t){var n=e?e.length:0;return n?(r=t||r===Y?1:Li(r),r=n-r,an(e,r<0?0:r,n)):[]}function na(e,r){return e&&e.length?_n(e,Zn(r,3),!1,!0):[]}function sa(e,r){return e&&e.length?_n(e,Zn(r,3)):[]}function aa(e){return e&&e.length?pn(e):[]}function ia(e,r){return e&&e.length?pn(e,Zn(r)):[]}function oa(e,r){return e&&e.length?pn(e,Y,r):[]}function la(e){if(!e||!e.length)return[];var r=0;return e=m(e,function(e){if(di(e))return r=Gl(e.length,r),!0}),A(r,function(r){return _(e,Jt(r))})}function da(e,r){if(!e||!e.length)return[];var t=la(e);return null==r?t:_(t,function(e){return o(r,Y,e)})}function ca(e,r){for(var t=-1,n=e?e.length:0,s=r?r.length:0,a={};++t<n;)sn(a,e[t],t<s?r[t]:Y);return a}function ua(e){var t=r(e);return t.__chain__=!0,t}function ma(e,r){return r(e),e}function pa(e,r){return r(e)}function fa(){return ua(this)}function _a(){return new n(this.value(),this.__chain__)}function va(e){return this.map(e).flatten()}function ga(){this.__values__===Y&&(this.__values__=Ni(this.value()));var e=this.__index__>=this.__values__.length,r=e?Y:this.__values__[this.__index__++];return{done:e,value:r}}function ha(){return this}function ba(e){for(var r,n=this;n instanceof t;){var s=ws(n);s.__index__=0,s.__values__=Y,r?a.__wrapped__=s:r=s;var a=s;n=n.__wrapped__}return a.__wrapped__=e,r}function ya(){var e=this.__wrapped__;if(e instanceof s){var r=e;return this.__actions__.length&&(r=new s(this)),r=r.reverse(),r.__actions__.push({func:pa,args:[zs],thisArg:Y}),new n(r,this.__chain__)}return this.thru(zs)}function wa(){return vn(this.__wrapped__,this.__actions__)}function Sa(e,r,t){var n=ec(e)?u:bt;return t&&ls(e,r,t)&&(r=Y),n(e,Zn(r,3))}function Ca(e,r){var t=ec(e)?m:wt;return t(e,Zn(r,3))}function Oa(e,r){if(r=Zn(r,3),ec(e)){var t=S(e,r);return t>-1?e[t]:Y}return w(e,r,cd)}function ka(e,r){if(r=Zn(r,3),ec(e)){var t=S(e,r,!0);return t>-1?e[t]:Y}return w(e,r,ud)}function xa(e,r){return"function"==typeof r&&ec(e)?d(e,r):cd(e,ys(r))}function Aa(e,r){return"function"==typeof r&&ec(e)?c(e,r):ud(e,ys(r))}function Ea(e,r,t,n){e=li(e)?e:bo(e),t=t&&!n?Li(t):0;var s=e.length;return t<0&&(t=Gl(s+t,0)),Ti(e)?t<=s&&e.indexOf(r,t)>-1:!!s&&C(e,r,t)>-1}function Da(e,r){var t=ec(e)?_:Bt;return t(e,Zn(r,3))}function qa(e,r,t,n){return null==e?[]:(ec(r)||(r=null==r?[]:[r]),t=n?Y:t,ec(t)||(t=null==t?[]:[t]),Vt(e,r,t))}function $a(e,r,t){var n=ec(e)?g:O,s=arguments.length<3;return n(e,Zn(r,4),t,s,cd)}function Ra(e,r,t){var n=ec(e)?h:O,s=arguments.length<3;return n(e,Zn(r,4),t,s,ud)}function Ta(e,r){var t=ec(e)?m:wt;return r=Zn(r,3),t(e,function(e,t,n){return!r(e,t,n)})}function Pa(e){var r=li(e)?e:bo(e),t=r.length;return t>0?r[tn(0,t-1)]:Y}function ja(e,r){var t=-1,n=Ni(e),s=n.length,a=s-1;for(r=at(Li(r),0,s);++t<r;){var i=tn(t,a),o=n[i];n[i]=n[t],n[t]=o}return n.length=r,n}function Ia(e){return ja(e,Oe)}function Ma(e){if(null==e)return 0;if(li(e)){var r=e.length;return r&&Ti(e)?H(e):r}return ao(e).length}function Fa(e,r,t){var n=ec(e)?b:on;return t&&ls(e,r,t)&&(r=Y),n(e,Zn(r,3))}function Na(e,r){if("function"!=typeof r)throw new wl(he);return e=Li(e),function(){if(--e<1)return r.apply(this,arguments)}}function La(e,r,t){return r=t?Y:r,r=e&&null==r?e.length:r,Gn(e,ae,Y,Y,Y,Y,r)}function Ua(e,r){var t;if("function"!=typeof r)throw new wl(he);return e=Li(e),function(){return--e>0&&(t=r.apply(this,arguments)),e<=1&&(r=Y),t}}function Wa(e,r,t){r=t?Y:r;var n=Gn(e,re,Y,Y,Y,Y,Y,r);return n.placeholder=Wa.placeholder,n}function Ba(e,r,t){r=t?Y:r;var n=Gn(e,te,Y,Y,Y,Y,Y,r);return n.placeholder=Ba.placeholder,n}function za(e,r,t){function n(){f&&Pl(f),c&&Pl(c),v=0,d=c=p=f=_=Y}function s(r,t){t&&Pl(t),c=f=_=Y,r&&(v=Qd(),u=e.apply(p,d),f||c||(d=p=Y))}function a(){var e=r-(Qd()-m);e<=0||e>r?s(_,c):f=Ll(a,e)}function i(){return(f&&_||c&&b)&&(u=e.apply(p,d)),n(),u}function o(){s(b,f)}function l(){if(d=arguments,m=Qd(),p=this,_=b&&(f||!g),h===!1)var t=g&&!f;else{c||g||(v=m);var n=h-(m-v),s=n<=0||n>h;s?(c&&(c=Pl(c)),v=m,u=e.apply(p,d)):c||(c=Ll(o,n))}return s&&f?f=Pl(f):f||r===h||(f=Ll(a,r)),t&&(s=!0,u=e.apply(p,d)),!s||f||c||(d=p=Y),u}var d,c,u,m,p,f,_,v=0,g=!1,h=!1,b=!0;
if("function"!=typeof e)throw new wl(he);return r=Wi(r)||0,wi(t)&&(g=!!t.leading,h="maxWait"in t&&Gl(Wi(t.maxWait)||0,r),b="trailing"in t?!!t.trailing:b),l.cancel=n,l.flush=i,l}function Qa(e){return Gn(e,oe)}function Ha(e,r){if("function"!=typeof e||r&&"function"!=typeof r)throw new wl(he);var t=function(){var n=arguments,s=r?r.apply(this,n):n[0],a=t.cache;if(a.has(s))return a.get(s);var i=e.apply(this,n);return t.cache=a.set(s,i),i};return t.cache=new Ha.Cache,t}function Ga(e){if("function"!=typeof e)throw new wl(he);return function(){return!e.apply(this,arguments)}}function Va(e){return Ua(2,e)}function Ka(e,r){if("function"!=typeof e)throw new wl(he);return r=Gl(r===Y?e.length-1:Li(r),0),function(){for(var t=arguments,n=-1,s=Gl(t.length-r,0),a=Array(s);++n<s;)a[n]=t[r+n];switch(r){case 0:return e.call(this,a);case 1:return e.call(this,t[0],a);case 2:return e.call(this,t[0],t[1],a)}var i=Array(r+1);for(n=-1;++n<r;)i[n]=t[n];return i[r]=a,o(e,this,i)}}function Ya(e){if("function"!=typeof e)throw new wl(he);return function(r){return o(e,this,r)}}function Ja(e,r,t){var n=!0,s=!0;if("function"!=typeof e)throw new wl(he);return wi(t)&&(n="leading"in t?!!t.leading:n,s="trailing"in t?!!t.trailing:s),za(e,r,{leading:n,maxWait:r,trailing:s})}function Za(e){return La(e,1)}function Xa(e,r){return r=null==r?Ko:r,Jd(r,e)}function ei(e){return it(e)}function ri(e,r){return it(e,!1,r)}function ti(e){return it(e,!0)}function ni(e,r){return it(e,!0,r)}function si(e,r){return e===r||e!==e&&r!==r}function ai(e,r){return e>r}function ii(e,r){return e>=r}function oi(e){return di(e)&&kl.call(e,"callee")&&(!Nl.call(e,"callee")||El.call(e)==Ee)}function li(e){return null!=e&&!("function"==typeof e&&hi(e))&&yi(gd(e))}function di(e){return Si(e)&&li(e)}function ci(e){return e===!0||e===!1||Si(e)&&El.call(e)==qe}function ui(e){return Si(e)&&El.call(e)==$e}function mi(e){return!!e&&1===e.nodeType&&Si(e)&&!qi(e)}function pi(e){return!Si(e)||hi(e.splice)?!Ma(e):!ao(e).length}function fi(e,r){return Mt(e,r)}function _i(e,r,t){t="function"==typeof t?t:Y;var n=t?t(e,r):Y;return n===Y?Mt(e,r,t):!!n}function vi(e){return Si(e)&&"string"==typeof e.message&&El.call(e)==Re}function gi(e){return"number"==typeof e&&zl(e)}function hi(e){var r=wi(e)?El.call(e):"";return r==Te||r==Pe}function bi(e){return"number"==typeof e&&e==Li(e)}function yi(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=we}function wi(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function Si(e){return!!e&&"object"==typeof e}function Ci(e,r){return e===r||Nt(e,r,Xn(r))}function Oi(e,r,t){return t="function"==typeof t?t:Y,Nt(e,r,Xn(r),t)}function ki(e){return Di(e)&&e!=+e}function xi(e){return null!=e&&(hi(e)?ql.test(Ol.call(e)):Si(e)&&(L(e)?ql:Cr).test(e))}function Ai(e){return null===e}function Ei(e){return null==e}function Di(e){return"number"==typeof e||Si(e)&&El.call(e)==Ie}function qi(e){if(!Si(e)||El.call(e)!=Me||L(e))return!1;var r=Cl;if("function"==typeof e.constructor&&(r=Il(e)),null===r)return!0;var t=r.constructor;return"function"==typeof t&&t instanceof t&&Ol.call(t)==Al}function $i(e){return wi(e)&&El.call(e)==Fe}function Ri(e){return bi(e)&&e>=-we&&e<=we}function Ti(e){return"string"==typeof e||!ec(e)&&Si(e)&&El.call(e)==Le}function Pi(e){return"symbol"==typeof e||Si(e)&&El.call(e)==Ue}function ji(e){return Si(e)&&yi(e.length)&&!!gt[El.call(e)]}function Ii(e){return e===Y}function Mi(e,r){return e<r}function Fi(e,r){return e<=r}function Ni(e){if(!e)return[];if(li(e))return Ti(e)?G(e):xn(e);if(Fl&&e[Fl])return W(e[Fl]());var r=rs(e),t=r==je?B:r==Ne?Q:bo;return t(e)}function Li(e){if(!e)return 0===e?e:0;if(e=Wi(e),e===ye||e===-ye){var r=e<0?-1:1;return r*Se}var t=e%1;return e===e?t?e-t:e:0}function Ui(e){return e?at(Li(e),0,Oe):0}function Wi(e){if(wi(e)){var r=hi(e.valueOf)?e.valueOf():e;e=wi(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(fr,"");var t=Sr.test(e);return t||Or.test(e)?kt(e.slice(2),t?2:8):wr.test(e)?Ce:+e}function Bi(e){return An(e,io(e))}function zi(e){return at(Li(e),-we,we)}function Qi(e){if("string"==typeof e)return e;if(null==e)return"";if(Pi(e))return Rl?od.call(e):"";var r=e+"";return"0"==r&&1/e==-ye?"-0":r}function Hi(e,r){var t=dd(e);return r?nt(t,r):t}function Gi(e,r){return w(e,Zn(r,3),xt,!0)}function Vi(e,r){return w(e,Zn(r,3),At,!0)}function Ki(e,r){return null==e?e:md(e,ys(r),io)}function Yi(e,r){return null==e?e:pd(e,ys(r),io)}function Ji(e,r){return e&&xt(e,ys(r))}function Zi(e,r){return e&&At(e,ys(r))}function Xi(e){return null==e?[]:Et(e,ao(e))}function eo(e){return null==e?[]:Et(e,io(e))}function ro(e,r,t){var n=null==e?Y:Dt(e,r);return n===Y?t:n}function to(e,r){return ns(e,r,qt)}function no(e,r){return ns(e,r,$t)}function so(e,r,t){return g(ao(e),function(n,s){var a=e[s];return r&&!t?kl.call(n,a)?n[a].push(s):n[a]=[s]:n[a]=s,n},{})}function ao(e){var r=ms(e);if(!r&&!li(e))return Ut(e);var t=os(e),n=!!t,s=t||[],a=s.length;for(var i in e)!qt(e,i)||n&&("length"==i||U(i,a))||r&&"constructor"==i||s.push(i);return s}function io(e){for(var r=-1,t=ms(e),n=Wt(e),s=n.length,a=os(e),i=!!a,o=a||[],l=o.length;++r<s;){var d=n[r];i&&("length"==d||U(d,l))||"constructor"==d&&(t||!kl.call(e,d))||o.push(d)}return o}function oo(e,r){var t={};return r=Zn(r,3),xt(e,function(e,n,s){t[r(e,n,s)]=e}),t}function lo(e,r){var t={};return r=Zn(r,3),xt(e,function(e,n,s){t[n]=r(e,n,s)}),t}function co(e,r){return r=Zn(r,2),Yt(e,function(e,t){return!r(e,t)})}function uo(e,r){return null==e?{}:Yt(e,Zn(r,2))}function mo(e,r,t){if(ds(r,e))n=null==e?Y:e[r];else{r=mn(r);var n=ro(e,r);e=vs(e,r)}return n===Y&&(n=t),hi(n)?n.call(e):n}function po(e,r,t){return null==e?e:sn(e,r,t)}function fo(e,r,t,n){return n="function"==typeof n?n:Y,null==e?e:sn(e,r,t,n)}function _o(e){return E(e,ao(e))}function vo(e){return E(e,io(e))}function go(e,r,t){var n=ec(e)||ji(e);if(r=Zn(r,4),null==t)if(n||wi(e)){var s=e.constructor;t=n?ec(e)?new s:[]:dd(hi(s)?s.prototype:Y)}else t={};return(n?d:xt)(e,function(e,n,s){return r(t,e,n,s)}),t}function ho(e,r){return null==e||fn(e,r)}function bo(e){return e?q(e,ao(e)):[]}function yo(e){return null==e?q(e,io(e)):[]}function wo(e,r,t){return t===Y&&(t=r,r=Y),t!==Y&&(t=Wi(t),t=t===t?t:0),r!==Y&&(r=Wi(r),r=r===r?r:0),at(Wi(e),r,t)}function So(e,r,t){return r=Wi(r)||0,t===Y?(t=r,r=0):t=Wi(t)||0,e=Wi(e),Pt(e,r,t)}function Co(e,r,t){if(t&&"boolean"!=typeof t&&ls(e,r,t)&&(r=t=Y),t===Y&&("boolean"==typeof r?(t=r,r=Y):"boolean"==typeof e&&(t=e,e=Y)),e===Y&&r===Y?(e=0,r=1):(e=Wi(e)||0,r===Y?(r=e,e=0):r=Wi(r)||0),e>r){var n=e;e=r,r=n}if(t||e%1||r%1){var s=Yl();return Vl(e+s*(r-e+Ot("1e-"+((s+"").length-1))),r)}return tn(e,r)}function Oo(e){return gc(Qi(e).toLowerCase())}function ko(e){return e=Qi(e),e&&e.replace(xr,I).replace(dt,"")}function xo(e,r,t){e=Qi(e),r="string"==typeof r?r:r+"";var n=e.length;return t=t===Y?n:at(Li(t),0,n),t-=r.length,t>=0&&e.indexOf(r,t)==t}function Ao(e){return e=Qi(e),e&&ar.test(e)?e.replace(nr,M):e}function Eo(e){return e=Qi(e),e&&pr.test(e)?e.replace(mr,"\\$&"):e}function Do(e,r,t){e=Qi(e),r=Li(r);var n=H(e);if(!r||n>=r)return e;var s=(r-n)/2,a=Bl(s),i=Wl(s);return Wn("",a,t)+e+Wn("",i,t)}function qo(e,r,t){return e=Qi(e),e+Wn(e,r,t)}function $o(e,r,t){return e=Qi(e),Wn(e,r,t)+e}function Ro(e,r,t){return t||null==r?r=0:r&&(r=+r),e=Qi(e).replace(fr,""),Kl(e,r||(yr.test(e)?16:10))}function To(e,r){e=Qi(e),r=Li(r);var t="";if(!e||r<1||r>we)return t;do r%2&&(t+=e),r=Bl(r/2),e+=e;while(r);return t}function Po(){var e=arguments,r=Qi(e[0]);return e.length<3?r:r.replace(e[1],e[2])}function jo(e,r,t){return Qi(e).split(r,t)}function Io(e,r,t){return e=Qi(e),t=at(Li(t),0,e.length),e.lastIndexOf(r,t)==t}function Mo(e,t,n){var s=r.templateSettings;n&&ls(e,t,n)&&(t=Y),e=Qi(e),t=nc({},t,s,et);var a,i,o=nc({},t.imports,s.imports,et),l=ao(o),d=q(o,l),c=0,u=t.interpolate||Ar,m="__p += '",p=yl((t.escape||Ar).source+"|"+u.source+"|"+(u===lr?hr:Ar).source+"|"+(t.evaluate||Ar).source+"|$","g"),f="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++vt+"]")+"\n";e.replace(p,function(r,t,n,s,o,l){return n||(n=s),m+=e.slice(c,l).replace(Er,F),t&&(a=!0,m+="' +\n__e("+t+") +\n'"),o&&(i=!0,m+="';\n"+o+";\n__p += '"),n&&(m+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=l+r.length,r}),m+="';\n";var _=t.variable;_||(m="with (obj) {\n"+m+"\n}\n"),m=(i?m.replace(Xe,""):m).replace(er,"$1").replace(rr,"$1;"),m="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var v=wc(function(){return Function(l,f+"return "+m).apply(Y,d)});if(v.source=m,vi(v))throw v;return v}function Fo(e){return Qi(e).toLowerCase()}function No(e){return Qi(e).toUpperCase()}function Lo(e,r,t){if(e=Qi(e),!e)return e;if(t||r===Y)return e.replace(fr,"");if(r+="",!r)return e;var n=G(e),s=G(r);return n.slice($(n,s),R(n,s)+1).join("")}function Uo(e,r,t){if(e=Qi(e),!e)return e;if(t||r===Y)return e.replace(vr,"");if(r+="",!r)return e;var n=G(e);return n.slice(0,R(n,G(r))+1).join("")}function Wo(e,r,t){if(e=Qi(e),!e)return e;if(t||r===Y)return e.replace(_r,"");if(r+="",!r)return e;var n=G(e);return n.slice($(n,G(r))).join("")}function Bo(e,r){var t=ce,n=ue;if(wi(r)){var s="separator"in r?r.separator:s;t="length"in r?Li(r.length):t,n="omission"in r?Qi(r.omission):n}e=Qi(e);var a=e.length;if(ut.test(e)){var i=G(e);a=i.length}if(t>=a)return e;var o=t-H(n);if(o<1)return n;var l=i?i.slice(0,o).join(""):e.slice(0,o);if(s===Y)return l+n;if(i&&(o+=l.length-o),$i(s)){if(e.slice(o).search(s)){var d,c=l;for(s.global||(s=yl(s.source,Qi(br.exec(s))+"g")),s.lastIndex=0;d=s.exec(c);)var u=d.index;l=l.slice(0,u===Y?o:u)}}else if(e.indexOf(s,o)!=o){var m=l.lastIndexOf(s);m>-1&&(l=l.slice(0,m))}return l+n}function zo(e){return e=Qi(e),e&&sr.test(e)?e.replace(tr,V):e}function Qo(e,r,t){return e=Qi(e),r=t?Y:r,r===Y&&(r=ft.test(e)?pt:mt),e.match(r)||[]}function Ho(e){var r=e?e.length:0,t=Zn();return e=r?_(e,function(e){if("function"!=typeof e[1])throw new wl(he);return[t(e[0]),e[1]]}):[],Ka(function(t){for(var n=-1;++n<r;){var s=e[n];if(o(s[0],this,t))return o(s[1],this,t)}})}function Go(e){return ot(it(e,!0))}function Vo(e){return function(){return e}}function Ko(e){return e}function Yo(e){return Si(e)&&!ec(e)?Jo(e):Lt(e)}function Jo(e){return zt(it(e,!0))}function Zo(e,r){return Qt(e,it(r,!0))}function Xo(e,r,t){var n=ao(r),s=Et(r,n);null!=t||wi(r)&&(s.length||!n.length)||(t=r,r=e,e=this,s=Et(r,ao(r)));var a=!(wi(t)&&"chain"in t)||t.chain,i=hi(e);return d(s,function(t){var n=r[t];e[t]=n,i&&(e.prototype[t]=function(){var r=this.__chain__;if(a||r){var t=e(this.__wrapped__),s=t.__actions__=xn(this.__actions__);return s.push({func:n,args:arguments,thisArg:e}),t.__chain__=r,t}return n.apply(e,v([this.value()],arguments))})}),e}function el(){return Rt._===this&&(Rt._=Dl),this}function rl(){}function tl(e){return e=Li(e),function(){return arguments[e]}}function nl(e){return ds(e)?Jt(e):Zt(e)}function sl(e){return function(r){return null==e?Y:Dt(e,r)}}function al(e,r){if(e=Li(e),e<1||e>we)return[];var t=Oe,n=Vl(e,Oe);r=ys(r),e-=Oe;for(var s=A(n,r);++t<e;)r(t);return s}function il(e){return ec(e)?_(e,String):hs(e)}function ol(e){var r=++xl;return Qi(e)+r}function ll(e,r){var t;return e!==Y&&(t=e),r!==Y&&(t=t===Y?r:t+r),t}function dl(e){return e&&e.length?y(e,Ko,ai):Y}function cl(e,r){return e&&e.length?y(e,Zn(r),ai):Y}function ul(e){return _l(e)/(e?e.length:0)}function ml(e){return e&&e.length?y(e,Ko,Mi):Y}function pl(e,r){return e&&e.length?y(e,Zn(r),Mi):Y}function fl(e,r){var t;return e!==Y&&(t=e),r!==Y&&(t=t===Y?r:t-r),t}function _l(e){return e&&e.length?x(e,Ko):Y}function vl(e,r){return e&&e.length?x(e,Zn(r)):Y}e=e?Tt.defaults({},e,Tt.pick(Rt,_t)):Rt;var gl=e.Date,hl=e.Error,bl=e.Math,yl=e.RegExp,wl=e.TypeError,Sl=e.Array.prototype,Cl=e.Object.prototype,Ol=e.Function.prototype.toString,kl=Cl.hasOwnProperty,xl=0,Al=Ol.call(Object),El=Cl.toString,Dl=Rt._,ql=yl("^"+Ol.call(kl).replace(mr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$l=e.Reflect,Rl=e.Symbol,Tl=e.Uint8Array,Pl=e.clearTimeout,jl=$l?$l.enumerate:Y,Il=Object.getPrototypeOf,Ml=Object.getOwnPropertySymbols,Fl="symbol"==typeof(Fl=Rl&&Rl.iterator)?Fl:Y,Nl=Cl.propertyIsEnumerable,Ll=e.setTimeout,Ul=Sl.splice,Wl=bl.ceil,Bl=bl.floor,zl=e.isFinite,Ql=Sl.join,Hl=Object.keys,Gl=bl.max,Vl=bl.min,Kl=e.parseInt,Yl=bl.random,Jl=Sl.reverse,Zl=es(e,"Map"),Xl=es(e,"Set"),ed=es(e,"WeakMap"),rd=es(Object,"create"),td=ed&&new ed,nd=Zl?Ol.call(Zl):"",sd=Xl?Ol.call(Xl):"",ad=Rl?Rl.prototype:Y,id=Rl?ad.valueOf:Y,od=Rl?ad.toString:Y,ld={};r.templateSettings={escape:ir,evaluate:or,interpolate:lr,variable:"",imports:{_:r}};var dd=function(){function e(){}return function(r){if(wi(r)){e.prototype=r;var t=new e;e.prototype=Y}return t||{}}}(),cd=Rn(xt),ud=Rn(At,!0),md=Tn(),pd=Tn(!0);jl&&!Nl.call({valueOf:1},"valueOf")&&(Wt=function(e){return W(jl(e))});var fd=td?function(e,r){return td.set(e,r),e}:Ko,_d=Xl&&2===new Xl([1,2]).size?function(e){return new Xl(e)}:rl,vd=td?function(e){return td.get(e)}:rl,gd=Jt("length"),hd=Ml||function(){return[]};(Zl&&rs(new Zl)!=je||Xl&&rs(new Xl)!=Ne)&&(rs=function(e){var r=El.call(e),t=r==Me?e.constructor:null,n="function"==typeof t?Ol.call(t):"";if(n){if(n==nd)return je;if(n==sd)return Ne}return r});var bd=function(){var e=0,r=0;return function(t,n){var s=Qd(),a=pe-(s-r);if(r=s,a>0){if(++e>=me)return t}else e=0;return fd(t,n)}}(),yd=Ka(function(e,r){return ec(e)||(e=null==e?[]:[Object(e)]),r=St(r),l(e,r)}),wd=Ka(function(e,r){return di(e)?ct(e,St(r,!1,!0)):[]}),Sd=Ka(function(e,r){var t=Ns(r);return di(t)&&(t=Y),di(e)?ct(e,St(r,!1,!0),Zn(t)):[]}),Cd=Ka(function(e,r){var t=Ns(r);return di(t)&&(t=Y),di(e)?ct(e,St(r,!1,!0),Y,t):[]}),Od=Ka(function(e){var r=_(e,bs);return r.length&&r[0]===e[0]?jt(r):[]}),kd=Ka(function(e){var r=Ns(e),t=_(e,bs);return r===Ns(t)?r=Y:t.pop(),t.length&&t[0]===e[0]?jt(t,Zn(r)):[]}),xd=Ka(function(e){var r=Ns(e),t=_(e,bs);return r===Ns(t)?r=Y:t.pop(),t.length&&t[0]===e[0]?jt(t,Y,r):[]}),Ad=Ka(Us),Ed=Ka(function(e,r){r=_(St(r),String);var t=st(e,r);return rn(e,r.sort(P)),t}),Dd=Ka(function(e){return pn(St(e,!1,!0))}),qd=Ka(function(e){var r=Ns(e);return di(r)&&(r=Y),pn(St(e,!1,!0),Zn(r))}),$d=Ka(function(e){var r=Ns(e);return di(r)&&(r=Y),pn(St(e,!1,!0),Y,r)}),Rd=Ka(function(e,r){return di(e)?ct(e,r):[]}),Td=Ka(function(e){return gn(m(e,di))}),Pd=Ka(function(e){var r=Ns(e);return di(r)&&(r=Y),gn(m(e,di),Zn(r))}),jd=Ka(function(e){var r=Ns(e);return di(r)&&(r=Y),gn(m(e,di),Y,r)}),Id=Ka(la),Md=Ka(function(e){var r=e.length,t=r>1?e[r-1]:Y;return t="function"==typeof t?(e.pop(),t):Y,da(e,t)}),Fd=Ka(function(e){e=St(e);var r=e.length,t=r?e[0]:0,a=this.__wrapped__,i=function(r){return st(r,e)};return!(r>1||this.__actions__.length)&&a instanceof s&&U(t)?(a=a.slice(t,+t+(r?1:0)),a.__actions__.push({func:pa,args:[i],thisArg:Y}),new n(a,this.__chain__).thru(function(e){return r&&!e.length&&e.push(Y),e})):this.thru(i)}),Nd=qn(function(e,r,t){kl.call(e,t)?++e[t]:e[t]=1}),Ld=qn(function(e,r,t){kl.call(e,t)?e[t].push(r):e[t]=[r]}),Ud=Ka(function(e,r,t){var n=-1,s="function"==typeof r,a=ds(r),i=li(e)?Array(e.length):[];return cd(e,function(e){var l=s?r:a&&null!=e?e[r]:Y;i[++n]=l?o(l,e,t):It(e,r,t)}),i}),Wd=qn(function(e,r,t){e[t]=r}),Bd=qn(function(e,r,t){e[t?0:1].push(r)},function(){return[[],[]]}),zd=Ka(function(e,r){if(null==e)return[];var t=r.length;return t>1&&ls(e,r[0],r[1])?r=[]:t>2&&ls(r[0],r[1],r[2])&&(r.length=1),Vt(e,St(r),[])}),Qd=gl.now,Hd=Ka(function(e,r,t){var n=Z;if(t.length){var s=z(t,Hd.placeholder);n|=ne}return Gn(e,n,r,t,s)}),Gd=Ka(function(e,r,t){var n=Z|X;if(t.length){var s=z(t,Gd.placeholder);n|=ne}return Gn(r,n,e,t,s)}),Vd=Ka(function(e,r){return lt(e,1,r)}),Kd=Ka(function(e,r,t){return lt(e,Wi(r)||0,t)}),Yd=Ka(function(e,r){r=_(St(r),Zn());var t=r.length;return Ka(function(n){for(var s=-1,a=Vl(n.length,t);++s<a;)n[s]=r[s].call(this,n[s]);return o(e,this,n)})}),Jd=Ka(function(e,r){var t=z(r,Jd.placeholder);return Gn(e,ne,Y,r,t)}),Zd=Ka(function(e,r){var t=z(r,Zd.placeholder);return Gn(e,se,Y,r,t)}),Xd=Ka(function(e,r){return Gn(e,ie,Y,Y,Y,St(r))}),ec=Array.isArray,rc=$n(function(e,r){An(r,ao(r),e)}),tc=$n(function(e,r){An(r,io(r),e)}),nc=$n(function(e,r,t,n){En(r,io(r),e,n)}),sc=$n(function(e,r,t,n){En(r,ao(r),e,n)}),ac=Ka(function(e,r){return st(e,St(r))}),ic=Ka(function(e){return e.push(Y,et),o(nc,Y,e)}),oc=Ka(function(e){return e.push(Y,_s),o(cc,Y,e)}),lc=Ka(It),dc=$n(function(e,r,t){Ht(e,r,t)}),cc=$n(function(e,r,t,n){Ht(e,r,t,n)}),uc=Ka(function(e,r){return null==e?{}:(r=_(St(r),String),Kt(e,ct(io(e),r)))}),mc=Ka(function(e,r){return null==e?{}:Kt(e,St(r))}),pc=In(function(e,r,t){return r=r.toLowerCase(),e+(t?Oo(r):r)}),fc=In(function(e,r,t){return e+(t?"-":"")+r.toLowerCase()}),_c=In(function(e,r,t){return e+(t?" ":"")+r.toLowerCase()}),vc=jn("toLowerCase"),gc=jn("toUpperCase"),hc=In(function(e,r,t){return e+(t?"_":"")+r.toLowerCase()}),bc=In(function(e,r,t){return e+(t?" ":"")+Oo(r)}),yc=In(function(e,r,t){return e+(t?" ":"")+r.toUpperCase()}),wc=Ka(function(e,r){try{return o(e,Y,r)}catch(e){return vi(e)?e:new hl(e)}}),Sc=Ka(function(e,r){return d(St(r),function(r){e[r]=Hd(e[r],e)}),e}),Cc=Nn(),Oc=Nn(!0),kc=Ka(function(e,r){return function(t){return It(t,e,r)}}),xc=Ka(function(e,r){return function(t){return It(e,t,r)}}),Ac=Un(_),Ec=Un(u),Dc=Un(b),qc=zn(),$c=zn(!0),Rc=Hn("ceil"),Tc=Hn("floor"),Pc=Hn("round");return r.prototype=t.prototype,n.prototype=dd(t.prototype),n.prototype.constructor=n,s.prototype=dd(t.prototype),s.prototype.constructor=s,Dr.prototype=rd?rd(null):Cl,Pr.prototype.clear=jr,Pr.prototype.delete=Ir,Pr.prototype.get=Mr,Pr.prototype.has=Fr,Pr.prototype.set=Nr,Lr.prototype.push=Wr,Br.prototype.clear=zr,Br.prototype.delete=Qr,Br.prototype.get=Hr,Br.prototype.has=Gr,Br.prototype.set=Vr,Ha.Cache=Pr,r.after=Na,r.ary=La,r.assign=rc,r.assignIn=tc,r.assignInWith=nc,r.assignWith=sc,r.at=ac,r.before=Ua,r.bind=Hd,r.bindAll=Sc,r.bindKey=Gd,r.chain=ua,r.chunk=Ss,r.compact=Cs,r.concat=yd,r.cond=Ho,r.conforms=Go,r.constant=Vo,r.countBy=Nd,r.create=Hi,r.curry=Wa,r.curryRight=Ba,r.debounce=za,r.defaults=ic,r.defaultsDeep=oc,r.defer=Vd,r.delay=Kd,r.difference=wd,r.differenceBy=Sd,r.differenceWith=Cd,r.drop=Os,r.dropRight=ks,r.dropRightWhile=xs,r.dropWhile=As,r.fill=Es,r.filter=Ca,r.flatMap=$s,r.flatten=Rs,r.flattenDeep=Ts,r.flip=Qa,r.flow=Cc,r.flowRight=Oc,r.fromPairs=Ps,r.functions=Xi,r.functionsIn=eo,r.groupBy=Ld,r.initial=Ms,r.intersection=Od,r.intersectionBy=kd,r.intersectionWith=xd,r.invert=so,r.invokeMap=Ud,r.iteratee=Yo,r.keyBy=Wd,r.keys=ao,r.keysIn=io,r.map=Da,r.mapKeys=oo,r.mapValues=lo,r.matches=Jo,r.matchesProperty=Zo,r.memoize=Ha,r.merge=dc,r.mergeWith=cc,r.method=kc,r.methodOf=xc,r.mixin=Xo,r.negate=Ga,r.nthArg=tl,r.omit=uc,r.omitBy=co,r.once=Va,r.orderBy=qa,r.over=Ac,r.overArgs=Yd,r.overEvery=Ec,r.overSome=Dc,r.partial=Jd,r.partialRight=Zd,r.partition=Bd,r.pick=mc,r.pickBy=uo,r.property=nl,r.propertyOf=sl,r.pull=Ad,r.pullAll=Us,r.pullAllBy=Ws,r.pullAt=Ed,r.range=qc,r.rangeRight=$c,r.rearg=Xd,r.reject=Ta,r.remove=Bs,r.rest=Ka,r.reverse=zs,r.sampleSize=ja,r.set=po,r.setWith=fo,r.shuffle=Ia,r.slice=Qs,r.sortBy=zd,r.sortedUniq=Zs,r.sortedUniqBy=Xs,r.split=jo,r.spread=Ya,r.tail=ea,r.take=ra,r.takeRight=ta,r.takeRightWhile=na,r.takeWhile=sa,r.tap=ma,r.throttle=Ja,r.thru=pa,r.toArray=Ni,r.toPairs=_o,r.toPairsIn=vo,r.toPath=il,r.toPlainObject=Bi,r.transform=go,r.unary=Za,r.union=Dd,r.unionBy=qd,r.unionWith=$d,r.uniq=aa,r.uniqBy=ia,r.uniqWith=oa,r.unset=ho,r.unzip=la,r.unzipWith=da,r.values=bo,r.valuesIn=yo,r.without=Rd,r.words=Qo,r.wrap=Xa,r.xor=Td,r.xorBy=Pd,r.xorWith=jd,r.zip=Id,r.zipObject=ca,r.zipWith=Md,r.extend=tc,r.extendWith=nc,Xo(r,r),r.add=ll,r.attempt=wc,r.camelCase=pc,r.capitalize=Oo,r.ceil=Rc,r.clamp=wo,r.clone=ei,r.cloneDeep=ti,r.cloneDeepWith=ni,r.cloneWith=ri,r.deburr=ko,r.endsWith=xo,r.eq=si,r.escape=Ao,r.escapeRegExp=Eo,r.every=Sa,r.find=Oa,r.findIndex=Ds,r.findKey=Gi,r.findLast=ka,r.findLastIndex=qs,r.findLastKey=Vi,r.floor=Tc,r.forEach=xa,r.forEachRight=Aa,r.forIn=Ki,r.forInRight=Yi,r.forOwn=Ji,r.forOwnRight=Zi,r.get=ro,r.gt=ai,r.gte=ii,r.has=to,r.hasIn=no,r.head=js,r.identity=Ko,r.includes=Ea,r.indexOf=Is,r.inRange=So,r.invoke=lc,r.isArguments=oi,r.isArray=ec,r.isArrayLike=li,r.isArrayLikeObject=di,r.isBoolean=ci,r.isDate=ui,r.isElement=mi,r.isEmpty=pi,r.isEqual=fi,r.isEqualWith=_i,r.isError=vi,r.isFinite=gi,r.isFunction=hi,r.isInteger=bi,r.isLength=yi,r.isMatch=Ci,r.isMatchWith=Oi,r.isNaN=ki,r.isNative=xi,r.isNil=Ei,r.isNull=Ai,r.isNumber=Di,r.isObject=wi,r.isObjectLike=Si,r.isPlainObject=qi,r.isRegExp=$i,r.isSafeInteger=Ri,r.isString=Ti,r.isSymbol=Pi,r.isTypedArray=ji,r.isUndefined=Ii,r.join=Fs,r.kebabCase=fc,r.last=Ns,r.lastIndexOf=Ls,r.lowerCase=_c,r.lowerFirst=vc,r.lt=Mi,r.lte=Fi,r.max=dl,r.maxBy=cl,r.mean=ul,r.min=ml,r.minBy=pl,r.noConflict=el,r.noop=rl,r.now=Qd,r.pad=Do,r.padEnd=qo,r.padStart=$o,r.parseInt=Ro,r.random=Co,r.reduce=$a,r.reduceRight=Ra,r.repeat=To,r.replace=Po,r.result=mo,r.round=Pc,r.runInContext=K,r.sample=Pa,r.size=Ma,r.snakeCase=hc,r.some=Fa,r.sortedIndex=Hs,r.sortedIndexBy=Gs,r.sortedIndexOf=Vs,r.sortedLastIndex=Ks,r.sortedLastIndexBy=Ys,r.sortedLastIndexOf=Js,r.startCase=bc,r.startsWith=Io,r.subtract=fl,r.sum=_l,r.sumBy=vl,r.template=Mo,r.times=al,r.toInteger=Li,r.toLength=Ui,r.toLower=Fo,r.toNumber=Wi,r.toSafeInteger=zi,r.toString=Qi,r.toUpper=No,r.trim=Lo,r.trimEnd=Uo,r.trimStart=Wo,r.truncate=Bo,r.unescape=zo,r.uniqueId=ol,r.upperCase=yc,r.upperFirst=gc,r.each=xa,r.eachRight=Aa,r.first=js,Xo(r,function(){var e={};return xt(r,function(t,n){kl.call(r.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),r.VERSION=J,d(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){r[e].placeholder=r}),d(["drop","take"],function(e,r){s.prototype[e]=function(t){var n=this.__filtered__;if(n&&!r)return new s(this);t=t===Y?1:Gl(Li(t),0);var a=this.clone();return n?a.__takeCount__=Vl(t,a.__takeCount__):a.__views__.push({size:Vl(t,Oe),type:e+(a.__dir__<0?"Right":"")}),a},s.prototype[e+"Right"]=function(r){return this.reverse()[e](r).reverse()}}),d(["filter","map","takeWhile"],function(e,r){var t=r+1,n=t==_e||t==ge;s.prototype[e]=function(e){var r=this.clone();return r.__iteratees__.push({iteratee:Zn(e,3),type:t}),r.__filtered__=r.__filtered__||n,r}}),d(["head","last"],function(e,r){var t="take"+(r?"Right":"");s.prototype[e]=function(){return this[t](1).value()[0]}}),d(["initial","tail"],function(e,r){var t="drop"+(r?"":"Right");s.prototype[e]=function(){return this.__filtered__?new s(this):this[t](1)}}),s.prototype.compact=function(){return this.filter(Ko)},s.prototype.find=function(e){return this.filter(e).head()},s.prototype.findLast=function(e){return this.reverse().find(e)},s.prototype.invokeMap=Ka(function(e,r){return"function"==typeof e?new s(this):this.map(function(t){return It(t,e,r)})}),s.prototype.reject=function(e){return e=Zn(e,3),this.filter(function(r){return!e(r)})},s.prototype.slice=function(e,r){e=Li(e);var t=this;return t.__filtered__&&(e>0||r<0)?new s(t):(e<0?t=t.takeRight(-e):e&&(t=t.drop(e)),r!==Y&&(r=Li(r),t=r<0?t.dropRight(-r):t.take(r-e)),t)},s.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},s.prototype.toArray=function(){return this.take(Oe)},xt(s.prototype,function(e,t){var a=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=r[i?"take"+("last"==t?"Right":""):t],l=i||/^find/.test(t);o&&(r.prototype[t]=function(){var t=this.__wrapped__,d=i?[1]:arguments,c=t instanceof s,u=d[0],m=c||ec(t),p=function(e){var t=o.apply(r,v([e],d));return i&&f?t[0]:t};m&&a&&"function"==typeof u&&1!=u.length&&(c=m=!1);var f=this.__chain__,_=!!this.__actions__.length,g=l&&!f,h=c&&!_;if(!l&&m){t=h?t:new s(this);var b=e.apply(t,d);return b.__actions__.push({func:pa,args:[p],thisArg:Y}),new n(b,f)}return g&&h?e.apply(this,d):(b=this.thru(p),g?i?b.value()[0]:b.value():b)})}),d(["pop","push","shift","sort","splice","unshift"],function(e){var t=Sl[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",s=/^(?:pop|shift)$/.test(e);r.prototype[e]=function(){var e=arguments;return s&&!this.__chain__?t.apply(this.value(),e):this[n](function(r){return t.apply(r,e)})}}),xt(s.prototype,function(e,t){var n=r[t];if(n){var s=n.name+"",a=ld[s]||(ld[s]=[]);a.push({name:t,func:n})}}),ld[Ln(Y,X).name]=[{name:"wrapper",func:Y}],s.prototype.clone=T,s.prototype.reverse=We,s.prototype.value=kr,r.prototype.at=Fd,r.prototype.chain=fa,r.prototype.commit=_a,r.prototype.flatMap=va,r.prototype.next=ga,r.prototype.plant=ba,r.prototype.reverse=ya,r.prototype.toJSON=r.prototype.valueOf=r.prototype.value=wa,Fl&&(r.prototype[Fl]=ha),r}var Y,J="4.0.1",Z=1,X=2,ee=4,re=8,te=16,ne=32,se=64,ae=128,ie=256,oe=512,le=1,de=2,ce=30,ue="...",me=150,pe=16,fe=200,_e=1,ve=2,ge=3,he="Expected a function",be="__lodash_hash_undefined__",ye=1/0,we=9007199254740991,Se=1.7976931348623157e308,Ce=NaN,Oe=4294967295,ke=Oe-1,xe=Oe>>>1,Ae="__lodash_placeholder__",Ee="[object Arguments]",De="[object Array]",qe="[object Boolean]",$e="[object Date]",Re="[object Error]",Te="[object Function]",Pe="[object GeneratorFunction]",je="[object Map]",Ie="[object Number]",Me="[object Object]",Fe="[object RegExp]",Ne="[object Set]",Le="[object String]",Ue="[object Symbol]",We="[object WeakMap]",Be="[object ArrayBuffer]",ze="[object Float32Array]",Qe="[object Float64Array]",He="[object Int8Array]",Ge="[object Int16Array]",Ve="[object Int32Array]",Ke="[object Uint8Array]",Ye="[object Uint8ClampedArray]",Je="[object Uint16Array]",Ze="[object Uint32Array]",Xe=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,rr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,tr=/&(?:amp|lt|gt|quot|#39|#96);/g,nr=/[&<>"'`]/g,sr=RegExp(tr.source),ar=RegExp(nr.source),ir=/<%-([\s\S]+?)%>/g,or=/<%([\s\S]+?)%>/g,lr=/<%=([\s\S]+?)%>/g,dr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cr=/^\w*$/,ur=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,mr=/[\\^$.*+?()[\]{}|]/g,pr=RegExp(mr.source),fr=/^\s+|\s+$/g,_r=/^\s+/,vr=/\s+$/,gr=/\\(\\)?/g,hr=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,br=/\w*$/,yr=/^0x/i,wr=/^[-+]0x[0-9a-f]+$/i,Sr=/^0b[01]+$/i,Cr=/^\[object .+?Constructor\]$/,Or=/^0o[0-7]+$/i,kr=/^(?:0|[1-9]\d*)$/,xr=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Ar=/($^)/,Er=/['\n\r\u2028\u2029\\]/g,Dr="\\ud800-\\udfff",qr="\\u0300-\\u036f\\ufe20-\\ufe23",$r="\\u20d0-\\u20f0",Rr="\\u2700-\\u27bf",Tr="a-z\\xdf-\\xf6\\xf8-\\xff",Pr="\\xac\\xb1\\xd7\\xf7",jr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ir="\\u2018\\u2019\\u201c\\u201d",Mr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fr="A-Z\\xc0-\\xd6\\xd8-\\xde",Nr="\\ufe0e\\ufe0f",Lr=Pr+jr+Ir+Mr,Ur="["+Dr+"]",Wr="["+Lr+"]",Br="["+qr+$r+"]",zr="\\d+",Qr="["+Rr+"]",Hr="["+Tr+"]",Gr="[^"+Dr+Lr+zr+Rr+Tr+Fr+"]",Vr="\\ud83c[\\udffb-\\udfff]",Kr="(?:"+Br+"|"+Vr+")",Yr="[^"+Dr+"]",Jr="(?:\\ud83c[\\udde6-\\uddff]){2}",Zr="[\\ud800-\\udbff][\\udc00-\\udfff]",Xr="["+Fr+"]",et="\\u200d",rt="(?:"+Hr+"|"+Gr+")",tt="(?:"+Xr+"|"+Gr+")",nt=Kr+"?",st="["+Nr+"]?",at="(?:"+et+"(?:"+[Yr,Jr,Zr].join("|")+")"+st+nt+")*",it=st+nt+at,ot="(?:"+[Qr,Jr,Zr].join("|")+")"+it,lt="(?:"+[Yr+Br+"?",Br,Jr,Zr,Ur].join("|")+")",dt=RegExp(Br,"g"),ct=RegExp(Vr+"(?="+Vr+")|"+lt+it,"g"),ut=RegExp("["+et+Dr+qr+$r+Nr+"]"),mt=/[a-zA-Z0-9]+/g,pt=RegExp([Xr+"?"+Hr+"+(?="+[Wr,Xr,"$"].join("|")+")",tt+"+(?="+[Wr,Xr+rt,"$"].join("|")+")",Xr+"?"+rt+"+",Xr+"+",zr,ot].join("|"),"g"),ft=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_t=["Array","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],vt=-1,gt={};gt[ze]=gt[Qe]=gt[He]=gt[Ge]=gt[Ve]=gt[Ke]=gt[Ye]=gt[Je]=gt[Ze]=!0,gt[Ee]=gt[De]=gt[Be]=gt[qe]=gt[$e]=gt[Re]=gt[Te]=gt[je]=gt[Ie]=gt[Me]=gt[Fe]=gt[Ne]=gt[Le]=gt[We]=!1;var ht={};ht[Ee]=ht[De]=ht[Be]=ht[qe]=ht[$e]=ht[ze]=ht[Qe]=ht[He]=ht[Ge]=ht[Ve]=ht[je]=ht[Ie]=ht[Me]=ht[Fe]=ht[Ne]=ht[Le]=ht[Ue]=ht[Ke]=ht[Ye]=ht[Je]=ht[Ze]=!0,ht[Re]=ht[Te]=ht[We]=!1;var bt={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},yt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},wt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},St={function:!0,object:!0},Ct={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ot=parseFloat,kt=parseInt,xt=St[typeof r]&&r&&!r.nodeType?r:null,At=St[typeof e]&&e&&!e.nodeType?e:null,Et=T(xt&&At&&"object"==typeof s&&s),Dt=T(St[typeof self]&&self),qt=T(St[typeof window]&&window),$t=(At&&At.exports===xt?xt:null,T(St[typeof this]&&this)),Rt=Et||qt!==($t&&$t.window)&&qt||Dt||$t||Function("return this")(),Tt=K();(qt||Dt||{})._=Tt,n=function(){return Tt}.call(r,t,r,e),!(n!==Y&&(e.exports=n))}).call(this)}).call(r,t(70)(e),function(){return this}())},function(e,r){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,r,t,n){var s=[],a=!0,i=!1,o=void 0;try{for(var l,d=function(){var e=l.value;switch(e.type_code){case"ADD_EXTRAS":var a=!0,i=!1,o=void 0;try{for(var d,c=(0,p.default)(e.items);!(a=(d=c.next()).done);a=!0){var u=d.value,m=f(u.id,n);if(null!==m&&"options"===m.type){var _=m.item.retail_price;t&&(m.item.retail_price=0,m.item.special_name=t.name);var v={type_code:e.type_code,item:m.item,item_original_retail_price:_,original_item:n.order.items[m.department.id]};s.push(v),n.order.items[m.department.id]=m.item}}}catch(e){i=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw o}}break;case"MAKE_SELECTION":var g=e.selection.item,h=f(g.id,n);null!==h&&(s.push({type_code:e.type_code,department:h.department,original_item:n.order.items[h.department.id]}),n.order.items[h.department.id]=h.item,h.department.changed=!0);break;case"PRICE_MULTIPLY":var b=n.priceMultiplyItems(e.item,e.items);r.price_multiply=b.totalQuantity,n.internal.price_multiplies.push(r),s.push({type_code:e.type_code,item:r,rule:e});break;case"MARK_PLAN":if(e.file_upload){var y="rule"+e.id;n.internal.file_uploads[y]={name:e.file_upload.name,percentage:0},n.uploader.upload({url:"/api/orders/rule-plan-upload",data:{order_id:n.order.id,sku_id:r.id,notes:e.file_upload_notes},file:e.file_upload}).then(function(r){delete n.internal.file_uploads[y],s.push({type_code:e.type_code,rule_plan_id:r.data.rule_plan_id})},function(e){console.log("Error status: "+e.status)},function(e){var r=parseInt(100*e.loaded/e.total);n.internal.file_uploads[y].percentage=r})}break;case"FORCE_SELECTION":var w=!0,S=!1,C=void 0;try{for(var O,k=(0,p.default)(e.items);!(w=(O=k.next()).done);w=!0){var x=O.value,A=f(x.id,n);s.push({type_code:e.type_code,department:A.department,original_item:n.order.items[A.department.id]}),null!==A&&(n.order.items[A.department.id]=A.item,A.department.changed=!0)}}catch(e){S=!0,C=e}finally{try{!w&&k.return&&k.return()}finally{if(S)throw C}}break;case"FORCE_UNSELECTION":var E=!0,D=!1,q=void 0;try{for(var $,R=(0,p.default)(e.items);!(E=($=R.next()).done);E=!0){var T=$.value,P=f(T.id,n);null!==P&&(s.push({type_code:e.type_code,department:P.department,original_item:n.order.items[P.department.id]}),delete n.order.items[P.department.id],P.department.changed=!0);
}}catch(e){D=!0,q=e}finally{try{!E&&R.return&&R.return()}finally{if(D)throw q}}}e.applied=!0},c=(0,p.default)(e);!(a=(l=c.next()).done);a=!0)d()}catch(e){i=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw o}}return r&&(r.undo_rules=s),s}function a(e,r){if(void 0!==e){var t=!0,n=!1,s=void 0;try{for(var a,i=function(){var e=a.value;switch(e.type_code){case"ADD_EXTRAS":r.order.items[e.item.sku_category]=e.original_item,e.item.retail_price=e.item_original_retail_price,e.item.special_name=void 0;break;case"PRICE_MULTIPLY":delete e.item.price_multiply,r.internal.price_multiplies=r.internal.price_multiplies.filter(function(r){return r.id!==e.item.id});break;case"MARK_PLAN":r.post("rule-plan-remove",{rule_plan_id:e.rule_plan_id});break;case"MAKE_SELECTION":case"FORCE_SELECTION":case"FORCE_UNSELECTION":r.order.items[e.department.id]=e.original_item}},o=(0,p.default)(e);!(t=(a=o.next()).done);t=!0)i()}catch(e){n=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw s}}}}function i(e,r,t){var n=[],s=[],a=0,i=0,o=!0,l=!1,d=void 0;try{for(var c,u=(0,p.default)(r);!(o=(c=u.next()).done);o=!0){var m=c.value,_=f(m.id,t);null!==_&&(t.order.items[found_item.department.id].id===m.id||"options"===_.type&&t.order.items[found_item.department.id])?(n.push(m),i+=m.quantity||1,a+=m.quantity*e.retail_price):s.push(m)}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}return{applicableItems:n,otherItems:s,totalPrice:a,totalQuantity:i}}function o(e){if(e.internal){var r=!0,t=!1,n=void 0;try{for(var s,a=(0,p.default)(e.internal.price_multiplies);!(r=(s=a.next()).done);r=!0){var o=s.value,l=0,d=!0,c=!1,u=void 0;try{for(var m,f=(0,p.default)(o.undo_rules.filter(function(e){return"PRICE_MULTIPLY"===e.type_code}));!(d=(m=f.next()).done);d=!0){var _=m.value,v=i(_.rule.item,_.rule.items,e);l+=v.totalQuantity}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}o.price_multiply=l}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}}function l(e,r){var t=!0,n=!0,s=!1,a=void 0;try{for(var i,o=(0,p.default)(e);!(n=(i=o.next()).done);n=!0){var l=i.value,d=f(l.id,r);if(null===d||!(r.order.items[found_item.department.id].id===l.id||"options"===d.type&&r.order.items[found_item.department.id])){t=!1;break}}}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}return t}function d(e){if(e.hasAppliedShowSpecial()){var r=e.order.show_special;r.undo_rules=s(r.rules,null,null,r,e)}}function c(e){if(e.hasAppliedShowSpecial()){var r=e.order.show_special,t=0,n=!0,s=!1,a=void 0;try{for(var i,o=(0,p.default)(r.rules);!(n=(i=o.next()).done);n=!0){var d=i.value;"PRICE_ADJUSTMENT"===d.type_code&&(d.applied=l(d.items,e),d.applied&&(t+=parseFloat(d.price_adjustment||0)))}}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}r.value=t}}function u(e){o(e)}Object.defineProperty(r,"__esModule",{value:!0});var m=t(1),p=n(m);r.applyRules=s,r.unapplyRules=a,r.priceMultiplyItems=i,r.updatePriceMultiplies=o,r.applyShowSpecialRules=d,r.updateShowSpecialValue=c,r.updateRules=u;var f=function(e,r){var t=!0,n=!1,s=void 0;try{for(var a,i=(0,p.default)(r.info.items);!(t=(a=i.next()).done);t=!0){var o=a.value,l=!0,d=!1,c=void 0;try{for(var u,m=(0,p.default)(o.departments);!(l=(u=m.next()).done);l=!0)for(var f=u.value,_=["selections","upgrades","options"],v=0;v<_.length;v++){var g=_[v],h=!0,b=!1,y=void 0;try{for(var w,S=(0,p.default)(f[g]);!(h=(w=S.next()).done);h=!0){var C=w.value;if(C.id==e)return{category:o,department:f,item:C,type:g}}}catch(e){b=!0,y=e}finally{try{!h&&S.return&&S.return()}finally{if(b)throw y}}}}catch(e){d=!0,c=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw c}}}}catch(e){n=!0,s=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw s}}return null}},,,,,,,,function(e,r,t){var n=t(21),s=t(7)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||a[s]===e)}},function(e,r,t){var n=t(12);e.exports=function(e,r,t,s){try{return s?r(n(t)[0],t[1]):r(t)}catch(r){var a=e.return;throw void 0!==a&&n(a.call(e)),r}}},,function(e,r,t){var n=t(7)("iterator"),s=!1;try{var a=[7][n]();a.return=function(){s=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,r){if(!r&&!s)return!1;var t=!1;try{var a=[7],i=a[n]();i.next=function(){return{done:t=!0}},a[n]=function(){return i},e(a)}catch(e){}return t}},,,,function(e,r){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,r,t){var n=t(12),s=t(16),a=t(51);e.exports=function(e,r){if(n(e),s(r)&&r.constructor===e)return r;var t=a.f(e),i=t.resolve;return i(r),t.promise}},,function(e,r,t){var n=t(12),s=t(36),a=t(7)("species");e.exports=function(e,r){var t,i=n(e).constructor;return void 0===i||void 0==(t=n(i)[a])?r:s(t)}},function(e,r,t){var n,s,a,i=t(27),o=t(207),l=t(76),d=t(49),c=t(6),u=c.process,m=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,_=c.Dispatch,v=0,g={},h="onreadystatechange",b=function(){var e=+this;if(g.hasOwnProperty(e)){var r=g[e];delete g[e],r()}},y=function(e){b.call(e.data)};m&&p||(m=function(e){for(var r=[],t=1;arguments.length>t;)r.push(arguments[t++]);return g[++v]=function(){o("function"==typeof e?e:Function(e),r)},n(v),v},p=function(e){delete g[e]},"process"==t(26)(u)?n=function(e){u.nextTick(i(b,e,1))}:_&&_.now?n=function(e){_.now(i(b,e,1))}:f?(s=new f,a=s.port2,s.port1.onmessage=y,n=i(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(e){c.postMessage(e+"","*")},c.addEventListener("message",y,!1)):n=h in d("script")?function(e){l.appendChild(d("script"))[h]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(i(b,e,1),0)}),e.exports={set:m,clear:p}},,function(e,r){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(1),i=s(a),o=t(71),l=n(o);r.default=function(e){e.controller("OrderCaravanController",["$http","$log","$q","$scope","$state","$sce","ApiService","AppSettings","OrderService","TestSettings","Upload",function(e,r,t,n,s,a,o,d,c,u,m){n.tabData=[{heading:"Model & Series",route:"order.caravan.modelseries"},{heading:"Weight & Size",route:"order.caravan.weightsize"},{heading:"Features",route:"order.caravan.features"}],n.internal={price_multiplies:[],file_uploads:{}},n.special_features_expanded=!1,n.options_upgrades_expanded=!1,n.uploader=m,n.priceMultiplyItems=function(e,r){return l.priceMultiplyItems(e,r,n)};var p=function(e){var r=!0,t=!1,s=void 0;try{for(var a,o=(0,i.default)(e.options);!(r=(a=o.next()).done);r=!0){var l=a.value,d=n.order.items[e.id];d&&(d.available=!0),l.available=!d||d.id==l.id}}catch(e){t=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw s}}};n.onOpenOptions=function(e){n.optionsByDepartment=n.getDepartmentsWithAvailableOptions(e);var r=!0,t=!1,s=void 0;try{for(var a,o=(0,i.default)(n.optionsByDepartment);!(r=(a=o.next()).done);r=!0){var l=a.value;p(l)}}catch(e){t=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw s}}$("#options.modal").modal({backdrop:"static"})},n.onOpenTotals=function(){var e=n.calculatePrice().detail;n.totals=e,$("#totals.modal").modal({backdrop:"static"})},n.onOpenSpecials=function(){$("#specials.modal").modal({backdrop:"static"})},n.onPrintPdfClick=function(e){var r=$(e.target).closest("a").attr("href");u.DISABLE_PDF&&(r+=r.indexOf("?")!==-1?"&":"?",r+="is_html=1");var t=u.DISABLE_PDF?"_self":"_blank";e.preventDefault(),n.checkAndConfirmSave().then(function(){window.open(r,t)})},n.onOpenSeriesPhotos=function(){n.view_photos=n.info.series_detail.photos,$("#photos.modal").modal({backdrop:"static"})},n.onOpenSeriesPlans=function(){n.view_photos=n.info.series_detail.plans,$("#photos.modal").modal({backdrop:"static"})},n.onItemSelect=function(e,r){var t=!n.order.items[e.id]||n.order.items[e.id].id!=r.id,s=function(){n.order.items[e.id]=r,e.changed=e.changed||t,l.updateRules(n)};n.post("item-rules",{sku_id:r.id,series_id:n.order.series}).then(function(t){var a=t.data.rules;n.info.rules=a,a.length?(n.cancelRules=function(){},n.acceptRules=function(t){if(t&&t.$valid){var i=n.order.items[e.id];i&&l.unapplyRules(i.undo_rules,n),l.applyRules(a,r,null,n),s(),$("#rules.modal").modal("hide")}},$("#rules.modal").modal({})):s()})},n.onItemPhotoClick=function(e){if("undefined"==typeof e.available){var r=f(e.sku_category);p(r)}e.available!==!1&&(n.view_photos=[{url:e.photo}],n.view_header=e.public_description,$("#photos.modal").modal({backdrop:"static"}))},n.isUpgrade=function(e,r){return"undefined"!=typeof r&&e.upgrades.filter(function(e){return e.id==r.id}).length};var f=function(e){var r=!0,t=!1,s=void 0;try{for(var a,o=(0,i.default)(n.info.items);!(r=(a=o.next()).done);r=!0){var l=a.value,d=!0,c=!1,u=void 0;try{for(var m,p=(0,i.default)(l.departments);!(d=(m=p.next()).done);d=!0){var f=m.value;if(f.id==e)return f}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}}}catch(e){t=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(t)throw s}}};n.onOptionSelect=function(e){var r=f(e.sku_category);"undefined"==typeof e.available&&p(r),!e.special_name&&e.available&&(n.order.items[r.id]?delete n.order.items[r.id]:n.order.items[r.id]=e,r.changed=!0,p(r),l.updateRules(n))},n.getDepartmentsMissingSelection=function(e){var r=[],t=!0,s=!1,a=void 0;try{for(var o,l=(0,i.default)(e.departments);!(t=(o=l.next()).done);t=!0){var d=o.value;(d.selections.length>0||d.upgrades.length>0)&&!n.order.items[d.id]&&r.push(d)}}catch(e){s=!0,a=e}finally{try{!t&&l.return&&l.return()}finally{if(s)throw a}}return r},n.hasSpecialFeatureForDepartment=function(e,r){return!1}}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(192),i=s(a),o=t(187),l=s(o),d=t(19),c=s(d),u=t(1),m=s(u),p=t(71),f=n(p);r.default=function(e){t(128)(e),t(123)(e),t(129)(e),t(127)(e),t(126)(e),e.controller("OrderController",["$anchorScroll","$filter","$http","$interval","$location","$log","$q","$rootScope","$sce","$scope","$state","$timeout","$window","ApiService","AppSettings","OrderApiService","OrderService",function(e,r,n,s,a,o,d,u,p,_,v,g,h,b,y,w,S){t(92),_.tabData=[{heading:"Customer Details",route:"order.customer"},{heading:"Caravan Details",route:"order.caravan"},{heading:"Status / Documents / History",route:"order.status"},{heading:"Special Features",route:"order.special_features"}],_.choices={departments:[],dealerships:[],models:[],states:[],series:{},delivery_min_date:new Date},_.info={series_detail:{},show_price:!0,rules:{item_description:"",item_rules:[]}},_.chassis_lookup={loading:!1,no_results:!1},_.loading={items:!1,extras:!1,order:!1},_.GST_PERCENT=.1,_.cango=!0,_.stock=0,_.order=S,_.messages=p.trustAsHtml(t(290)),_.editCurrentCustomer=!1,u.$on("$stateChangeStart",function(){u.message=null}),_.post=function(e,r){return b.post("orders/"+e,r)};var C=function(){if(_.order.delivery_date){var e=!0,r=!1,t=void 0;try{for(var n,s=(0,m.default)(_.choices.available_delivery_months);!(e=(n=s.next()).done);e=!0){var a=n.value,i=a.value;if(_.order.delivery_date.getTime()==i.getTime()){_.order.delivery_date=i;break}}}catch(e){r=!0,t=e}finally{try{!e&&s.return&&s.return()}finally{if(r)throw t}}}},O=function(){var e={},r={},t=!0,n=!1,s=void 0;try{for(var a,i=(0,m.default)(_.choices.categories);!(t=(a=i.next()).done);t=!0){var o=a.value;e[o.id]=o;var l=!0,d=!1,c=void 0;try{for(var u,p=(0,m.default)(o.departments);!(l=(u=p.next()).done);l=!0){var f=u.value;r[f.id]={department:f,parent:o}}}catch(e){d=!0,c=e}finally{try{!l&&p.return&&p.return()}finally{if(d)throw c}}}}catch(e){n=!0,s=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw s}}var v=!0,g=!1,h=void 0;try{for(var b,y=(0,m.default)(_.order.special_features);!(v=(b=y.next()).done);v=!0){var w=b.value;if(w.sku_category){var S=e[w.sku_category];S&&(w.selectedCategory=S);var C=r[w.sku_category];C&&(w.selectedDepartment=C.department,w.selectedCategory=C.parent),_.onSpecialFeatureCategorySelect(w),_.onSpecialFeatureDepartmentSelect(w)}}}catch(e){g=!0,h=e}finally{try{!v&&y.return&&y.return()}finally{if(g)throw h}}},k=function(){C(),O()};_.post("initial-data",{order_id:_.order.id,dealership_id:_.order.dealership,customer_id:v.params.customerId}).then(function(e){_.choices.dealerships=e.data.dealerships,_.choices.categories=e.data.categories,_.choices.models=e.data.models,_.choices.states=e.data.states,_.choices.acquisition_source=e.data.acquisition_source,_.choices.source_of_awareness=e.data.source_of_awareness,_.choices.shows=e.data.shows,_.permissions=e.data.permissions,_.choices.available_delivery_months=[];var t=e.data.available_delivery_months;_.permissions.manual_override&&(t=e.data.all_delivery_months);var n=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(t);!(n=(i=o.next()).done);n=!0){var l=i.value,d=new Date(Date.parse(l)),c=e.data.available_delivery_months.indexOf(l)!=-1;_.choices.available_delivery_months.push({title:r("date")(d,y.FORMAT_DATE_MONTH_SHORT_JS)+(c?"":" *"),value:d})}}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}k(),0==_.permissions.create_order&&0==_.permissions.view_order&&(h.location.href="/orders/list"),1==_.choices.dealerships.length&&(_.order.dealership=_.choices.dealerships[0].id),e.data.customer_info&&_.select_customer(e.data.customer_info),_.$watch("order.special_features",function(e,r){angular.equals(e,r)||(_.order.special_features_changed=!0)},!0)}),_.lookupChassis=function(e){return _.chassis_lookup.loading=!0,_.chassis_lookup.no_results=!1,_.post("chassis-lookup",{chassis_string:e}).then(function(e){return e.data.list.length?e.data.list:void(_.chassis_lookup.no_results=!0)})},_.onChassisSelect=function(){_.post("from-chassis",{order_id:_.data.from_chassis}).then(function(e){_.order.series=e.data.data.series,_.order.model=e.data.data.model,_.onModelSelect(),_.onSeriesSelect()})};var x="This will reset the details of the order. Are you sure you want to continue?";_.isModelEditable=function(){return["ORDER_FINALIZED","ORDER"].indexOf(_.order.order_stage_details.code)==-1&&_.order.isEditable()},_.onModelChange=function(){!_.order.model||confirm(x)?(_.order.model=_.order.modelSelection,_.order.series=null,_.order.resetOrderItems(),_.onModelSelect()):_.order.modelSelection=_.order.model},_.onModelSelect=function(){return _.order.model?void _.post("model-series",{model_id:_.order.model,dealership_id:_.order.dealership}).then(function(e){_.choices.series=e.data.series,_.info.model_detail=e.data.model_detail}):void(_.choices.series=[])},_.onSeriesChange=function(){!_.order.series||confirm(x)?(_.order.series=_.order.seriesSelection,_.order.resetOrderItems(),_.onSeriesSelect()):_.order.seriesSelection=_.order.series},_.onSeriesSelect=function(){_.order.series&&_.post("series-detail",{series_id:_.order.series,order_id:_.order.id}).then(function(e){_.info.series_detail=e.data,_.specials=_.info.series_detail.show_specials,_.loadFeatures()})},_.orderLookupData=function(){return{dealership:_.order.dealership}},_.onOrderLookupSelect=function(e){_.orderLookupResultId=e.id},_.assignSelectedOrderAndProceed=function(){_.order.loadOrderDetails(_.orderLookupResultId,!1).then(function(){S.saveOrder().then(function(){_.onModelSelect(),_.onSeriesSelect(),_.loadFeatures(),v.go("order.caravan.weightsize")})})},_.current_dealership=function(){var e=_.choices.dealerships.filter(function(e){return e.id==_.order.dealership});return e.length?e[0]:null},_.createMessage=function(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;("undefined"==typeof t?"undefined":(0,c.default)(t))==(0,c.default)("")&&(t=[t]),u.message={type:r,message_list:t},e("message-anchor"),null!==n&&s(function(){u.message=null},n,1)};var A=function(){var e=v.href("order.customer",{orderId:_.order.id}).split("/").slice(1).join("/");a.path(e)};_.proceedDealerOrder=function(e){var r=e&&e.$valid;r&&(_.order.order_type="Stock",_.order.order_stage_details&&"ORDER_FINALIZED"==_.order.order_stage_details.code&&(_.order.update_customer_only=!0),S.saveOrder().then(function(){A(),g(function(){v.go("order.caravan.modelseries",{orderId:_.order.id})})}))},_.proceedCustomerOrder=function(e){var r=e&&e.$valid;if(_.cango=r,r){if(_.order.id&&"Stock"==_.order.order_type)return _.order.is_order_converted=!0,_.stock=1,void(_.order.order_type="Customer");if("Customer"==_.order.order_type&&1==_.order.is_order_converted){if(null==_.order.order_converted&&(alert("Please Enter Sales Date ! "),_.cango=!1),null!=_.order.order_converted){var t=_.order.order_converted,n=t.split("/"),s=new Date(n[1]+"/"+n[0]+"/"+n[2]),a=new Date;if(s>a)return alert(" Sales Date cannot Be greater than today ! "),void(_.cango=!1)}if(0==_.cango)return void(_.stock=1);1==_.cango&&(_.stock=0)}_.cango===!0&&(_.order.order_stage_details&&"ORDER_FINALIZED"==_.order.order_stage_details.code&&(_.order.update_customer_only=!0),_.order.order_type="Customer",S.saveOrder().then(function(){0==_.stock&&(delete _.order.update_customer_only,A(),v.go("order.caravan.modelseries",{orderId:_.order.id})),1==_.stock&&alert("Stock  Customer order converted 1")}))}},_.newOrderForCustomer=function(){S.saveNewOrderForCustomer().then(function(){A(),g(function(){v.go("order.caravan.modelseries",{orderId:_.order.id})})})},_.proceed=function(e){switch(v.current.name){case"order.customer":e&&e.$valid&&v.go("order.caravan.modelseries");break;case"order.caravan.modelseries":_.order.model&&_.order.series&&S.saveOrder().then(function(){v.go("order.caravan.weightsize"),_.loadFeatures()});break;case"order.caravan.weightsize":e&&e.$valid&&S.saveOrder().then(function(){v.go("order.caravan.features")})}},_.toggleWeightDisclaimer=function(){_.order.weight_estimate_disclaimer_time=new Date},_.removeFeatureDocument=function(e){delete e.new_document,delete e.document},_.hasAppliedShowSpecial=function(){return _.order.show_special&&_.order.show_special.applied};var E=function(e){var r=[],t=!0,n=!1,s=void 0;try{for(var a,i=(0,m.default)(e.departments);!(t=(a=i.next()).done);t=!0){var o=a.value;o.selections.length&&r.push(o)}}catch(e){n=!0,s=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw s}}return r};_.getDepartmentsWithAvailableOptions=function(e){var r=E(e);return e.departments.filter(function(e){return r.indexOf(e)==-1&&e.options.length})},_.getAvailableOptions=function(e){var r=[],t=E(e),n=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(e.departments);!(n=(i=o.next()).done);n=!0){var l=i.value;t.indexOf(l)==-1&&(r=r.concat(l.options))}}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}return r},_.hasCategoryOptions=function(e){return _.getAvailableOptions(e).length},_.getSelectedOptions=function(e){var r=[],t=!0,n=!1,s=void 0;try{for(var a,i=(0,m.default)(_.getDepartmentsWithAvailableOptions(e));!(t=(a=i.next()).done);t=!0){var o=a.value;_.order.items[o.id]&&r.push(_.order.items[o.id])}}catch(e){n=!0,s=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw s}}return r},_.isItemSelected=function(e,r){return _.order.items[r.id]&&_.order.items[r.id].id==e.id},_.calculatePrice=function(){if(void 0===_.info.items||void 0===_.info.series_detail.retail_price)return 0;var e={manufacture:{caravan:parseFloat(_.info.series_detail.cost_price||0),upgrades:0,options:0,special_features:0,adjustments:_.order.price_adjustments.cost||0},wholesale:{caravan:parseFloat(_.info.series_detail.wholesale_price||0),upgrades:0,options:0,special_features:0,adjustments:(_.order.price_adjustments.wholesale||0)+(_.order.after_sales.wholesale||0)},retail:{caravan:parseFloat(_.info.series_detail.retail_price||0),upgrades:0,options:0,special_features:0,adjustments:(_.order.price_adjustments.retail||0)+(_.order.after_sales.retail||0)},options_upgrades:[],special_features:[]},r=!0,t=!1,n=void 0;try{for(var s,a=(0,m.default)(_.info.items);!(r=(s=a.next()).done);r=!0){var i=s.value,o=!0,l=!1,d=void 0;try{for(var c,u=(0,m.default)(i.departments);!(o=(c=u.next()).done);o=!0){var p=c.value;if(_.order.items[p.id]){var f=_.order.items[p.id],v=f.price_multiply||1,g=parseFloat(f.cost_price||0)*v,h=parseFloat(f.wholesale_price||0)*v,b=parseFloat(f.retail_price||0)*v;1==f.availability_type||5==f.availability_type||2==f.availability_type&&(e.manufacture.upgrades+=g,e.wholesale.upgrades+=h,e.retail.upgrades+=b,e.options_upgrades.push({name:f.name,manufacture:g,wholesale:h,retail:b}))}}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}var y=_.getSelectedOptions(i);if(y.length){var w=!0,S=!1,C=void 0;try{for(var O,k=(0,m.default)(y);!(w=(O=k.next()).done);w=!0){var x=O.value,A=x.price_multiply||1,E=parseFloat(x.cost_price||0)*A,D=parseFloat(x.wholesale_price||0)*A,q=parseFloat(x.retail_price||0)*A;e.options_upgrades.push({name:x.name,manufacture:E,wholesale:D,retail:q}),e.manufacture.options+=E,e.wholesale.options+=D,e.retail.options+=q}}catch(e){S=!0,C=e}finally{try{!w&&k.return&&k.return()}finally{if(S)throw C}}}}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}var $=!0,R=!1,T=void 0;try{for(var P,j=(0,m.default)(_.order.special_features);!($=(P=j.next()).done);$=!0){var I=P.value,M=parseFloat(I.retail_price||0),F=parseFloat(I.wholesale_price||0);e.retail.special_features+=M,e.wholesale.special_features+=F,e.special_features.push({name:I.customer_description,manufacture:0,wholesale:F,retail:M})}}catch(e){R=!0,T=e}finally{try{!$&&j.return&&j.return()}finally{if(R)throw T}}var N=function(e){return e.caravan+e.upgrades+e.options+e.special_features+e.adjustments};e.retail.total=N(e.retail),e.wholesale.total=N(e.wholesale),e.manufacture.total=N(e.manufacture);var L=0;_.hasAppliedShowSpecial()&&(L=parseFloat(_.order.show_special.price)||0,e.retail.total+=L);var U=function(e){return e.total-e.adjustments};return e.retail.totalNoAdjustment=U(e.retail),e.wholesale.totalNoAdjustment=U(e.wholesale),e.manufacture.totalNoAdjustment=U(e.manufacture),{detail:e,price:e.retail.total}},_.select_customer=function(e){_.order.customer=e,_.editCurrentCustomer=!1},_.select_physical_suburb=function(e){_.order.customer.physical_address.suburb=e},_.select_delivery_suburb=function(e){_.order.customer.delivery_address.suburb=e},_.select_invoice_suburb=function(e){_.order.customer.postal_address.suburb=e};var D=function(){var e=!0,r=!1,t=void 0;try{for(var n,s=(0,m.default)(_.info.items);!(e=(n=s.next()).done);e=!0){var a=n.value,i=!0,o=!1,l=void 0;try{for(var d,c=(0,m.default)(a.departments);!(i=(d=c.next()).done);i=!0){var u=d.value;u.changed=!1}}catch(e){o=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw l}}}}catch(e){r=!0,t=e}finally{try{!e&&s.return&&s.return()}finally{if(r)throw t}}_.order.special_features_changed=!1,_.order.price_changed=!1},q="Order details will be saved before continuing.";_.checkAndConfirmSave=function(){return new l.default(function(e,r){var t=function(){confirm(q)?_.saveOrder().then(e,r):r()};if(_.order.special_features_changed||_.order.price_changed)return void t();var n=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(_.info.items);!(n=(i=o.next()).done);n=!0){var l=i.value,d=!0,c=!1,u=void 0;try{for(var p,f=(0,m.default)(l.departments);!(d=(p=f.next()).done);d=!0){var v=p.value;if(v.changed)return void t()}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}}}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}e()})},_.saveOrder=function(){return"ORDER_FINALIZED"==_.order.order_stage_details.code&&"order.customer"===v.current.name&&(_.order.update_customer_only=!0),_.loading.order=!0,S.saveOrder().then(function(){_.order.update_customer_only?(delete _.order.update_customer_only,_.createMessage("alert-warning","Customer details saved.")):_.createMessage("alert-info","Details Saved."),k(),setTimeout(D,1)}).finally(function(){_.loading.order=!1})},_.requestOrderApproval=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,S.requestOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.rejectOrderApproval=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,S.rejectOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.placeOrder=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,S.placeOrder().then(function(){v.go("order.status",{},{reload:!0}),_.order.last_server_error_message&&_.createMessage("alert-danger",_.order.last_server_error_message)}).finally(function(){_.loading.order=!1})},function(){})},_.confirmCancelOrder=function(){_.cancelReason="",$("#cancel_order.modal").modal({backdrop:"static"})},_.confirmPlaceOrder=function(){$("#place_order.modal").modal({backdrop:"static"})},_.cancelOrder=function(){S.cancelOrder(_.cancelReason).then(function(){v.go("order.status",{},{reload:!0})})},_.finalizeOrder=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,S.finalizeOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.canOrderBeSaved=function(){return _.order.isEditable()||_.permissions&&(_.permissions.modify_special_features||_.permissions.approve_special_features)},_.canOrderApprovalBeRejected=function(){return!!_.order.order_stage_details&&("ORDER_REQUESTED"==_.order.order_stage_details.code&&_.order.permissions.approve_order)},_.canOrderBeCancelled=function(){return!!_.order.order_stage_details&&(_.order.permissions.cancel_order&&("ORDER"==_.order.order_stage_details.code||"ORDER_FINALIZED"==_.order.order_stage_details.code))},_.canOrderApprovalBeRequested=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections)&&(("QUOTE"==_.order.order_stage_details.code||"QUOTE_SELECTIONS"==_.order.order_stage_details.code||"ORDER_REJECTED"==_.order.order_stage_details.code)&&_.order.permissions.request_order_approval)},_.canOrderBePlaced=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections)&&("ORDER_REQUESTED"==_.order.order_stage_details.code&&_.order.permissions.approve_order)},_.canOrderBeFinalized=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections||_.order.special_features.length&&!_.order.special_features_approved)&&("ORDER"==_.order.order_stage_details.code&&(_.order.permissions.finalize_order||_.order.permissions.lock_order))},_.canOrderPricesBeSaved=function(){return!!_.order.order_stage_details&&("ORDER_FINALIZED"==_.order.order_stage_details.code&&_.order.permissions.modify_retail_prices_finalized)},_.canCreateOrderForSameCustomer=function(){return _.order.id&&_.permissions&&_.permissions.create_order&&_.order.customer},_.updateSalesforce=function(){_.post("update-salesforce",{order_id:_.order.id}).then(function(){S.retrieveOrder(_.order.id)})},_.applyShowSpecial=function(e){_.order.show_special&&_.order.show_special.applied&&_.unapplyShowSpecial(_.order.show_special),_.order.show_special=e,e.applied=!0,f.applyShowSpecialRules(_),f.updateRules(_)},_.unapplyShowSpecial=function(e){f.unapplyRules(e.undo_rules,_),e.applied=!1,_.order.show_special=null},_.loadFeatures=function(){_.loading.items||(_.loading.items=!0,w.getFeatures(_.order.series,_.order.id).then(function(e){if(_.info.items=e.categories,R(),_.order.show_special_id){var r=!0,t=!1,n=void 0;try{for(var s,a=(0,m.default)(_.specials);!(r=(s=a.next()).done);r=!0){var i=s.value;if(i.id==_.order.show_special_id){_.order.show_special=i;break}}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}_.applyShowSpecial(_.order.show_special)}}).finally(function(){_.loading.items=!1}))};var R=function(){var e=_.order;if("ORDER_FINALIZED"!=e.order_stage_details.code){var r=!0,t=!1,n=void 0;try{for(var s,a=(0,m.default)(_.info.items);!(r=(s=a.next()).done);r=!0){var i=s.value,o=!0,l=!1,d=void 0;try{for(var c,u=(0,m.default)(i.departments);!(o=(c=u.next()).done);o=!0){var p=c.value,f=e.items[p.id];if(f&&T(f,p))P(f,p)||(p.changed=!0);else if(1==p.selections.length){var v=p.selections[0];f&&f.id==v.id&&f.availability_type==v.availability_type||(p.changed=!0),e.items[p.id]=v}else f&&(p.changed=!0),delete e.items[p.id]}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}},T=function(e,r){for(var t=["selections","upgrades","options"],n=0;n<t.length;n++){var s=t[n],a=!0,i=!1,o=void 0;try{for(var l,d=(0,m.default)(r[s]);!(a=(l=d.next()).done);a=!0){var c=l.value;if(c.id==e.id)return!0}}catch(e){i=!0,o=e}finally{try{!a&&d.return&&d.return()}finally{if(i)throw o}}}return!1},P=function(e,r){for(var t=["selections","upgrades","options"],n=0;n<t.length;n++){var s=t[n],a=!0,i=!1,o=void 0;try{for(var l,d=(0,m.default)(r[s]);!(a=(l=d.next()).done);a=!0){var c=l.value;if(c.id==e.id)return c.availability_type==e.availability_type}}catch(e){i=!0,o=e}finally{try{!a&&d.return&&d.return()}finally{if(i)throw o}}}return!1};_.order.validModel()&&_.onModelSelect(),_.order.validSeries()&&_.onSeriesSelect(),_.onOpenTradeInComment=function(){$("#trade_in_comment.modal").modal({backdrop:"static"})},_.onOpenConditions=function(){$("#order_conditions.modal").modal({backdrop:"static"})},_.onOpenAfterMarketNote=function(){$("#after_market_note.modal").modal({backdrop:"static"})},_.isCustomerEditable=function(){return _.order.id&&!_.order.isStockOrder()||!(_.order.customer&&_.order.customer.id)||_.editCurrentCustomer},_.clearCustomer=function(){_.order.resetCustomer(),_.search={}},_.editCustomerFields=function(){_.editCurrentCustomer=!0},_.onSpecialFeatureCategorySelect=function(e){e.departmentList=_.generateDepartmentsForCategory(e.selectedCategory),e.sku_category=e.selectedCategory?e.selectedCategory.id:null},_.onSpecialFeatureDepartmentSelect=function(e){e.selectedDepartment?e.sku_category=e.selectedDepartment.id:e.sku_category=e.selectedCategory.id},_.generateDepartmentsForCategory=function(e){var r=[];if(!e)return r;var t=!0,n=!1,s=void 0;try{for(var a,o=(0,m.default)(e.departments);!(t=(a=o.next()).done);t=!0){var l=a.value,d=_.order.items[l.id];d&&r.push({id:l.id,title:d.public_description})}}catch(e){n=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw s}}var c=e.departments.filter(function(e){return 0==r.filter(function(r){return r.id==e.id}).length});return[].concat(r,[{id:null,title:"--------------------------------------------------"}],(0,i.default)(c))},_.addSpecialFeature=function(){var e={};_.onFeatureDetailChange(e),_.order.special_features.push(e)},_.removeSpecialFeature=function(e){_.order.special_features.splice(e,1)},_.onFeatureDetailChange=function(e){e.approved=null},_.onPrintAutocad=function(){_.checkAndConfirmSave().then(function(){window.open("/orders/autocad/"+_.order.id+"/","_blank")})}}])},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){e.directive("datetimepickerNeutralTimezone",function(){return{restrict:"A",priority:1,require:"ngModel",link:function(e,r,t,n){n.$formatters.push(function(e){if(e){var r=new Date(Date.parse(e));return r=new Date(r.getTime()+6e4*r.getTimezoneOffset())}}),n.$parsers.push(function(e){if(e){var r=new Date(e.getTime()-6e4*e.getTimezoneOffset());return r}return null})}}}),e.directive("statusRow",["AppSettings",function(e){return{restrict:"E",transclude:!0,template:t(300),scope:{stage:"=",title:"@",permission:"="},link:function(r){r.AppSettings=e,r.statusClass=function(e){
if(e)switch(e.status){case"Complete":return"complete";case"Optional":return"optional";case"Requires Action":return"requires-action";case"Rejected":return"rejected"}}}}}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=t(2),a=n(s),i=t(3),o=n(i);r.default=function(e){e.factory("OrderApiService",["ApiService",function(e){var r=function(){function r(){(0,a.default)(this,r)}return(0,o.default)(r,[{key:"getFeatures",value:function(r,t){return e.getData("orders/series-items",{series_id:r,order_id:t})}}]),r}();return new r}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=t(64),a=n(s),i=t(272),o=n(i),l=t(2),d=n(l),c=t(3),u=n(c);r.default=function(e){e.factory("OrderService",["ApiService","AppSettings","Upload","$q",function(e,r,t,n){var s=function(){function s(){(0,d.default)(this,s),this.resetOrder()}return(0,u.default)(s,[{key:"resetOrder",value:function(){this.resetOrderExceptCustomer(),this.resetCustomer(),this.resetPermissions()}},{key:"resetOrderExceptCustomer",value:function(){this.resetOrderMainData(),this.resetOrderItems()}},{key:"resetOrderMainData",value:function(){this.id=null,this.model=null,this.series=null,this.custom_series_name=null,this.custom_series_code=null,this.series_description=null,this.series_code=null,this.production_month=null,this.production_start_date=null,this.modelSelection=null,this.seriesSelection=null,this.chassis=null,this.order_type=null,this.delivery_date=null,this.dealership=null,this.dealer_sales_rep_name=null,this.customer_manager_name=null,this.order_stage_details=null,this.dealership_name=null,this.original={},this.show_id=null,this.is_expired=!1,this.base_order=null,this.customer_plans_approved=!1,this.is_order_converted=!1,this.order_converted=null,this.salesforce_sync_error=null}},{key:"resetOrderItems",value:function(){this.weight_estimate_disclaimer=!1,this.custom_tare_weight=null,this.custom_ball_weight=null,this.show_special_id=null,this.price_adjustments={cost:0,wholesale:0,wholesale_comment:0,retail:0},this.after_sales={wholesale:0,retail:0,description:""},this.dealer_load=0,this.trade_in_write_back=0,this.trade_in_comment=null,this.price_comment=null,this.show_special=null,this.orderconditions={},this.aftermarketnote={},this.has_missing_selections=!0,this.items={},this.special_features=[],this.special_features_approved=!1,this.special_features_changed=!1,this.price_changed=!1}},{key:"resetCustomer",value:function(){this.customer={physical_address:{},delivery_address:{},postal_address:{}}}},{key:"resetPermissions",value:function(){this.permissions=null}},{key:"isStageQuote",value:function(){return void 0===this.order_stage_details||null===this.order_stage_details||this.order_stage_details.number<=r.STAGE_QUOTE_SELECTIONS}},{key:"isStageQuoteEditable",value:function(){return null==this.permissions||this.isStageQuote()&&this.permissions.modify_order}},{key:"isCustomerVisible",value:function(){return null==this.id||this.permissions.list_customer}},{key:"isStageOrder",value:function(){return!this.isStageQuote()}},{key:"isStockOrder",value:function(){return"Stock"==this.order_type}},{key:"isEditable",value:function(){return!(this.order_stage_details&&!this.isStockOrder())||(!("QUOTE"!=this.order_stage_details.code&&"QUOTE_SELECTIONS"!=this.order_stage_details.code&&"ORDER_REJECTED"!=this.order_stage_details.code||!this.permissions.modify_order)||(!("ORDER_REQUESTED"!=this.order_stage_details.code&&"ORDER"!=this.order_stage_details.code||!this.permissions.modify_order_requested)||!("ORDER_FINALIZED"!=this.order_stage_details.code||!this.permissions.modify_order_finalized)))}},{key:"validCustomer",value:function(){return null!==this.type}},{key:"validModel",value:function(){return(0,o.default)(this.model)}},{key:"validSeries",value:function(){return(0,o.default)(this.series)}},{key:"validModelSeries",value:function(){return this.validModel()&&this.validSeries()}},{key:"validWeightSize",value:function(){var e=this.weight_estimate_disclaimer===!0;return e}},{key:"updateAddress",value:function(e,r){e.name=(0,a.default)(r,"name"),e.street=(0,a.default)(r,"address"),e.suburb=(0,a.default)(r,"suburb.name"),e.post_code=(0,a.default)(r,"suburb.post_code.number"),e.state=(0,a.default)(r,"suburb.post_code.state.id")}},{key:"updateOrder",value:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model=e.model,this.series=e.series,this.custom_series_name=e.custom_series_name,this.custom_series_code=e.custom_series_code,this.series_description=e.series_description,this.series_code=e.series_code,this.production_month=e.production_month,this.production_start_date=e.production_start_date,this.modelSelection=e.model,this.seriesSelection=e.series,this.chassis=e.chassis,this.order_stage_details=e.order_stage_details,this.permissions=e.permissions,this.weight_estimate_disclaimer=e.weight_estimate_disclaimer_checked,this.custom_tare_weight=e.custom_tare_weight_kg,this.custom_ball_weight=e.custom_ball_weight_kg,this.price_adjustments.cost=parseFloat(e.price_adjustment_cost),this.price_adjustments.wholesale=parseFloat(e.price_adjustment_wholesale),this.price_adjustments.wholesale_comment=e.price_adjustment_wholesale_comment,this.price_adjustments.retail=parseFloat(e.price_adjustment_retail),this.dealer_load=parseFloat(e.dealer_load),this.trade_in_write_back=parseFloat(e.trade_in_write_back),this.trade_in_comment=e.trade_in_comment,this.after_sales.wholesale=parseFloat(e.after_sales_wholesale),this.after_sales.retail=parseFloat(e.after_sales_retail),this.after_sales.description=e.after_sales_description,this.price_comment=e.price_comment,this.orderconditions=e.orderconditions,this.aftermarketnote=e.aftermarketnote,this.is_expired=e.is_expired,this.base_order=e.id,this.has_missing_selections=e.has_missing_selections,this.items=e.items,this.price_changed=!1,this.customer_plans_approved=e.customer_plans_approved,this.special_features_approved=e.special_features_approved,this.salesforce_sync_error=e.salesforce_sync_error,r&&(this.id=e.id,this.customer=e.customer,this.show_id=e.show,this.show_special_id=e.show_special_id,this.delivery_date=e.delivery_date?new Date(Date.parse(e.delivery_date)):"",this.special_features=e.special_features,this.special_features_changed=!1,this.is_order_converted=e.is_order_converted,this.order_converted=e.order_converted,this.last_server_error_message=e.last_server_error_message,this.order_type=e.order_type,this.dealership=e.dealership,this.dealer_sales_rep_name=e.dealer_sales_rep_name,this.customer_manager_name=e.customer_manager_name,this.dealership_name=e.dealership_name)}},{key:"loadOrderDetails",value:function(r){var t=this;return e.post("orders/retrieve-order",{order_id:r}).then(function(e){t.updateOrder(e.data,!1)})}},{key:"retrieveOrder",value:function(r){var t=this,s=function(e){t.updateOrder(e.data)},a=function(e){return console.log("There was an error retrieving this order"),n.reject(e)};return e.post("orders/retrieve-order",{order_id:r}).then(s,a)}},{key:"saveOrder",value:function(){var e=this,r=function(r){return e.updateOrder(r.data),n.resolve(r)},s=function(e){return console.log("There was an error saving this order"),n.reject(e)},a={},i=1;return this.special_features.forEach(function(e){e.new_document&&(e.file_id=i++,a[e.file_id]=e.new_document)}),t.upload({method:"POST",url:"/api/orders/save-order",data:{order:this},file:a}).then(r,s)}},{key:"saveNewOrderForCustomer",value:function(){var e=this.dealership;return this.resetOrderExceptCustomer(),this.dealership=e,this.order_type="Customer",this.saveOrder()}},{key:"requestOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},s=function(e){return n.reject(e)};return e.post("orders/request-order",{order:this}).then(t,s)}},{key:"rejectOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},s=function(e){return n.reject(e)};return e.post("orders/reject-order",{order:this}).then(t,s)}},{key:"placeOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},s=function(e){return n.reject(e)};return e.post("orders/place-order",{order:this}).then(t,s)}},{key:"cancelOrder",value:function(r){var t=this,s=function(e){t.updateOrder(e.data)},a=function(e){return n.reject(e)};return e.post("orders/cancel-order",{order:this,cancel_reason:r}).then(s,a)}},{key:"finalizeOrder",value:function(){var r=this,t=function(e){r.updateOrder(e.data)},s=function(e){return n.reject(e)};return e.post("orders/finalize-order",{order:this}).then(t,s)}}]),s}();return new s}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=t(1),a=n(s);r.default=function(e){e.controller("ShowroomController",["$filter","$scope","$state","$timeout","ApiService","AppSettings","OrderService",function(e,r,n,s,i,o,l){t(92),r.order=l,window.location.href.indexOf("showroom")>-1&&$("#lnk_help").attr("href","/help/showroom"),r.post=function(e,r){return i.post("orders/"+e,r)},"showroom"===n.current.name&&n.go("showroom.splash"),r.createQuote=function(){n.go("showroom.customer")},r.current={model:null,series:null,slider:0},r.choices={models:[],series:[],states:[],referrals:[],dealerships:[]},r.info={model_detail:null,series_detail:null},r.modal={photo:null,plan_view:!1},r.errors={series_select:null},r.editCurrentCustomer=!1,r.post("showroom-data").then(function(t){r.choices.model_series=t.data.models,r.choices.states=t.data.states,r.choices.acquisition_source=t.data.acquisition_source,r.choices.source_of_awareness=t.data.source_of_awareness,r.choices.shows=t.data.shows,r.choices.dealerships=t.data.dealerships,r.choices.available_delivery_months=[];var n=!0,s=!1,i=void 0;try{for(var l,d=(0,a.default)(t.data.available_delivery_months);!(n=(l=d.next()).done);n=!0){var c=l.value,u=new Date(Date.parse(c));r.choices.available_delivery_months.push({title:e("date")(u,o.FORMAT_DATE_MONTH_SHORT_JS),value:u}),r.order.delivery_date&&r.order.delivery_date.getTime()==u.getTime()&&(r.order.delivery_date=u)}}catch(e){s=!0,i=e}finally{try{!n&&d.return&&d.return()}finally{if(s)throw i}}1==r.choices.dealerships.length&&(r.order.dealership=r.choices.dealerships[0].id)}),r.customerProceed=function(e){e&&e.$valid&&(r.order.order_type="Customer",r.choices.series=[],n.go("showroom.model"))},r.onModelClick=function(e){r.current.model=e,r.order.model=e.id,n.go("showroom.series")},r.selectSeries=function(e){r.current.series=e,r.order.series=e.id},r.onViewSeriesPhotoClick=function(e){r.selectSeries(e),n.go("showroom.seriesphotos")},r.onStartQuoteClick=function(e){r.selectSeries(e),r.onSeriesSelect()},r.onSeriesSelect=function(){r.errors.series_select=null;var e=function(e){s(function(){n.go("order.caravan.features",{orderId:e.data.id})})},t=function(e){400==e.status?r.errors.series_select=e.data:r.errors.series_select="An unexpected error has occurred"};l.saveOrder().then(e,t)},r.select_physical_suburb=function(e){r.order.customer.physical_address.suburb=e},r.select_customer=function(e){r.order.customer=e},r.clearCustomer=function(){r.order.resetCustomer(),r.search={}},r.editCustomerFields=function(){r.editCurrentCustomer=!0},r.hasModelAvailableSeries=function(e){var t=e.series.filter(r.isSeriesAvailableForDealership);return t.length},r.isSeriesAvailableForDealership=function(e){return e.dealerships.indexOf(r.order.dealership)!=-1}}])},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=t(190),a=n(s),i=t(35),o=n(i),l=t(1),d=n(l);r.default=function(e){t(125)(e),e.controller("OrderStatusController",["$scope","$state","ApiService","Upload",function(e,r,t,n){e.history={},e.new_customer_manager_id=null,e.new_sales_rep_id=null,e.loading=!1;var s=function(r,t){e.status[r]&&e.status[r][t]&&e.status[r][t].data&&(e.status[r][t].data=new Date(e.status[r][t].data))},i=function(){e.post("status",{order_id:e.order.id}).then(function(r){e.status=r.data,s("delivery","delivery_date_set"),s("delivery","warranty_date"),s("delivery","pickup_date"),e.status.approval.deposit_paid.data=parseFloat(e.status.approval.deposit_paid.data),e.loading=!1}),e.post("status-history",{order_id:e.order.id}).then(function(r){e.status_history=r.data.history})};i(),e.sectionComplete=function(e){if(e){var r=!0,t=!1,n=void 0;try{for(var s,a=(0,d.default)((0,o.default)(e));!(r=(s=a.next()).done);r=!0){var i=s.value;if("Complete"!==e[i].status&&"Optional"!==e[i].status)return!1}}catch(e){t=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}return!0}};var l=function(r){if(!e.loading)return e.loading=!0,r.order_id=e.order.id,t.post("orders/status-update",r).finally(function(){i()})},c=function(e,r,t){if(e.$valid){var n={};n[r]=t,l(n)}},u=function(r){if(!e.loading)return e.loading=!0,r.order_id=e.order.id,t.post("orders/status-delete",r).finally(function(){i()})},m=function(e,r,t){if(e.$valid){var n={};n[r]=t,u(n)}};e.updateDeposit=function(e,r){c(e,"deposit",r)},e.updateChassis=function(){l({chassis_number:!0})},e.enableChassisEdition=function(){e.editingChassis=!0},e.setChassis=function(){l({chassis_number:e.status.approval.chassis_appointed.data}).then(function(){e.editingChassis=!1})},e.deleteActualProdDate=function(e,r){m(e,"del_actual_production_date",r)},e.deleteChassisSection=function(e,r){m(e,"del_chassis_section",r)},e.deleteBuildingSection=function(e,r){m(e,"del_building",r)},e.deletePrewireSection=function(e,r){m(e,"del_prewire_section",r)},e.deleteAluminiumSection=function(e,r){m(e,"del_aluminium",r)},e.deleteFinishing=function(e,r){m(e,"del_finishing",r)},e.deleteActualQC=function(e,r){m(e,"del_qc_date_actual",r)},e.deleteFinalQC=function(e,r){m(e,"del_final_qc_date",r)},e.deleteActualDispatchDate=function(e,r){m(e,"del_dispatch_date_actual",r)},e.updateActualProductionDate=function(e,r){c(e,"actual_production_date",r)},e.updateActualProductionComments=function(e,r){c(e,"actual_production_comments",r)},e.updateChassisSectionDate=function(e,r){c(e,"chassis_section",r)},e.updateChassisSectionComments=function(e,r){c(e,"chassis_section_comments",r)},e.updateBuildingDate=function(e,r){c(e,"building",r)},e.updateBuildingComments=function(e,r){c(e,"building_comments",r)},e.updatePrewireDate=function(e,r){c(e,"prewire_section",r)},e.updatePrewireComments=function(e,r){c(e,"prewire_comments",r)},e.updateAluminiumDate=function(e,r){c(e,"aluminium",r)},e.updateAluminiumComments=function(e,r){c(e,"aluminium_comments",r)},e.updateFinishingDate=function(e,r){c(e,"finishing",r)},e.updateFinishingComments=function(e,r){c(e,"finishing_comments",r)},e.updatePlannedQcDate=function(e,r){c(e,"qc_date_planned",r)},e.updateActualQcDate=function(e,r){c(e,"qc_date_actual",r)},e.updateQCComments=function(e,r){c(e,"qc_comments",r)},e.updatePlannedWatertestDate=function(e,r){c(e,"planned_watertest_date",r)},e.updateActualWatertestDate=function(e,r){c(e,"actual_watertest_date",r)},e.updateWatertestComments=function(e,r){c(e,"watertest_comments",r)},e.updateFinalQcDate=function(e,r){c(e,"final_qc_date",r)},e.updateFinalQcComments=function(e,r){c(e,"final_qc_comments",r)},e.updateVinNumber=function(e,r){c(e,"vin_number",r)},e.updatePlannedDispatchDate=function(e,r){c(e,"dispatch_date_planned",r)},e.updateActualDispatchDate=function(e,r){c(e,"dispatch_date_actual",r)},e.updateDispatchComments=function(e,r){c(e,"dispatch_comments",r)},e.updateDealershipReceivedDate=function(e,r){c(e,"received_date_dealership",r)},e.checkErr=function(r){e.errMessage="",e.noShow=!0,e.curDate=new Date;var t=document.getElementById("delivery_date_customer").value,n=t.substring(0,2),s=t.substring(3,5),a=t.substring(6,10),i=new Date(a,s-1,n);if(i>e.curDate)return e.errMessage="Delivery Date should not be greater than current date",alert("Delivery Date should not be greater than current date"),e.noShow=!1,!1},e.updateCustomerDeliveryDate=function(e,r){c(e,"delivery_date_customer",r)},e.openWeightsModal=function(){e.status.delivery.new_weights={data:(0,a.default)({},e.status.delivery.weights.data)},$("#delivery_weights.modal").modal({backdrop:"static"})},e.saveWeights=function(){l({weights:e.status.delivery.new_weights}).then(function(){$("#delivery_weights.modal").modal("hide")})},e.updateDeliveryDate=function(e,r){c(e,"delivery_date",r)},e.updateDrafter=function(e,r){c(e,"drafter",r)},e.cancelFinalization=function(){e.order_finalization_cancel_reason="",$("#order_finalization_cancel_reason.modal").modal({backdrop:"static"})},e.processCancelFinalization=function(){e.post("cancel-finalize",{order_id:e.order.id,reason:e.order_finalization_cancel_reason}).then(function(e){r.go("order.status",{},{reload:!0})})},e.approveCustomerPlan=function(){l({review_customer_plan:"approve",customer_plan_disclaimer_checked:e.status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked,weight_estimate_disclaimer_checked:e.status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked})},e.confirmRejectCustomerPlan=function(){e.customer_plan_reject_reason="",$("#customer_plan_reject_reason.modal").modal({backdrop:"static"})},e.processRejectCustomerPlan=function(){l({review_customer_plan:"reject",reject_reason:e.customer_plan_reject_reason})},e.updateDoc=function(r,t,s){if(!e.loading){switch(e.loading=!0,s){case"customer":s="customer_plan";break;case"factory":s="factory_plan";break;case"chassis":s="chassis_plan";break;case"contract":s="contract"}r.$valid&&n.upload({url:"/api/orders/status-update",data:{order_id:e.order.id,upload_for:s},file:t}).then(function(e){i()},function(e){}).then(function(){e.loading=!1})}},e.updateSalesforce=function(){l()},e.updateSeparateDoc=function(r,t){r&&r.is_separated?l({add_separate_doc:t}):e.deleteDoc(r.id,t)},e.deleteDoc=function(e,r){"customer"==r?l({delete_customer_plan:e}):"factory"==r?l({delete_factory_plan:e}):"chassis"==r?l({delete_chassis_plan:e}):"contract"==r?l({delete_contract:e}):"handover_to_driver_form"==r?l({delete_handover_to_driver_form:e}):"handover_to_dealership_form"==r&&l({delete_handover_to_dealership_form:e})},e.updateHistory=function(r,t){r.$valid&&void 0!==t&&(void 0!==t.file_upload?n.upload({url:"/api/orders/status-history-note",data:{order_id:e.order.id,note:t.note},file:t.file_upload}).then(function(e){i()},function(e){}):t.note&&e.post("status-history-note",{order_id:e.order.id,note:t.note}).then(function(e){i()}),e.history={})},e.onOpenUpdateCustomerManager=function(){$("#update_customer_manager.modal").modal({backdrop:"static"})};var p=function(){e.post("customer_manager",{order_id:e.order.id}).then(function(r){e.customer_manager_list=r.data.customer_manager_list})};p(),e.updateCustomerManager=function(){e.new_customer_manager_id&&e.post("customer_manager",{order_id:e.order.id,customer_manager_id:e.new_customer_manager_id}).then(function(r){e.order.customer_manager_name=r.data.name})},e.canChangeSalesRep=function(){return e.order.permissions&&e.order.permissions.modify_order_sales_rep},e.onOpenUpdateSalesRep=function(){$("#update_sales_rep.modal").modal({backdrop:"static"})};var f=function(){e.canChangeSalesRep()&&e.post("sales_rep",{order_id:e.order.id}).then(function(r){e.sales_rep_list=r.data.sales_rep_list})};f(),e.updateSalesRep=function(){e.new_sales_rep_id&&e.post("sales_rep",{order_id:e.order.id,sales_rep_id:e.new_sales_rep_id}).then(function(r){e.order.dealer_sales_rep_name=r.data.name})}}])},e.exports=r.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){"use strict";var n=t(10);t(69),t(124)(n),n.config(["$stateProvider","$urlRouterProvider",function(e,r){r.otherwise("/customer"),e.state("order",{url:"/:orderId",template:t(292),controller:"OrderController",require:{default_sub_route:["order","order.customer"]},resolve:{FetchExistingOrder:["OrderService","$state","$q","$timeout","$stateParams",function(e,r,t,n,s){var a=s.orderId;if("new"!==a&&isNaN(parseInt(a)))return n(function(){r.go("order.customer",{orderId:"new"})}),t.reject();if("new"!==a){var i=function(){},o=function(){e.constructor(),n(function(){r.go("order.error",{error:"There was an error while retrieving the order.",orderId:"new"})})};return e.retrieveOrder(a).then(i,o)}return e.constructor(),t.resolve()}]}}).state("showroom",{url:"/showroom",template:t(298),controller:"ShowroomController"}).state("showroom.customer",{url:"/customer",template:t(294)}).state("showroom.model",{url:"/model",template:t(295),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,r,t,n){return e.validCustomer()?e:(n(function(){r.go("showroom.customer")}),t.reject())}]}}).state("showroom.series",{url:"/series",template:t(297),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,r,t,n){return e.validModel()?e:(n(function(){r.go("showroom.model")}),t.reject())}]}}).state("showroom.seriesphotos",{url:"/series-photos",template:t(296),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,r,t,n){return e.validSeries()?e:(n(function(){r.go("showroom.series")}),t.reject())}]}}).state("order.error",{url:"/error",template:t(288),params:{error:""},controller:["$scope","$stateParams",function(e,r){e.params=r}]}).state("order.manage",{url:"/manage/:orderId",controller:["$scope",function(e){e.order.model&&e.onModelSelect(),e.order.series&&e.onSeriesSelect()}],resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout","$stateParams",function(e,r,t,n,s,a){var i=function(){r.base_order=parseInt(a.orderId),s(function(){t.go("order.customer")})},o=function(){return s(function(){t.go("order.error",{error:"There was an error while retrieving the order."})}),n.reject()};return r.retrieveOrder(a.orderId).then(i,o)}]}}).state("order.customer",{url:"/customer/:customerId",template:t(287),params:{customerId:""}}).state("order.caravan",{url:"/caravan",template:t(286),controller:"OrderCaravanController",require:{default_sub_route:["order.caravan","order.caravan.features"]},resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout","$stateParams",function(e,r,t,n,s,a){if(!r.validCustomer()){var i=r.id||a.orderId;return s(function(){t.go("order.customer",{orderId:i})}),n.reject()}return r}]}}).state("order.caravan.modelseries",{url:"/model-and-series",template:t(291)}).state("order.caravan.weightsize",{url:"/weight-and-size",template:t(302),resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,r,t,n,s){return r.validModelSeries()?r:(s(function(){t.go("order.caravan.modelseries",{orderId:r.id})}),n.reject())}]}}).state("order.caravan.features",{url:"/features",template:t(289),resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,r,t,n,s){return r.validModelSeries()?r:(s(function(){t.go("order.caravan.modelseries",{orderId:r.id})}),n.reject())}]}}).state("order.caravan.resources",{url:"/resources",template:t(293)}).state("order.status",{url:"/status",template:t(301),controller:"OrderStatusController",resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,r,t,n,s){return r.validModelSeries()?r:(s(function(){t.go("order.caravan.modelseries",{orderId:r.id})}),n.reject())}]}}).state("order.special_features",{url:"/special_features",template:t(299)})}])},,,,,,,,,,,,function(e,r,t){e.exports={default:t(193),__esModule:!0}},,function(e,r,t){e.exports={default:t(196),__esModule:!0}},function(e,r,t){e.exports={default:t(198),__esModule:!0}},,,function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var s=t(186),a=n(s);r.default=a.default||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}},,function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var s=t(184),a=n(s);r.default=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return(0,a.default)(e)}},function(e,r,t){t(32),t(226),e.exports=t(4).Array.from},,,function(e,r,t){t(228),e.exports=t(4).Object.assign},,function(e,r,t){t(91),t(32),t(39),t(230),t(232),t(233),e.exports=t(4).Promise},,,,function(e,r){e.exports=function(e,r,t,n){if(!(e instanceof r)||void 0!==n&&n in e)throw TypeError(t+": incorrect invocation!");return e}},,function(e,r,t){"use strict";var n=t(11),s=t(29);e.exports=function(e,r,t){r in e?n.f(e,r,s(0,t)):e[r]=t}},,function(e,r,t){var n=t(27),s=t(80),a=t(79),i=t(12),o=t(57),l=t(61),d={},c={},r=e.exports=function(e,r,t,u,m){var p,f,_,v,g=m?function(){return e}:l(e),h=n(t,u,r?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(a(g)){for(p=o(e.length);p>b;b++)if(v=r?h(i(f=e[b])[0],f[1]):h(e[b]),v===d||v===c)return v}else for(_=g.call(e);!(f=_.next()).done;)if(v=s(_,h,f.value,r),v===d||v===c)return v};r.BREAK=d,r.RETURN=c},function(e,r){e.exports=function(e,r,t){var n=void 0===t;switch(r.length){case 0:return n?e():e.call(t);case 1:return n?e(r[0]):e.call(t,r[0]);case 2:return n?e(r[0],r[1]):e.call(t,r[0],r[1]);case 3:return n?e(r[0],r[1],r[2]):e.call(t,r[0],r[1],r[2]);case 4:return n?e(r[0],r[1],r[2],r[3]):e.call(t,r[0],r[1],r[2],r[3])}return e.apply(t,r)}},,,,,function(e,r,t){var n=t(6),s=t(90).set,a=n.MutationObserver||n.WebKitMutationObserver,i=n.process,o=n.Promise,l="process"==t(26)(i);e.exports=function(){var e,r,t,d=function(){var n,s;for(l&&(n=i.domain)&&n.exit();e;){s=e.fn,e=e.next;try{s()}catch(n){throw e?t():r=void 0,n}}r=void 0,n&&n.enter()};if(l)t=function(){i.nextTick(d)};else if(!a||n.navigator&&n.navigator.standalone)if(o&&o.resolve){var c=o.resolve(void 0);t=function(){c.then(d)}}else t=function(){s.call(n,d)};else{var u=!0,m=document.createTextNode("");new a(d).observe(m,{characterData:!0}),t=function(){m.data=u=!u}}return function(n){var s={fn:n,next:void 0};r&&(r.next=s),e||(e=s,t()),r=s}}},function(e,r,t){"use strict";var n=t(8),s=t(17),a=t(52),i=t(22),o=t(30),l=t(78),d=Object.assign;e.exports=!d||t(20)(function(){var e={},r={},t=Symbol(),n="abcdefghijklmnopqrst";return e[t]=7,n.split("").forEach(function(e){r[e]=e}),7!=d({},e)[t]||Object.keys(d({},r)).join("")!=n})?function(e,r){for(var t=o(e),d=arguments.length,c=1,u=a.f,m=i.f;d>c;)for(var p,f=l(arguments[c++]),_=u?s(f).concat(u(f)):s(f),v=_.length,g=0;v>g;)p=_[g++],n&&!m.call(f,p)||(t[p]=f[p]);return t}:d},,,,,,function(e,r,t){var n=t(15);e.exports=function(e,r,t){for(var s in r)t&&e[s]?e[s]=r[s]:n(e,s,r[s]);return e}},function(e,r,t){"use strict";var n=t(6),s=t(4),a=t(11),i=t(8),o=t(7)("species");e.exports=function(e){var r="function"==typeof s[e]?s[e]:n[e];i&&r&&!r[o]&&a.f(r,o,{configurable:!0,get:function(){return this}})}},,,function(e,r,t){var n=t(6),s=n.navigator;e.exports=s&&s.userAgent||""},,,function(e,r,t){"use strict";var n=t(27),s=t(9),a=t(30),i=t(80),o=t(79),l=t(57),d=t(204),c=t(61);s(s.S+s.F*!t(82)(function(e){Array.from(e)}),"Array",{from:function(e){var r,t,s,u,m=a(e),p="function"==typeof this?this:Array,f=arguments.length,_=f>1?arguments[1]:void 0,v=void 0!==_,g=0,h=c(m);if(v&&(_=n(_,f>2?arguments[2]:void 0,2)),void 0==h||p==Array&&o(h))for(r=l(m.length),t=new p(r);r>g;g++)d(t,g,v?_(m[g],g):m[g]);else for(u=h.call(m),t=new p;!(s=u.next()).done;g++)d(t,g,v?i(u,_,[s.value,g],!0):s.value);return t.length=g,t}})},,function(e,r,t){var n=t(9);n(n.S+n.F,"Object",{assign:t(213)})},,function(e,r,t){"use strict";var n,s,a,i,o=t(28),l=t(6),d=t(27),c=t(47),u=t(9),m=t(16),p=t(36),f=t(202),_=t(206),v=t(89),g=t(90).set,h=t(212)(),b=t(51),y=t(86),w=t(223),S=t(87),C="Promise",O=l.TypeError,k=l.process,x=k&&k.versions,A=x&&x.v8||"",E=l[C],D="process"==c(k),q=function(){},$=s=b.f,R=!!function(){try{var e=E.resolve(1),r=(e.constructor={})[t(7)("species")]=function(e){e(q,q)};return(D||"function"==typeof PromiseRejectionEvent)&&e.then(q)instanceof r&&0!==A.indexOf("6.6")&&w.indexOf("Chrome/66")===-1}catch(e){}}(),T=function(e){var r;return!(!m(e)||"function"!=typeof(r=e.then))&&r},P=function(e,r){if(!e._n){e._n=!0;var t=e._c;h(function(){for(var n=e._v,s=1==e._s,a=0,i=function(r){var t,a,i,o=s?r.ok:r.fail,l=r.resolve,d=r.reject,c=r.domain;try{o?(s||(2==e._h&&M(e),e._h=1),o===!0?t=n:(c&&c.enter(),t=o(n),c&&(c.exit(),i=!0)),t===r.promise?d(O("Promise-chain cycle")):(a=T(t))?a.call(t,l,d):l(t)):d(n)}catch(e){c&&!i&&c.exit(),d(e)}};t.length>a;)i(t[a++]);e._c=[],e._n=!1,r&&!e._h&&j(e)})}},j=function(e){g.call(l,function(){var r,t,n,s=e._v,a=I(e);if(a&&(r=y(function(){D?k.emit("unhandledRejection",s,e):(t=l.onunhandledrejection)?t({promise:e,reason:s}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",s)}),e._h=D||I(e)?2:1),e._a=void 0,a&&r.e)throw r.v})},I=function(e){return 1!==e._h&&0===(e._a||e._c).length},M=function(e){g.call(l,function(){var r;D?k.emit("rejectionHandled",e):(r=l.onrejectionhandled)&&r({promise:e,reason:e._v})})},F=function(e){var r=this;r._d||(r._d=!0,r=r._w||r,r._v=e,r._s=2,r._a||(r._a=r._c.slice()),P(r,!0))},N=function(e){var r,t=this;if(!t._d){t._d=!0,t=t._w||t;try{if(t===e)throw O("Promise can't be resolved itself");(r=T(e))?h(function(){var n={_w:t,_d:!1};try{r.call(e,d(N,n,1),d(F,n,1))}catch(e){F.call(n,e)}}):(t._v=e,t._s=1,P(t,!1))}catch(e){F.call({_w:t,_d:!1},e)}}};R||(E=function(e){f(this,E,C,"_h"),p(e),n.call(this);try{e(d(N,this,1),d(F,this,1))}catch(e){F.call(this,e)}},n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=t(219)(E.prototype,{then:function(e,r){var t=$(v(this,E));return t.ok="function"!=typeof e||e,t.fail="function"==typeof r&&r,t.domain=D?k.domain:void 0,this._c.push(t),this._a&&this._a.push(t),this._s&&P(this,!1),t.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new n;this.promise=e,this.resolve=d(N,e,1),this.reject=d(F,e,1)},b.f=$=function(e){return e===E||e===i?new a(e):s(e)}),u(u.G+u.W+u.F*!R,{Promise:E}),t(37)(E,C),t(220)(C),i=t(4)[C],u(u.S+u.F*!R,C,{reject:function(e){var r=$(this),t=r.reject;return t(e),r.promise}}),u(u.S+u.F*(o||!R),C,{resolve:function(e){return S(o&&this===i?E:this,e)}}),u(u.S+u.F*!(R&&t(82)(function(e){E.all(e).catch(q)})),C,{all:function(e){var r=this,t=$(r),n=t.resolve,s=t.reject,a=y(function(){var t=[],a=0,i=1;_(e,!1,function(e){var o=a++,l=!1;t.push(void 0),i++,r.resolve(e).then(function(e){l||(l=!0,t[o]=e,--i||n(t))},s)}),--i||n(t)});return a.e&&s(a.v),t.promise},race:function(e){var r=this,t=$(r),n=t.reject,s=y(function(){_(e,!1,function(e){r.resolve(e).then(t.resolve,n)})});return s.e&&n(s.v),t.promise}})},,function(e,r,t){"use strict";var n=t(9),s=t(4),a=t(6),i=t(89),o=t(87);n(n.P+n.R,"Promise",{finally:function(e){var r=i(this,s.Promise||a.Promise),t="function"==typeof e;return this.then(t?function(t){return o(r,e()).then(function(){return t})}:e,t?function(t){return o(r,e()).then(function(){throw t})}:e)}})},function(e,r,t){"use strict";var n=t(9),s=t(51),a=t(86);n(n.S,"Promise",{try:function(e){var r=s.f(this),t=a(e);return(t.e?r.reject:r.resolve)(t.v),r.promise}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,r,t){function n(e){return"number"==typeof e&&e==s(e)}var s=t(100);e.exports=n},,,,,,,,,,,,,,function(e,r){e.exports='<tabs data="tabData" type="tabs" class="secondary" />\r\n<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n<ui-view></ui-view>'},function(e,r){e.exports='<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n\r\n<div class="row" ng-hide="order.isCustomerVisible()">\r\n    <div class="col-sm-11 col-sm-offset-1">\r\n        <div class="panel panel-warning">\r\n            <div class="panel-body">\r\n                    You do not have the required permissions to view or edit Customer information\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div ng-hide="!order.isCustomerVisible()">\r\n    <div class="row">\r\n        <div class="col-sm-11 col-sm-offset-1">\r\n        <h3>Create a stock order</h3>\r\n\r\n        <form name="stock_form" class="form top-margin-30">\r\n            <fieldset>\r\n\r\n                <div class="form-group col-sm-6">\r\n                    <label class="form-label">DEALERSHIP</label>\r\n                    <select class="form-control"\r\n                            ng-model="order.dealership"\r\n                            ng-options="dealer.id as dealer.title for dealer in choices.dealerships"\r\n                            ng-disabled="!order.isEditable() && !permissions.reassign_stock_orders"\r\n                            required>\r\n                        <option value="">\r\n                            {{ order.isStageQuoteEditable() ? \'Select a dealership\' : order.dealership_name }}\r\n                        </option>\r\n                    </select>\r\n                </div>\r\n\r\n              \r\n                <div class="form-group col-sm-4">\r\n                    <button type="submit" class="btn btn-primary" ng-click="proceedDealerOrder(stock_form)">\r\n                        <span ng-if="!order.id">Create Dealership Order</span>\r\n                        <span ng-if="order.id && order.order_type==\'Stock\'">Save and Proceed</span>\r\n                        <span ng-if="order.id && order.order_type!=\'Stock\'">Convert to Dealership Order</span>\r\n                    </button>\r\n                </div>\r\n            </fieldset>\r\n        </form>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <div class="row">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <div class="dashed-divider-horizontal">\r\n                <span>OR</span>\r\n                <hr>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <div class="row">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <h3>Create a quote/order for a customer</h3>\r\n\r\n            <form name="customer_form" novalidate class="form top-margin-30">\r\n                <fieldset>\r\n                    <div class="row">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">DEALERSHIP</label>\r\n                            <select class="form-control"\r\n                                    name="dealership"\r\n                                    ng-model="order.dealership"\r\n                                    ng-options="dealer.id as dealer.title for dealer in choices.dealerships" required>\r\n                                <option value="">\r\n                                    {{ order.isEditable() ? \'Select a dealership\' : order.dealership_name }}\r\n                                </option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.dealership.$error" ng-if="customer_form.dealership.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">SHOW</label>\r\n                            <select class="form-control"\r\n                                    ng-model="order.show_id"\r\n                                    ng-disabled="order.show_id && order.is_expired"\r\n                                    ng-options="show.id as show.title for show in choices.shows">\r\n                                <option value="">\r\n                                    Select a Show\r\n                                </option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Customer details -->\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-6"><h4>Customer Details</h4></div>\r\n                    </div>\r\n\r\n                    <div class="row" ng-if="order.isEditable() || order.is_order_converted">\r\n                        <div class="col-sm-6" ng-if="!order.isEditable()"></div>\r\n                        <div class="col-sm-6" ng-if="order.isEditable()">\r\n                            <label class="form-label">LOOKUP EXISTING CUSTOMER</label>\r\n                            <lookup result="search.customer" min-length="3" min-wait="100"\r\n                                    ng-model="order.customer"\r\n                                    on-select="select_customer" type="customer_lookup" name="customer"\r\n                                    autocomplete="off"></lookup>\r\n                        </div>\r\n                        <div class="form-group col-sm-6" ng-if="order.is_order_converted">\r\n                            <label class="form-label">\r\n                                SALES DATE - STOCK ORDER CONVERSION</label>\r\n                            <input type="text" class="form-control" ng-model="order.order_converted" name="order_converted" placeholder="dd/mm/yyyy" ng-required="order.is_order_converted"/>\r\n                             <div ng-messages="customer_form.order_converted.$error">\r\n                             <p ng-message="required">This field is required.</p>  \r\n                             </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                FIRST NAME</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.first_name.$error" ng-if="customer_form.first_name.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                LAST NAME</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.last_name.$error" ng-if="customer_form.last_name.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                EMAIL</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.email" name="email"\r\n                                   ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                                   ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.email.$error" ng-if="customer_form.email.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">OPT IN FOR MAILING LIST\r\n                                <input type="checkbox" class="form-control form-control-small"\r\n                                       ng-model="order.customer.mailing_list" name="mailling_list"\r\n                                       ng-disabled="!isCustomerEditable()" />\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                PHONE NUMBER</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\r\n                                   ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                                   ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.phone_number.$error" ng-if="customer_form.phone_number.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">PARTNER\'S NAME</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name" ng-disabled="!isCustomerEditable()"/>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                      \r\n\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">TOW VEHICLE</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required ng-disabled="!isCustomerEditable()" />\r\n                            <div ng-messages="customer_form.tow_vehicle.$error" ng-if="customer_form.tow_vehicle.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                WHERE DID YOU HEAR FROM US?</label>\r\n                            <select class="form-control"\r\n                                    ng-model="order.customer.source_of_awareness"\r\n                                    name="referral"\r\n                                    ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\r\n                                    ng-disabled="!isCustomerEditable()">\r\n                                <option value="">Select an option</option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">\r\n                                METHOD OF CONTACT?</label>\r\n                            <select class="form-control"\r\n                                    ng-model="order.customer.acquisition_source"\r\n                                    name="referral"\r\n                                    ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\r\n                                    ng-disabled="!isCustomerEditable()">\r\n                                <option value="">Select an option</option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div ng-if="!isCustomerEditable()" class="row">\r\n                        <div class="col-sm-offset-6 col-sm-3">\r\n                            <button type="button" class="btn btn-primary" ng-click="clearCustomer()">Create new customer</button>\r\n                        </div>\r\n                        <div class="col-sm-3">\r\n                            <button type="button" class="btn btn-primary" ng-click="editCustomerFields()">Edit customer details</button>\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                    <!-- Address -->\r\n\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-6"><h4>Address</h4></div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">REGISTERED OWNER</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\r\n                                   name="registered_owner" required\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.registered_owner.$error" ng-if="customer_form.registered_owner.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">STREET ADDRESS</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" required\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.street.$error" ng-if="customer_form.street.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\r\n                            <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                            <lookup result="search.physical_suburb" min-length="3" min-wait="100"\r\n                                    ng-model="order.customer.physical_address.suburb.name"\r\n                                    on-select="select_physical_suburb" type="suburb_lookup" name="physical_address_suburb"\r\n                                    autocomplete="off"></lookup>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-20">\r\n                        <div class="form-group col-sm-6">\r\n                            <label class="form-label">CITY</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" required\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.suburb.$error" ng-if="customer_form.suburb.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-4">\r\n                            <label class="form-label">STATE</label>\r\n                            <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                    ng-model="order.customer.physical_address.suburb.post_code.state.code" name="state" required\r\n                                    ng-disabled="!isCustomerEditable()">\r\n                                <option value="">Select State</option>\r\n                            </select>\r\n                            <div ng-messages="customer_form.state.$error" ng-if="customer_form.state.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group col-sm-2">\r\n                            <label class="form-label">POSTCODE</label>\r\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required ng-pattern="/^\\d{4}$/"\r\n                                   ng-disabled="!isCustomerEditable()"/>\r\n                            <div ng-messages="customer_form.post_code.$error" ng-if="customer_form.post_code.$dirty || customer_form.$submitted">\r\n                                <p ng-message="required">This field is required.</p>\r\n                                <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-40">\r\n\r\n                        <uib-accordion class="red">\r\n\r\n                            <!-- Delivery -->\r\n\r\n                            <uib-accordion-group>\r\n                                <uib-accordion-heading>\r\n                                    <div>Add Delivery details (if different)</div>\r\n                                </uib-accordion-heading>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">NAME</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.name"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">PHONE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.phone_delivery"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">STREET ADDRESS</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.address"\r\n                                               name="delivery_street" ng-required="order.customer.delivery_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.delivery_street.$error" ng-if="customer_form.delivery_street.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\r\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                                        <lookup result="search.delivery_suburb" min-length="3" min-wait="100"\r\n                                                ng-model="order.customer.delivery_address.suburb.name"\r\n                                                on-select="select_delivery_suburb" type="suburb_lookup"\r\n                                                name="delivery_address_suburb" autocomplete="off"></lookup>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">CITY</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.suburb.name"\r\n                                               name="delivery_suburb" ng-required="order.customer.delivery_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.delivery_suburb.$error" ng-if="customer_form.delivery_suburb.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-4">\r\n                                        <label class="form-label">STATE</label>\r\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                                ng-model="order.customer.delivery_address.suburb.post_code.state.code"\r\n                                                name="delivery_state" ng-required="order.customer.delivery_address.name.length"\r\n                                                ng-disabled="!isCustomerEditable()">\r\n                                            <option value="">Select State</option>\r\n                                        </select>\r\n\r\n\r\n                                        <div ng-messages="customer_form.delivery_state.$error" ng-if="customer_form.delivery_state.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-2">\r\n                                        <label class="form-label">POSTCODE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.delivery_address.suburb.post_code.number"\r\n                                               name="delivery_post_code" ng-required="order.customer.delivery_address.name.length" ng-pattern="/^\\d{4}$/"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.delivery_post_code.$error" ng-if="customer_form.delivery_post_code.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                            </uib-accordion-group>\r\n\r\n\r\n                            <!-- Invoice -->\r\n\r\n                            <uib-accordion-group>\r\n                                <uib-accordion-heading>\r\n                                    <div>Add Invoice details (if different)</div>\r\n                                </uib-accordion-heading>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">NAME</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.name"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">PHONE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.phone_invoice"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">STREET ADDRESS</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.address"\r\n                                               name="invoice_street" ng-required="order.customer.postal_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.invoice_street.$error" ng-if="customer_form.invoice_street.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\r\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                                        <lookup result="search.invoice_suburb"\r\n                                                on-select="select_invoice_suburb" type="suburb_lookup"\r\n                                                ng-model="order.customer.postal_address.suburb.name"\r\n                                                name="invoice_address_suburb" autocomplete="off"></lookup>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="row top-margin-20">\r\n                                    <div class="form-group col-sm-6">\r\n                                        <label class="form-label">CITY</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.suburb.name"\r\n                                               name="invoice_suburb" ng-required="order.customer.postal_address.name.length"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.invoice_suburb.$error" ng-if="customer_form.invoice_suburb.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-4">\r\n                                        <label class="form-label">STATE</label>\r\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                                ng-model="order.customer.postal_address.suburb.post_code.state.code"\r\n                                                name="invoice_state" ng-required="order.customer.postal_address.name.length"\r\n                                                ng-disabled="!isCustomerEditable()">\r\n                                            <option value="">Select State</option>\r\n                                        </select>\r\n\r\n                                        <div ng-messages="customer_form.invoice_state.$error" ng-if="customer_form.invoice_state.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="form-group col-sm-2">\r\n                                        <label class="form-label">POSTCODE</label>\r\n                                        <input type="text" class="form-control"\r\n                                               ng-model="order.customer.postal_address.suburb.post_code.number"\r\n                                               name="invoice_post_code" ng-required="order.customer.postal_address.name.length" ng-pattern="/^\\d{4}$/"\r\n                                               ng-disabled="!isCustomerEditable()"/>\r\n\r\n                                        <div ng-messages="customer_form.invoice_post_code.$error" ng-if="customer_form.invoice_post_code.$dirty || customer_form.$submitted">\r\n                                            <p ng-message="required">This field is required.</p>\r\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                            </uib-accordion-group>\r\n                        </uib-accordion>\r\n\r\n                    </div>\r\n\r\n                    <div class="form-group">\r\n                        <button type="submit" class="btn btn-primary"\r\n                                ng-click="proceedCustomerOrder(customer_form)">\r\n                            <span ng-if="!order.id">Create Customer Order</span>\r\n                            <span ng-if="order.id && order.order_type==\'Customer\'">Save and Proceed</span>\r\n                            <span ng-if="order.id && order.order_type!=\'Customer\'">Convert to Customer Order</span>\r\n                        </button>\r\n                    </div>\r\n\r\n                </fieldset>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Not used as of 10/08/2016\r\n<div class="modal fade" id="lead-lookup">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\r\n                        aria-hidden="true">&times;</span></button>\r\n                <h4 class="modal-title">Lookup a Lead</h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <form name="lead_lookup_form">\r\n                    <div class="form-group">\r\n                        <label class="control-label">Lookup by First Name or Last Name</label>\r\n                        <lookup result="search.lead_lookup" min-length="3" min-wait="100"\r\n                                type="lead_lookup" name="physical_address_suburb"\r\n                                autocomplete="off"></lookup>\r\n                    </div>\r\n                </form>\r\n\r\n                <div class="alert alert-warning" ng-if="clone.message">{{ clone.message }}</div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-primary" ng-click="on_lead_lookup_select(lead_lookup_form)">Select</button>\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div-->\r\n';
},function(e,r){e.exports='<div class="row top-margin-40">\r\n    <div class="col-sm-12">\r\n        <div class="alert alert-warning">\r\n            {{ params.error }}\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="features">\n\n    <div class="row top-margin-40 series-info-header">\n        <div class="col-sm-6">\n            <a href="" ng-click="onOpenSeriesPhotos()">\n                <img ng-if="info.series_detail.photos.length" class="series-thumbnail"\n                     ng-src="{{ info.series_detail.photos[0].url }}"/></a>\n\n            <div class="series-caption">\n                <h2>{{ info.series_detail.title }}</h2>\n                <a ng-if="info.series_detail.photos.length > 1" href=""\n                   ng-click="onOpenSeriesPhotos()">View {{ info.series_detail.photos.length }}\n                    images</a><br>\n                <a ng-if="info.series_detail.plans.length" href=""\n                   ng-click="onOpenSeriesPlans()">View plans</a><br>\n            </div>\n        </div>\n        <div class="col-sm-6 pull-right">\n            <div ng-if="info.show_price">\n                Retail sales price: <span class="series-cost">{{ calculatePrice().price | currency }}</span>\n                <a href="" ng-click="info.show_price = !info.show_price">Hide</a>\n            </div>\n\n            <div ng-if="!info.show_price">\n                <button class="btn btn-default" ng-click="info.show_price = !info.show_price">Show Retail Price</button>\n            </div>\n\n            <div class="top-margin-20">\n                <button class="btn btn-default" ng-click="onOpenTotals()">Display Totals</button>\n                <button class="btn btn-default" ng-if="specials.length" ng-click="onOpenSpecials()">Special Offers and Packs</button>\n\n                <div class="btn-group" uib-dropdown>\n                    <button id="print-menu-button" type="button" class="btn btn-default" uib-dropdown-toggle>\n                        Print Menu <span class="caret"></span>\n                    </button>\n\n                    <ul id="print-menu" class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="print-menu-button">\n                        <li role="menuitem">\n                            <a ng-href="/orders/spec/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Specs</a>\n                        </li>\n                        <li role="menuitem">\n                            <a ng-href="/orders/brochure/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Brochure</a>\n                        </li>\n                        <li role="menuitem" ng-if="permissions.print_invoice">\n                            <a ng-href="/orders/invoice/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Invoice</a>\n                        </li>\n                        <li role="menuitem" ng-if="permissions.print_for_autocad">\n                            <a ng-href="/orders/autocad/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print for AutoCAD (PDF)</a>\n                        </li>\n                        <li role="menuitem" ng-if="permissions.print_for_autocad">\n                            <a ng-href="/orders/autocad/{{ order.id }}/?is_jpg=1" ng-click="onPrintPdfClick($event);">Print for AutoCAD (JPG)</a>\n                        </li>\n                    </ul>\n                </div>\n\n                <br/>\n                <button class="btn btn-default" ng-click="onOpenTradeInComment()">\n                    <span class="glyphicon" ng-class="order.trade_in_comment ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\n                    Trade-in comment\n                </button>\n                <button class="btn" ng-class="order.orderconditions.details ? (order.orderconditions.fulfilled ? \'btn-success\' : \'btn-warning\') : \'btn-default\'" ng-click="onOpenConditions()">\n                    <span class="glyphicon" ng-class="order.orderconditions.details ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\n                    Subject To...\n                </button>\n                <button class="btn btn-default" ng-click="onOpenAfterMarketNote()">\n                    <span class="glyphicon" ng-class="order.aftermarketnote.note ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\n                    After-market note\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <!-- Specials -->\n    <div class="row top-margin-40 applied-specials" ng-if="hasAppliedShowSpecial()">\n        <label class="form-label">ADDED SPECIALS:</label>\n\n        <div class="applied-special row">\n            <div class="col-sm-4"><b>{{ order.show_special.name }}</b></div>\n            <div class="col-sm-offset-4 col-sm-2">\n                <div class="price-tag">\n                    <span class="glyphicon glyphicon-tag"></span>\n                    {{ (order.show_special.price || 0) | currency }}\n                </div>\n            </div>\n            <div class="col-sm-2">\n                <a ng-click="unapplyShowSpecial(order.show_special)"><i class="glyphicon glyphicon-remove"></i> Remove</a>\n            </div>\n        </div>\n    </div>\n\n    <div class="row top-margin-40" ng-if="internal.file_uploads | hasKeys">\n        <div class="alert alert-info">\n            <h4>File Uploads in progress:</h4>\n            <ul>\n                <li ng-repeat="(k, v) in internal.file_uploads"><b>{{ v.name }}</b>: {{ v.percentage }}%</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class="row top-margin-40 selections-key">\n        <div class="col-sm-4"><b>Upgrades and Optional Extras</b></div>\n        <div class="col-sm-4" ng-if="order.isEditable()"><b>Key: </b>\n            <div class="new-selections-key-box"></div>\n            New selections for this customer\n        </div>\n    </div>\n\n    <div class="row top-margin-20">\n        <bar-spinner ng-if="loading.items"></bar-spinner>\n\n        <uib-accordion ng-if="!loading.items" class="features">\n            <uib-accordion-group ng-repeat="category in info.items">\n\n                <uib-accordion-heading>\n                    <div ng-class="{\'missing-selections\': getDepartmentsMissingSelection(category).length > 0}">\n                        <i class="glyphicon glyphicon-chevron-right"></i>\n                        <i class="glyphicon glyphicon-chevron-down"></i>\n                        {{ category.name }}\n                        <span ng-if="getDepartmentsMissingSelection(category).length">: {{ getDepartmentsMissingSelection(category).length }} Selection(s) To Be Made</span>\n                        <!--span ng-if="order.special_features[category.id].length > 0" class="pull-right glyphicon glyphicon-exclamation-sign" title="There are special features within this category."></span-->\n                    </div>\n                </uib-accordion-heading>\n\n                <div class="row">\n                    <div ng-repeat="department in category.departments"\n                         class="col-sm-6 item-group-panel"\n                         ng-if="department.selections.length || department.upgrades.length">\n\n                        <form>\n                            <div class="btn-group" uib-dropdown\n                                 ng-class="{\'dirty\':department.changed, \'needs-selection\':!order.items[department.id]}">\n\n                                <div id="single-button" type="button" class="btn btn-primary" uib-dropdown-toggle ng-disabled="!order.isEditable()">\n\n                                    <div ng-if="!hasSpecialFeatureForDepartment(category, department)" ng-click="onItemPhotoClick(order.items[department.id]); $event.stopPropagation();" class="item-thumbnail">\n                                        <i ng-if="order.items[department.id].photo" class="glyphicon glyphicon-camera"></i>\n                                    </div>\n\n                                    <div ng-if="order.items[department.id]" class="item-name" truncate truncate-title="order.items[department.id].public_description">\n                                        <span ng-if="hasSpecialFeatureForDepartment(category, department)" class="item-special-feature">Special feature</span>\n                                        <span ng-if="!hasSpecialFeatureForDepartment(category, department)">{{ order.items[department.id].public_description }}</span>\n                                    </div>\n\n                                    <div ng-if="!order.items[department.id]" class="item-name"><b>{{ department.name }}</b></div>\n\n                                    <div ng-if="isUpgrade(department, order.items[department.id]) && (+order.items[department.id].retail_price > 0)" class="price-tag">\n                                        <span class="glyphicon glyphicon-tag"></span>\n                                        <span ng-if="order.items[department.id].price_multiply">{{ order.items[department.id].price_multiply }} x </span>\n                                        {{ order.items[department.id].retail_price | currency }}\n                                    </div>\n\n                                    <span ng-if="!department.read_only && (department.selections.length > 1 || department.upgrades.length)" class="caret"></span>\n\n                                </div>\n\n                                <ul class="dropdown-menu" role="menu" aria-labelledby="single-button"\n                                    ng-if="!department.read_only && (department.selections.length > 1 || department.upgrades.length || (department.selections.length == 1 && !order.items[department.id]))">\n\n                                    <li role="menuitem" ng-repeat="item in department.selections">\n                                        <a href="javascript:void(0);" ng-click="onItemSelect(department, item)">\n\n                                            <span ng-if="item.photo" class="pull-left" ng-click="onItemPhotoClick(item); $event.stopPropagation();">\n                                                <i class="glyphicon glyphicon-camera item-thumbnail"></i>\n                                            </span>\n\n                                            <div truncate truncate-title="item.public_description">{{ item.public_description }}</div>\n                                        </a>\n                                    </li>\n\n                                    <li ng-if="department.upgrades.length" class="divider"></li>\n\n                                    <li role="menuitem" ng-repeat="item in department.upgrades">\n                                        <a href="javascript:void(0);" ng-click="onItemSelect(department, item)">\n\n                                            <span class="pull-right">\n                                                <span class="glyphicon glyphicon-tag"></span>\n                                                {{ item.retail_price | currency }}\n                                            </span>\n\n                                            <span ng-if="item.photo" class="pull-left"\n                                                  ng-click="onItemPhotoClick(item); $event.stopPropagation();">\n                                                <i class="glyphicon glyphicon-camera item-thumbnail"></i>\n                                            </span>\n\n                                            <div truncate truncate-title="item.public_description">{{ item.public_description }}</div>\n                                        </a>\n                                    </li>\n\n                                </ul>\n                            </div>\n\n                        </form>\n                    </div>\n\n                    <div ng-repeat="item in getSelectedOptions(category)" class="col-sm-6 item-group-panel">\n                        <div class="btn-group dirty" uib-dropdown>\n                            <div id="single-button" type="button" class="btn btn-primary" uib-dropdown-toggle ng-class="{\'has-special\': item.special_name}" ng-disabled="!order.isEditable()">\n\n                                <span ng-if="!item.special_name && order.isEditable()" class="pull-right option-remove-icon" ng-click="onOptionSelect(item); $event.stopPropagation();">\n                                    <i class="glyphicon glyphicon-remove"></i>\n                                </span>\n\n                                <div ng-click="onItemPhotoClick(item); $event.stopPropagation();"\n                                     class="item-thumbnail">\n                                    <i ng-if="item.photo" class="glyphicon glyphicon-camera"></i>\n                                </div>\n                                <div class="item-name" truncate truncate-title="item.public_description">\n                                    {{ item.public_description }}\n                                    <div ng-if="item.special_name" class="item-special">{{ item.special_name }}</div>\n                                </div>\n                                <div class="price-tag">\n                                    <span class="glyphicon glyphicon-tag"></span>\n                                    {{ item.retail_price | currency }}\n                                </div>\n\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row top-margin-30" ng-if="hasCategoryOptions(category)">\n                    <div class="form-group col-sm-3">\n                        <button type="submit" class="btn btn-primary form-control" ng-click="onOpenOptions(category)" ng-if="order.isEditable()">\n                            + Add Optional Extra\n                        </button>\n                    </div>\n                </div>\n            </uib-accordion-group>\n        </uib-accordion>\n    </div>\n\n    <div id="options" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title">Options</h4>\n                </div>\n                <div class="modal-body">\n\n                    <div ng-repeat="department in optionsByDepartment">\n                        <h4>{{ department.name }}</h4>\n\n                        <div ng-repeat="item in department.options">\n                            <div class="option-panel item-panel" ng-click="onOptionSelect(item)" ng-class="item.available ? \'\' : \'disabled\'">\n                                <div ng-click="onItemPhotoClick(item); $event.stopPropagation();" class="item-thumbnail">\n                                    <i ng-if="item.photo" class="glyphicon glyphicon-camera"></i>\n                                </div>\n                                <div class="item-name">{{ item.public_description }}</div>\n                                <div class="price-tag"><span class="glyphicon glyphicon-tag"></span>\n                                    {{ item.retail_price | currency }}\n                                </div>\n                                <i ng-if="!isItemSelected(item, department)" class="glyphicon glyphicon-plus indicator"></i>\n                                <i ng-if="isItemSelected(item, department)" class="glyphicon glyphicon-ok indicator"></i>\n                            </div>\n                        </div>\n\n                    </div>\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="totals" class="modal fade">\n        <div class="modal-dialog wide">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title">Totals</h4>\n                </div>\n                <div class="modal-body">\n                    <div class="totals-modal">\n\n                        <table class="table">\n                            <thead>\n                            <tr>\n                                <th></th>\n                                <th ng-if="permissions.view_order_cost_price">Manufacturing Cost</th>\n                                <th ng-if="permissions.view_order_cost_price">Your Margin</th>\n                                <th ng-if="permissions.view_order_trade_price">Wholesale</th>\n                                <th ng-if="permissions.view_order_trade_price">Margin</th>\n                                <th>Retail</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            <tr>\n                                <td><h4>Adjustments</h4><i ng-if="permissions.modify_order_retail_price || order.permissions.modify_retail_prices_finalized">Please enter adjustments in these fields ></i></td>\n                                <td ng-if="permissions.view_order_cost_price" ng-disabled="!isModelEditable()">\n                                    <input ng-if="permissions.modify_order_cost_price" class="form-control" type="number" ng-model="order.price_adjustments.cost" ng-change="order.price_changed = true" />\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ order.price_adjustments.wholesale | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price" ng-disabled="!isModelEditable()">\n                                    <div ng-if="permissions.modify_order_trade_price">\n                                        <div class="row">\n                                            <input class="form-control" type="number" ng-model="order.price_adjustments.wholesale" ng-change="order.price_changed = true" />\n                                        </div>\n                                        <div class="row">\n                                            <input class="form-control" type="text" ng-model="order.price_adjustments.wholesale_comment" placeholder="Comment" ng-change="order.price_changed = true" />\n                                            <div ng-if="order.price_adjustments.wholesale && !order.price_adjustments.wholesale_comment">\n                                                <span id="wholesale_comment-error" class="error">A comment is required if a value is entered.</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ order.price_adjustments.retail | currency }}\n                                </td>\n                                <td>\n                                    <input ng-if="permissions.modify_order_retail_price || order.permissions.modify_retail_prices_finalized" class="form-control" type="number" ng-model="order.price_adjustments.retail" ng-change="order.price_changed = true" />\n                                    <div class="top-margin-10" ng-if="!(permissions.modify_order_retail_price|| order.permissions.modify_retail_prices_finalized)">{{ order.price_adjustments.retail | currency }}</div>\n                                </td>\n                            </tr>\n                            <tr ng-if="permissions.view_order_trade_price">\n                                <td>Dealer Load Price</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.dealer_load" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.dealer_load | currency }}</span>\n                                </td>\n                                <td>\n                                    {{ (-order.dealer_load) | currency }}\n                                </td>\n                                <td>&nbsp;</td>\n                            </tr>\n                            <tr ng-if="permissions.view_order_trade_price">\n                                <td>Trade-in w/back</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.trade_in_write_back" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.trade_in_write_back | currency }}</span>\n                                </td>\n                                <td>\n                                    {{ (-order.trade_in_write_back) | currency }}\n                                </td>\n                                <td>&nbsp;</td>\n                            </tr>\n\n                            <tr ng-if="permissions.view_order_trade_price">\n                                <td>After Sales</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.after_sales.wholesale" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.after_sales.wholesale | currency }}</span>\n                                </td>\n                                <td>\n                                    {{ order.after_sales.retail-order.after_sales.wholesale | currency }}\n                                </td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.after_sales.retail" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.after_sales.retail | currency }}</span>\n                                </td>\n                            </tr>\n                            <tr ng-if="permissions.view_order_trade_price" >\n                                <td>Description</td>\n                                <td colspan="999">\n                                    <input class="form-control comments" type="text" ng-model="order.after_sales.description" ng-change="order.price_changed = true" />\n                                </td>\n                            </tr>\n\n                            <tr>\n                                <td>Basic Caravan Prices</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.caravan | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.caravan - totals.manufacture.caravan) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.caravan | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.caravan - totals.wholesale.caravan) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.caravan | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-hide="options_upgrades_expanded">\n                                <td>Options & Upgrades (<a ng-click="options_upgrades_expanded=true">show</a>)</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.options + totals.manufacture.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.options - totals.manufacture.options) + (totals.wholesale.upgrades - totals.manufacture.upgrades) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.options + totals.wholesale.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.options - totals.wholesale.options) + (totals.retail.upgrades - totals.wholesale.upgrades) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.options + totals.retail.upgrades | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-header" ng-show="options_upgrades_expanded">\n                                <td>Options & Upgrades (<a ng-click="options_upgrades_expanded=false">hide</a>)</td>\n                                <td colspan="5"></td>\n                            </tr>\n                            <tr class="totals-item totals-item-entry" ng-repeat="item in totals.options_upgrades track by $index" ng-show="options_upgrades_expanded">\n                                <td>{{ item.name }}</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ item.manufacture | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (item.wholesale - item.manufacture) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ item.wholesale | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (item.retail - item.wholesale) | currency }}\n                                </td>\n                                <td>\n                                    {{ item.retail | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-totals" ng-show="options_upgrades_expanded">\n                                <td>Option & Upgrades Total</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.options + totals.manufacture.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.options - totals.manufacture.options) + (totals.wholesale.upgrades - totals.manufacture.upgrades) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.options + totals.wholesale.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.options - totals.wholesale.options) + (totals.retail.upgrades - totals.wholesale.upgrades) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.options + totals.retail.upgrades | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-hide="special_features_expanded">\n                                <td>Special Features (<a ng-click="special_features_expanded=true">show</a>)</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.special_features - totals.manufacture.special_features) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.special_features - totals.wholesale.special_features) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.special_features | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-header" ng-show="special_features_expanded">\n                                <td>Special Features (<a ng-click="special_features_expanded=false">hide</a>)</td>\n                                <td colspan="5"></td>\n                            </tr>\n                            <tr class="totals-item totals-item-entry" ng-repeat="item in totals.special_features track by $index" ng-show="special_features_expanded">\n                                <td>{{ item.name }}</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ item.manufacture | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (item.wholesale - item.manufacture) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ item.wholesale | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (item.retail - item.wholesale) | currency }}\n                                </td>\n                                <td>\n                                    {{ item.retail | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-totals" ng-show="special_features_expanded">\n                                <td>Special Features Total</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.special_features - totals.manufacture.special_features) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.special_features - totals.wholesale.special_features) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.special_features | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-if="hasAppliedShowSpecial()">\n                                <td>Show Special</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                </td>\n                                <td>\n                                    {{ order.show_special.price | currency }}\n                                </td>\n                            </tr>\n                            <tr id="totals--grand-totals">\n                                <td>Grand Totals</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.totalNoAdjustment + order.price_adjustments.cost | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale + order.dealer_load + order.trade_in_write_back + order.after_sales.wholesale| currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) - (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - order.after_sales.wholesale - order.dealer_load - order.trade_in_write_back | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail | currency }}\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>Total Excluding GST</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ ((totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost)) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale + order.dealer_load + order.after_sales.wholesale + order.trade_in_write_back) / (1 + GST_PERCENT)| currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ ((totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) - (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - order.after_sales.wholesale - order.dealer_load - order.trade_in_write_back) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                                <td>\n                                    {{ (totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-if="order.permissions.modify_order_other_prices" >\n                                <td>Other comments</td>\n                                <td colspan="999">\n                                    <input class="form-control comments" type="text" ng-model="order.price_comment" ng-change="order.price_changed = true" />\n                                </td>\n                            </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button ng-if="canOrderPricesBeSaved()" class="btn btn-primary" data-dismiss="modal" ng-click="saveOrder()">Save Prices</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="photos" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3><b>{{ view_header }}</b></h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                </div>\n                <div class="modal-body">\n                    <ul ng-if="view_photos.length" rn-carousel rn-carousel-controls class="image">\n                        <li ng-repeat="image in view_photos">\n                            <div class="layer"><img ng-src="{{ image.url }}"/></div>\n                        </li>\n                    </ul>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="rules" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Rules when choosing {{ info.rules[0].item.public_description }}</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                </div>\n                <form name="rules_form" novalidate ng-submit="acceptRules(rules_form, rules_plan_upload)">\n                    <div class="modal-body">\n                        <div ng-repeat="rule in info.rules">\n                            <h3>Rule: {{ rule.title }}</h3>\n                            <div ng-if="rule.type_code==\'ADD_EXTRAS\'" class="alert alert-info">\n                                <h4>The following extras will be automatically added:</h4>\n                                <ul>\n                                    <li ng-repeat="item in rule.items">{{ item.public_description }}</li>\n                                </ul>\n                            </div>\n                            <div ng-if="rule.type_code==\'MAKE_SELECTION\'" class="alert alert-info">\n                                <h4>Please select from the following:</h4>\n                                <select name="make_selection" class="form-control" ng-model="rule.selection"\n                                        ng-options="{item:item} as item.public_description for item in rule.items" required>\n                                    <option value="">-- Please select --</option>\n                                </select>\n                                <div ng-messages="rules_form.make_selection.$error" ng-if="rules_form.$submitted && rules_form.$invalid">\n                                    <p ng-message="required">Please make a selection</p>\n                                </div>\n                            </div>\n                            <div ng-if="rule.type_code==\'WARNING\'" class="alert alert-warning">\n                                {{ rule.text }}\n                            </div>\n                            <div ng-if="rule.type_code==\'PRICE_MULTIPLY\'" class="alert alert-info" ng-init="items = priceMultiplyItems(rule.item, rule.items)">\n                                <h4>The price of this item will be multiplied by:</h4>\n                                <ul><li ng-repeat="item in items.applicableItems">\n                                    {{ item.quantity }} x {{ item.public_description }}\n                                </li></ul>\n                                <b>Total cost based on current selections: </b>{{ items.totalPrice | currency }}<br><br>\n                                <h4>Price also depends on the following items, when selected:</h4>\n                                <ul><li ng-repeat="item in items.otherItems">\n                                    {{ item.quantity }} x {{ item.public_description }}\n                                </li></ul>\n                            </div>\n                            <div ng-if="rule.type_code==\'CUSTOMER_ENTRY\'" class="alert alert-info">\n                                <h4>Please specify additional information:</h4>\n                                <textarea class="form-control" name="customer_entry" ng-model="rule.customer_entry" required></textarea>\n                            </div>\n                            <div ng-if="rule.type_code==\'PRODUCTION_NOTE\'" class="alert alert-info">\n                                <h4>The following will be added as a production note on the order:</h4>\n                                <p>{{ rule.text }}</p>\n                            </div>\n                            <div ng-if="rule.type_code==\'MARK_PLAN\'" class="alert alert-info">\n                                <p>\n                                    <h4>Upload a new plan for this item:</h4>\n                                    <button class="btn btn-primary" ngf-select ng-model="rule.file_upload" name="mark_plan"\n                                            ngf-max-size="20MB" required>\n                                        Choose Plan to Upload\n                                    </button>\n                                    <span class=\'file-upload-filename\' ng-if="rule.file_upload">{{ rule.file_upload.name }}</span>\n                                    <div ng-messages="rules_form.mark_plan.$error"\n                                         ng-if="rules_form.$submitted && rules_form.$invalid">\n                                        <p ng-message="required">Please select a file to upload</p>\n                                    </div>\n                                </p>\n                                <br>\n                                <p>\n                                <h4>Describe the location for the new item:</h4>\n                                <textarea class="form-control" name="mark_plan_notes" ng-model="rule.file_upload_notes"\n                                          required></textarea>\n\n                                <div ng-messages="rules_form.mark_plan_notes.$error"\n                                     ng-if="rules_form.$submitted && rules_form.$invalid">\n                                    <p ng-message="required">Please describe the item\'s location</p>\n                                </div>\n                                </p>\n                            </div>\n                            <div ng-if="rule.type_code==\'FORCE_SELECTION\'" class="alert alert-info">\n                                <h4>The following items will be automatically selected:</h4>\n                                <ul>\n                                    <li ng-repeat="item in rule.items">{{ item.public_description }}</li>\n                                </ul>\n                            </div>\n                        </div>\n\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelRules()">\n                            Cancel\n                        </button>\n                        <button type="submit" class="btn btn-primary">Accept</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n\n    <div id="specials" class="modal fade specials">\n        <div class="modal-dialog medium">\n            <div class="modal-content">\n                <div class="modal-body">\n                    <div ng-repeat="special in specials">\n                        <hr ng-if="$index > 0" />\n                        <div class="row">\n                            <div class="col-sm-12">\n                                <h1>{{ special.name }}</h1>\n                            </div>\n                        </div>\n\n                        <div class="row">\n                            <div class="col-sm-3">\n                                <h2>Offer:</h2>\n                            </div>\n                            <div class="col-sm-6">\n                                <h2>Availability:</h2>\n                            </div>\n                        </div>\n\n                        <div class="row">\n                            <div class="col-sm-3">\n                                <h3>\n                                    {{ special.description }} <i ng-if="special.applied" class="applied-special glyphicon glyphicon-ok"></i>\n                                </h3>\n                            </div>\n                            <div class="col-sm-6">\n                                <p>{{ special.availability_description }}</p>\n                                <small ng-if="special.tac_url"><a href="{{ special.tac_url }}" target="_blank">Terms and Conditions</a></small>\n                            </div>\n                        </div>\n\n                        <div ng-if="special.price !== undefined && special.price >= 0">\n                            <div class="row">\n                                <div class="col-sm-offset-3 col-sm-2">\n                                    <h2>Cost:</h2>\n                                </div>\n                                <div ng-if="special.normal_price != special.price && special.price > 0" class="col-sm-2">\n                                    <h2>Normal price:</h2>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-sm-offset-3 col-sm-2">\n                                    <strong ng-if="special.price != 0">{{ special.price | currency}}</strong>\n                                    <strong ng-if="special.price == 0">FREE</strong>\n                                </div>\n                                <div ng-if="special.normal_price != special.price && special.price > 0" class="col-sm-2">\n                                    <strong>{{ special.normal_price | currency }}</strong>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class="buttons">\n                            <button ng-if="!special.applied" class="btn btn-primary apply" ng-click="applyShowSpecial(special)" ng-disabled="!info.items" ng-attr-title="{{ info.items?\'\':\'Loading series items...\' }}">Apply this special</button>\n                            <button ng-if="special.applied" class="btn btn-primary apply" ng-click="unapplyShowSpecial(special)" ng-disabled="!info.items" ng-attr-title="{{ info.items?\'\':\'Loading series items...\' }}">Unapply this special</button>\n                        </div>\n                    </div>\n                </div>\n\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="order_conditions" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Subject to conditions:</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter the specific conditions for this order..."\n                              class="form-control"\n                              ng-model="order.orderconditions.details" ></textarea>\n                    <div>\n                        <label>\n                            <input type="checkbox" ng-model="order.orderconditions.fulfilled" ng-disabled="!order.orderconditions.details.length"/>\n                            These conditions are met.\n                        </label>\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button ng-if="order.order_stage_details.code != \'ORDER_FINALIZED\' && order.order_stage_details.code != \'ORDER\'" type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="after_market_note" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>After-Market notes</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter your after-market notes here..."\n                              class="form-control"\n                              ng-model="order.aftermarketnote.note"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="trade_in_comment" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Trade-in comments</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter your trade-in comments here..."\n                              class="form-control"\n                              ng-model="order.trade_in_comment"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n';
},function(e,r){e.exports='<p ng-message="required">This field is required</p>'},function(e,r){e.exports='<form name="modelseries_form" class="form">\r\n    <div class="row top-margin-40">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <div class="row">\r\n                <div class="col-sm-6 divider dashed-divider-vertical">\r\n                    <h3>Select from base model and series</h3>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">MODEL</label>\r\n                        <select class="form-control" ng-disabled="!isModelEditable()"\r\n                                ng-model="order.modelSelection"\r\n                                ng-change="onModelChange()"\r\n                                ng-options="model.id as model.title for model in choices.models">\r\n                            <option value="">Select Model</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">SERIES</label>\r\n                        <select class="form-control" ng-disabled="!isModelEditable()"\r\n                                ng-model="order.seriesSelection"\r\n                                ng-change="onSeriesChange()"\r\n                                ng-options="series.id as series.title for series in choices.series">\r\n                            <option value="">Select Series</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-12">\r\n                            <button class="btn btn-primary" ng-click="proceed()" ng-if="isModelEditable()">Continue with this Series</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <span>OR</span>\r\n                </div>\r\n\r\n                <div class="col-sm-6 divider">\r\n                    <h3>Select a previous customer/stock model</h3>\r\n\r\n                    <div class="form-group top-margin-20">\r\n                        <label class="form-label">CUSTOMER NAME OR CHASSIS NUMBER</label>\r\n                        <lookup result="order_lookup_result" placeholder="Search by Customer Name or Chassis Number"\r\n                                on-select="onOrderLookupSelect" ng-disabled="!isModelEditable()"\r\n                                url="orders/search-orders" get-extra-data="orderLookupData" min-length="2"\r\n                                min-wait="100"></lookup>\r\n                    </div>\r\n\r\n                    <div class="row top-margin-40">\r\n                        <div class="col-sm-12">\r\n                            <button class="btn btn-primary" ng-click="assignSelectedOrderAndProceed()" ng-if="isModelEditable()">Continue with items from selected order</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <div ng-if="modelseries_form.$submitted && (!order.validModel() || !order.validSeries())" class="row top-margin-20">\r\n        <div class="col-sm-12">\r\n            <div class="alert alert-warning">\r\n                Please select a model and series to proceed.\r\n            </div>\r\n        </div>\r\n    </div>\r\n</form>\r\n'},function(e,r){e.exports='<top-bar>\r\n    <h4>{{ current_dealership().title }}</h4>\r\n    <h2>\r\n        <span ng-if="!order.id">New </span>\r\n        {{ order.order_stage_details ? order.order_stage_details.label : \' Quote\' }}\r\n        {{ order.id }}<span ng-if="order.chassis">, Chassis # {{ order.chassis }}</span>\r\n        {{ order.order_stage_details.code == \'CANCELLED\' ? \' (Cancelled)\' : \'\' }}\r\n    </h2>\r\n\r\n    <div class="pull-right">\r\n        <div class="row text-right">\r\n            <button ng-if="canOrderApprovalBeRequested()" class="btn btn-primary pull-right header-right-button" ng-click="requestOrderApproval()" ng-disabled="!info.items">Request to Place Order</button>\r\n\r\n            <button ng-if="canOrderBePlaced()" class="btn btn-primary pull-right header-right-button" ng-click="confirmPlaceOrder()" ng-disabled="!info.items">Place Order</button>\r\n            <button ng-if="canOrderApprovalBeRejected()" class="btn btn-primary pull-right header-right-button" ng-click="rejectOrderApproval()" ng-disabled="!info.items">Reject Order</button>\r\n            <button ng-if="canOrderBeCancelled()" class="btn btn-primary pull-right header-right-button" ng-click="confirmCancelOrder()" ng-disabled="!info.items">Cancel Order</button>\r\n\r\n            <button ng-if="canOrderBeFinalized()" class="btn btn-primary pull-right header-right-button" ng-click="finalizeOrder()" ng-disabled="!info.items">Lock Order</button>\r\n\r\n            <button ng-if="canOrderBeSaved()" class="btn btn-primary pull-right header-right-button" ng-click="saveOrder()" ng-disabled="!info.items">Save {{ order.order_stage_details.label }}</button>\r\n            <div class="spinner-container"><bar-spinner ng-if="loading.order"></bar-spinner></div>\r\n        </div>\r\n        <div class="row text-right top-margin-10">\r\n            <button ng-if="canCreateOrderForSameCustomer()" class="btn btn-primary pull-right header-right-button" ng-click="newOrderForCustomer()">Start a new Quote for this customer</button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-bar-info">\r\n        <div class="col-sm-2" ng-if="current_dealership()">\r\n            <h5>Customer</h5>\r\n            <h4 ng-if="!order.customer">(STOCK)</h4>\r\n            <h4 ng-if="order.customer">{{ order.customer.first_name }} {{ order.customer.last_name }}</h4>\r\n        </div>\r\n        <div class="col-sm-2" ng-if="order.model && order.series">\r\n            <h5>Model</h5>\r\n            <h4>{{ order.series_code }}</h4>\r\n        </div>\r\n        <div class="col-sm-2" ng-if="order.model && order.series">\r\n            <h5>Retail Sale price</h5>\r\n            <h4 name="order_retailprice" ng-if="info.show_price">{{ calculatePrice().price | currency }}</h4>\r\n            <a href="" ng-click="info.show_price = !info.show_price">\r\n                <span ng-if="info.show_price">Hide </span>\r\n                <span ng-if="!info.show_price">Show </span>price\r\n            </a>\r\n        </div>\r\n        <div class="col-sm-2" ng-if="order.model && order.series">\r\n            <h5>Stage</h5>\r\n            <h4 name="order_stage">{{ order.order_stage_details.label }}{{ order.is_expired? " (Expired)" : "" }}{{ order.order_stage_details.code == \'CANCELLED\' ? \' (Cancelled)\' : \'\' }}</h4>\r\n        </div>\r\n\r\n    </div>\r\n    <div class="row top-bar-info">\r\n        <div class="col-sm-4" ng-if="order.model && order.series">\r\n            <h5>Production Month</h5>\r\n            <h4>{{ order.production_month?order.production_month:"N/A" }}</h4>\r\n        </div>\r\n        <div class="col-sm-4" ng-if="order.model && order.series">\r\n            <h5>Production Date</h5>\r\n            <h4>{{ order.production_start_date?order.production_start_date:"N/A" }}</h4>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row top-bar-info alert alert-danger" ng-if="order.salesforce_sync_error">\r\n        <div class="col-sm-6">\r\n            There was an issue on the last sync with Salesforce. Please try again.\r\n        </div>\r\n        <div class="col-sm-2">\r\n            <button ng-click="updateSalesforce()">Update Salesforce</button>\r\n        </div>\r\n    </div>\r\n</top-bar>\r\n\r\n<div>\r\n    <tabs data="tabData" type="tabs" />\r\n    <a id="message-anchor"></a>\r\n    <ui-view></ui-view>\r\n</div>\r\n\r\n<div id="cancel_order" class="modal fade">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h3>Cancelling order</h3>\r\n            </div>\r\n            <div class="modal-body">\r\n                <textarea rows="10" cols="65" placeholder="Please enter the reason for cancellation..."\r\n                          maxlength="2000"\r\n                          class="form-control"\r\n                          ng-model="cancelReason"></textarea>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelOrder()">Cancel Order</button>\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<div id="place_order" class="modal fade">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h4>Confirm Order Placement</h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <div>\r\n                    <p>\r\n                        By selecting <strong>Place Order</strong> you acknowledge that this order becomes irrevocable for a stock unit or will attract $1000 cancellation fee if it is a customer order.\r\n                    </p>\r\n                    <p>\r\n                        If any customer order has passed the lockdown date then that order also becomes irrevocable.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-default" data-dismiss="modal">Decline</button>\r\n                <button type="button" class="btn btn-primary" ng-click="placeOrder()" data-dismiss="modal">Place Order</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,r){e.exports=""},function(e,r){e.exports='<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n\r\n<div class="container">\r\n    <div class="row">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n\r\n            <form name="customer_form" novalidate class="top-margin-40">\r\n\r\n                <div class="row">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">SHOW</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.show_id"\r\n                                ng-options="show.id as show.title for show in choices.shows">\r\n                            <option value="">\r\n                                Select a Show\r\n                            </option>\r\n                        </select>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">DEALERSHIP</label>\r\n                        <select class="form-control"\r\n                                name="dealership"\r\n                                ng-model="order.dealership"\r\n                                ng-options="dealer.id as dealer.title for dealer in choices.dealerships" required>\r\n                            <option value="">\r\n                                {{ order.isEditable() ? \'Select a dealership\' : order.dealership_name }}\r\n                            </option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.dealership.$error" ng-if="customer_form.dealership.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-40">\r\n                    <div class="col-sm-6"><h4>Customer Details</h4></div>\r\n                </div>\r\n\r\n                <div class="row">\r\n                    <div class="col-sm-6">\r\n                        <label class="form-label">LOOKUP EXISTING CUSTOMER</label>\r\n                        <lookup result="search.customer" min-length="3" min-wait="100"\r\n                                ng-model="order.customer"\r\n                                on-select="select_customer" type="customer_lookup" name="customer"\r\n                                autocomplete="off"></lookup>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            FIRST NAME</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer"/>\r\n                        <div ng-messages="customer_form.first_name.$error" ng-if="customer_form.first_name.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            LAST NAME</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.last_name.$error" ng-if="customer_form.last_name.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            EMAIL</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.email" name="email"\r\n                               ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.email.$error" ng-if="customer_form.email.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">OPT IN FOR MAILING LIST\r\n                            <input type="checkbox" class="form-control form-control-small" ng-model="order.customer.mailing_list" name="mailling_list"\r\n                                   ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            PHONE NUMBER</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\r\n                               ng-required="!(order.customer.email.length || order.customer.phone1.length)"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.phone_number.$error" ng-if="customer_form.phone_number.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">Either the phone number or the email address is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">PARTNER\'S NAME</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">DESIRED DELIVERY MONTH</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.delivery_date"\r\n                                ng-options="date.value as date.title for date in choices.available_delivery_months">\r\n                            <option value="">\r\n                                {{ order.isStageQuoteEditable() ? \'Select a month\' : order.delivery_date | date:AppSettings.FORMAT_DATE_MONTH_SHORT_JS }}\r\n                            </option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.delivery_date.$error" ng-if="customer_form.delivery_date.$dirty || customer_form.$submitted">\r\n                            <p ng-message="date">There is a problem with the date.</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">TOW VEHICLE</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.tow_vehicle.$error" ng-if="customer_form.tow_vehicle.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            WHERE DID YOU HEAR FROM US?</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.customer.source_of_awareness"\r\n                                name="referral"\r\n                                ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\r\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\r\n                            <option value="">Select an option</option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">\r\n                            METHOD OF CONTACT?</label>\r\n                        <select class="form-control"\r\n                                ng-model="order.customer.acquisition_source"\r\n                                name="referral"\r\n                                ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\r\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\r\n                            <option value="">Select an option</option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div ng-if="order.customer.id" class="row">\r\n                    <div class="col-sm-offset-6 col-sm-3">\r\n                        <button type="button" class="btn btn-primary" ng-click="clearCustomer()">Create new customer</button>\r\n                    </div>\r\n                    <div class="col-sm-3">\r\n                        <button type="button" class="btn btn-primary" ng-click="editCustomerFields()">Edit customer details</button>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                <!-- Address -->\r\n\r\n\r\n                <div class="row top-margin-40">\r\n                    <div class="col-sm-6"><h4>Address</h4></div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">REGISTERED OWNER</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\r\n                               name="registered_owner" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.registered_owner.$error" ng-if="customer_form.registered_owner.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">STREET ADDRESS</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.street.$error" ng-if="customer_form.street.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-6" ng-if="!order.customer.id || editCurrentCustomer">\r\n                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\r\n                        <lookup result="search.physical_suburb" min-length="3" min-wait="100"\r\n                                ng-model="order.customer.physical_address.suburb.name"\r\n                                on-select="select_physical_suburb" type="suburb_lookup" name="physical_address_suburb"\r\n                                autocomplete="off"></lookup>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row top-margin-20">\r\n                    <div class="form-group col-sm-6">\r\n                        <label class="form-label">CITY</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" required\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.suburb.$error" ng-if="customer_form.suburb.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-4">\r\n                        <label class="form-label">STATE</label>\r\n                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\r\n                                ng-model="order.customer.physical_address.suburb.post_code.state.code" name="state" required\r\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\r\n                            <option value="">Select State</option>\r\n                        </select>\r\n                        <div ng-messages="customer_form.state.$error" ng-if="customer_form.state.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group col-sm-2">\r\n                        <label class="form-label">POSTCODE</label>\r\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required ng-pattern="/^\\d{4}$/"\r\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\r\n                        <div ng-messages="customer_form.post_code.$error" ng-if="customer_form.post_code.$dirty || customer_form.$submitted">\r\n                            <p ng-message="required">This field is required.</p>\r\n                            <p ng-message="pattern">Postcode must be 4 digits.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="form-group col-sm-6 col-sm-offset-3 top-margin-40">\r\n                    <label class="control-label"></label>\r\n\r\n                    <div class="col-sm-4 pull-right">\r\n                        <button type="submit" class="btn btn-primary form-control"\r\n                                ng-click="customerProceed(customer_form)">Continue\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="container model-select">\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            <h2>Select a model</h2>\r\n\r\n            <div class="model-panel" ng-repeat="model in choices.model_series|filter:hasModelAvailableSeries" ng-click="onModelClick(model)">\r\n                <div class="model-logo">\r\n                    <img ng-src="{{ model.logo }}" class="series-image"/>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</div>'},function(e,r){e.exports='<div class="container series-photos">\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            <h2><span class="series-code">{{ current.series.code }}</span> {{ current.series.name }}</h2>\r\n        </div>\r\n    </div>\r\n    <div class="row" ng-repeat="photo in current.series.photos">\r\n        <div class="col-sm-12">\r\n            <img ng-src="{{ photo.url }}" class="series-photo" width="600px" />\r\n        </div>\r\n    </div>\r\n\r\n    <button class="btn btn-primary" ng-click="onSeriesSelect()">Select Series</button>\r\n    <div ng-if="errors.series_select" class="top-margin-30 alert alert-danger">{{ errors.series_select }}</div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="container series-select">\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            <h2>Select a series</h2>\r\n\r\n            <div class="model-banner"><img ng-src="{{ current.model.logo }}" class="model-logo"/></div>\r\n\r\n            <div class="series-panel" ng-repeat="series in current.model.series|filter:isSeriesAvailableForDealership">\r\n                <div ng-if="series.photos.length">\r\n                    <img ng-src="{{ series.photos[0].url }}" class="series-image"/>\r\n                </div>\r\n                <h4><span class="series-code">{{ series.code }}</span> {{ series.name }}</h4>\r\n                <div class=\'row\'>\r\n                    <button class=\'col-sm-6\' ng-click="onViewSeriesPhotoClick(series)">View Series photos</button>\r\n                    <button class=\'col-sm-6\' ng-click="onStartQuoteClick(series)">Start a quote</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},function(e,r){e.exports='<div class="showroom">\r\n    <ui-view></ui-view>\r\n</div>\r\n'},function(e,r){e.exports='<div ng-if="message" class="alert {{ message.type }}">\r\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\r\n</div>\r\n<div id="special_features">\r\n\r\n    <div class="row top-row" ng-if="permissions.set_custom_series">\r\n        <div class="col-sm-5 col-sm-offset-1">\r\n            <label for="custom_series_name">Custom series name:</label>\r\n            <input id="custom_series_name" ng-model="order.custom_series_name" />\r\n        </div>\r\n        <div class="col-sm-5">\r\n            <label for="custom_series_code">Custom series code:</label>\r\n            <input id="custom_series_code" ng-model="order.custom_series_code" />\r\n        </div>\r\n    </div>\r\n\r\n    <table>\r\n        <tr>\r\n            <th>Customer Description</th>\r\n            <th ng-if="permissions.modify_special_features_wholesale" class="price-header">$ Wholesale</th>\r\n            <th class="price-header">$ Retail</th>\r\n            <th class="attachment-header">Attachment</th>\r\n            <th class="button-header">Remove</th>\r\n            <th class="button-header">Approved</th>\r\n        </tr>\r\n\r\n        <tr ng-repeat-start="feature in order.special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td>\r\n                <input type="text" class="form-control" placeholder="e.g. ..." ng-disabled="!order.isEditable()"\r\n                    ng-change="onFeatureDetailChange(feature)"\r\n                    ng-model="feature.customer_description"/>\r\n            </td>\r\n\r\n            <td ng-if="permissions.modify_special_features_wholesale">\r\n                <input ng-disabled="order.customer_plans_approved"\r\n                    type="text" class="form-control"  maxlength="8"\r\n                    ng-change="onFeatureDetailChange(feature)"\r\n                    ng-model="feature.wholesale_price" />\r\n            </td>\r\n\r\n            <td>\r\n                <input type="text" class="form-control" maxlength="8"\r\n                    ng-change="onFeatureDetailChange(feature)"\r\n                    ng-model="feature.retail_price" ng-disabled="!order.isEditable()" />\r\n            </td>\r\n\r\n            <td>\r\n                <div class="form-group attachment">\r\n                    <div ng-if="feature.new_document || feature.document">\r\n                        <label>\r\n                            Specification doc:\r\n                        </label>\r\n                        <a ng-if="!feature.new_document" href="{{ feature.document.url }}" target="_blank">{{ feature.document.name }}</a>\r\n                        <span ng-if="feature.new_document">{{ feature.new_document.name }}</span>\r\n                        <button class="form-control btn btn-default" ng-if="order.isEditable()"\r\n                            ng-click="removeFeatureDocument(feature)">\r\n                            Remove Document\r\n                        </button>\r\n                    </div>\r\n                    <div ng-if="!feature.new_document && !feature.document">\r\n                        <button class="form-control btn btn-default" ngf-select ng-disabled="!order.isEditable()"\r\n                            ng-model="feature.new_document">\r\n                            Add Document\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </td>\r\n\r\n            <td>\r\n                <button type="text" class="form-control btn btn-primary remove-special-feature" ng-disabled="!order.isEditable()"\r\n                        ng-click="removeSpecialFeature($index)">\r\n                    <span class="glyphicon glyphicon-minus"></span>\r\n                </button>\r\n            </td>\r\n\r\n            <td class="approval-state">\r\n                <span ng-if="feature.approved !== null"\r\n                      class="status glyphicon {{ feature.approved ? \'glyphicon-ok-sign\' : \'glyphicon-remove-sign\' }}"\r\n                      ng-class="permissions.approve_special_features ? \'clickable\' : \'\'"\r\n                      ng-click="permissions.approve_special_features ? feature.approved = null : \'\'"></span>\r\n\r\n                <span ng-if="!permissions.approve_special_features && feature.approved === null" class="status glyphicon glyphicon-question-sign"></span>\r\n\r\n                <div ng-if="permissions.approve_special_features && feature.approved === null">\r\n                    <button type="button" class="btn btn-xs btn-success" ng-click="feature.approved = true">\r\n                        <span class="glyphicon glyphicon-ok-sign"></span>\r\n                    </button>\r\n                    <button type="button" class="btn btn-xs btn-danger" ng-click="feature.approved = false">\r\n                        <span class="glyphicon glyphicon-remove-sign"></span>\r\n                    </button>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n\r\n        <tr ng-if="feature.approved === false" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td colspan="999">\r\n                <input class="form-control error" ng-model="feature.reject_reason" ng-readonly="!permissions.approve_special_features" placeholder="Enter reason for rejection.."/>\r\n            </td>\r\n        </tr>\r\n\r\n        <tr ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td class="label">Work Centre:</td>\r\n            <td colspan="3">\r\n                <select class="form-control"\r\n                    ng-model="feature.selectedCategory"\r\n                    ng-change="onSpecialFeatureCategorySelect(feature)"\r\n                    ng-options="c as c.title for c in choices.categories track by c.id">\r\n\r\n                    <option value="">(None)</option>\r\n                </select>\r\n            </td>\r\n            <td colspan="999"></td>\r\n        </tr>\r\n\r\n        <tr ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td class="label">Replaces Item:</td>\r\n            <td colspan="3">\r\n                <select class="form-control"\r\n                    ng-model="feature.selectedDepartment"\r\n                    ng-change="onSpecialFeatureDepartmentSelect(feature)"\r\n                    ng-options="d as d.title disable when d.id == null for d in feature.departmentList track by d.id">\r\n\r\n                    <option value="">(None)</option>\r\n                </select>\r\n            </td>\r\n            <td colspan="999"></td>\r\n        </tr>\r\n\r\n        <tr ng-repeat-end ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\r\n            <td class="label">Factory Description / Production Note:</td>\r\n            <td colspan="3">\r\n                <input class="form-control" type="text" ng-model="feature.factory_description" />\r\n            </td>\r\n            <td colspan="999"></td>\r\n        </tr>\r\n\r\n        <tr class="spacer"><td></td></tr>\r\n\r\n        <tr ng-if="order.isEditable()">\r\n            <td colspan="{{ permissions.modify_special_features_wholesale ? \'4\' : \'3\' }}">&nbsp;</td>\r\n            <td>\r\n                <button type="text" class="form-control btn btn-info add-special-feature" ng-click="addSpecialFeature()">\r\n                    <span class="glyphicon glyphicon-plus"></span>\r\n                </button>\r\n            </td>\r\n        </div>\r\n\r\n    </table>\r\n</div>\r\n\r\n\r\n\r\n';
},function(e,r){e.exports='<div class="row task-row" ng-if="permission">\r\n    <div class="col-sm-2">{{ title }}</div>\r\n    <div ng-if="stage" class="col-sm-2 stage-badge {{ statusClass(stage) }}">{{ stage.status }}<i ng-if="stage.status==\'Complete\'" class="glyphicon glyphicon-ok"></i><i ng-if="stage.status==\'Rejected\'" class="glyphicon glyphicon-remove"></i></div>\r\n    <div ng-if="!stage" class="col-sm-2"><i>Not yet required</i></div>\r\n    <div class="col-sm-6"><div ng-transclude></div></div>\r\n    <div class="col-sm-2"><span ng-if="stage.submitted_on">{{ stage.submitted_on | date : AppSettings.FORMAT_DATE_JS }}</span><br><span ng-if="stage.submitted_by">{{ stage.submitted_by }}</span></div>\r\n</div>\r\n'},function(e,r){e.exports='<div class="status" xmlns="http://www.w3.org/1999/html">\n    <div class="status-spinner"><bar-spinner ng-if="loading" /></div>\n \n    <div ng-if="message" class="alert {{ message.type }}">\n         <div ng-repeat="text in message.message_list">{{ text }}</div> \n    </div>\n \n    <div>\n        <div class="row">\n            <div class="col-sm-6">\n                <label>Dealer Sales Representative:</label> {{ order.dealer_sales_rep_name }}\n                <br />\n                <button class="btn btn-default" ng-if="canChangeSalesRep()" ng-click="onOpenUpdateSalesRep()" type="button">Change Sales Representative</button>\n            </div>\n            <div class="col-sm-6">\n                <label>Customer Manager:</label> {{ order.customer_manager_name }}\n                <br />\n                <button class="btn btn-default" ng-click="onOpenUpdateCustomerManager()" type="button">Change Customer Manager</button>\n            </div>\n        </div>\n    </div>\n\n\n    <div class="row header-top">\n        <div class="col-sm-2">Stage / Task</div>\n        <div class="col-sm-2">Status</div>\n        <div class="col-sm-6">Data and Documents</div>\n        <div class="col-sm-2">Submitted</div>\n    </div>\n\n    <div class="status-container">\n        <div class="row task-row sub-header" ng-if="status.permissions.any_quote">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':sectionComplete(status.quote)}"></i>\n                    Quote\n                </h4>\n            </div>\n        </div>\n\n        <status-row title="Customer Details Captured" stage="status.quote.customer_details_captured" permission="status.permissions.view_status_customer_details_captured"></status-row>\n        <status-row title="Selections Completed" stage="status.quote.caravan_details_saved" permission="status.permissions.view_status_caravan_details_saved"></status-row>\n        <status-row title="Order Placement Requested" stage="status.quote.caravan_order_requested" permission="status.permissions.view_status_caravan_order_requested"></status-row>\n        <status-row title="Deposit Paid" stage="status.approval.deposit_paid" permission="status.permissions.view_status_deposit_paid">\n            <form ng-if="status.approval.deposit_paid"\n                  name="deposit_form"\n                  ng-submit="updateDeposit(deposit_form, status.approval.deposit_paid.data)">\n                <div class="form-group col-md-6">\n                    <label class="form-label">$ DEPOSIT AMOUNT</label>\n                    <input type="number" class="form-control" ng-model="status.approval.deposit_paid.data"\n                           name="deposit_amount" required ng-disabled="!status.approval.deposit_paid.permission"/>\n                </div>\n                <div class="col-md-6" ng-if="status.approval.deposit_paid.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Confirm Payment</button>\n                </div>\n            </form>\n        </status-row>\n        <status-row title="Order Placed" stage="status.quote.caravan_ordered" permission="status.permissions.view_status_caravan_ordered">\n            <span ng-if="status.quote.caravan_ordered.schedule_date">\n                The order is currently scheduled for {{ status.quote.caravan_ordered.schedule_date | date: AppSettings.FORMAT_DATE_MONTH_JS }}.\n            </span>\n        </status-row>\n        <status-row title="Special features reviewed" stage="status.approval.special_features_reviewed" permission="status.permissions.view_status_special_features_reviewed">\n            <div ng-if="status.approval.special_features_reviewed && status.approval.special_features_reviewed.status == \'Requires Action\' && status.approval.special_features_reviewed.permission">\n                <a ui-sref="order.special_features">Review special features</a>\n            </div>\n        </status-row>\n\n        <status-row title="Order Locked" stage="status.quote.caravan_order_finalized_at" permission="status.permissions.view_status_caravan_finalized">\n            <div ng-if="status.quote.caravan_order_finalized_at.cancelled_at">\n                The order lock has been cancelled on {{ status.quote.caravan_order_finalized_at.cancelled_at | date: AppSettings.FORMAT_DATETIME_JS }} by {{ status.quote.caravan_order_finalized_at.cancelled_by }}.<br>\n                Reason: {{ status.quote.caravan_order_finalized_at.cancel_reason }}\n            </div>\n            <div ng-if="status.quote.caravan_order_finalized_at.status == \'Complete\' && status.quote.caravan_order_finalized_at.permission">\n                <div class="form-group col-md-6 col-md-offset-3">\n                    <button type="button" ng-click="cancelFinalization()" class="btn btn-primary form-control">Cancel Order Lock</button>\n                    <span ng-if="status.quote.caravan_order_finalized_at.auto_finalization">\n                     This order has been auto locked.\n                    </span>\n                </div>\n            </div>\n        </status-row>\n\n        <div class="row task-row sub-header" ng-if="status.permissions.any_order_awaiting_approval">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':status.approval.marked_as_approved.status === \'Complete\'}"></i>\n                    Order Awaiting Approval\n                </h4>\n            </div>\n        </div>\n\n        <status-row title="Chassis Number Appointed" stage="status.approval.chassis_appointed" permission="status.permissions.view_status_chassis_number_appointed">\n            <form ng-if="status.approval.chassis_appointed" name="chassis_number_form"\n                  ng-submit="updateChassis()">\n                <div class="form-group col-md-6">\n                    <label class="form-label">CHASSIS NUMBER</label>\n                    <input type="text" class="form-control" ng-model="status.approval.chassis_appointed.data"\n                           name="chassis_number" required ng-disabled="!status.approval.chassis_appointed.permission && !status.approval.chassis_appointed.override_permission"\n                           ng-readonly="!editingChassis"\n                           focus-me="{{ editingChassis }}" />\n\n                </div>\n                <div class="form-group col-md-6" ng-if="status.approval.chassis_appointed.permission && !status.approval.chassis_appointed.data">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Assign Chassis Number</button>\n                </div>\n\n                <div class="col-sm-12"></div>\n\n                <div class="form-group col-md-6" ng-if="status.approval.chassis_appointed.override_permission">\n                    <button ng-if="!editingChassis" type="button" ng-click="enableChassisEdition()" class="btn btn-primary form-control">Manually Set Chassis Number</button>\n                    <button ng-if="editingChassis" type="button" ng-click="setChassis()" class="btn btn-primary form-control">Confirm</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Drafter Appointed" stage="status.approval.drafter_appointed" permission="status.permissions.view_status_drafter_appointed">\n            <form ng-if="status.approval.drafter_appointed" name="drafter_form"\n                  ng-submit="updateDrafter(drafter_form, status.approval.drafter_appointed.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">DRAFTER</label>\n                    <select type="date" class="form-control" ng-model="status.approval.drafter_appointed.data"\n                            ng-options="u[0] as u[1] for u in status.approval.drafter_appointed.choices"\n                            name="drafter" required ng-disabled="!status.approval.drafter_appointed.permission"></select>\n                </div>\n                <div class="col-md-4" ng-if="status.approval.drafter_appointed.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Appoint</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Customer Plans & Specs Produced" stage="status.approval.customer_plans_produced" permission="status.permissions.view_status_customer_plans_specs_produced">\n            <form name="customer_plans_form"\n                  ng-submit="updateDoc(customer_plans_form, status.approval.customer_plans_produced.file_upload, \'customer\')">\n                <div class="form-group col-md-4" ng-if="status.approval.customer_plans_produced.permission">\n                    <label class="form-label">CUSTOMER PLANS</label>\n                    <label ng-if="status.approval.customer_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.customer_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.customer_plans_produced.file_upload"\n                            name="customer_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.customer_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div class="view-specifications" ng-if="permissions.print_for_autocad">\n                        <a href="javascript:void(0);" ng-click="onPrintAutocad()">View Specifications</a>\n                    </div>\n                    <div ng-repeat="plan in status.approval.customer_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a  ng-if="status.approval.customer_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'customer\')">Delete</a></span>\n                    </div>\n                </div>\n            </form>\n        </status-row>\n\n        <!-- TODO: Client wants this removed but has indicated they may bring it back -->\n        <!--\n            <status-row class="hide" title="Customer plan approval" stage="status.approval.customer_plan_reviewed" permission="status.permissions.view_status_customer_plan_approval">\n                <div ng-if="status.approval.customer_plan_reviewed">\n                    <div ng-if="status.approval.customer_plan_reviewed.status == \'Requires Action\' && status.approval.customer_plan_reviewed.permission">\n                        <div class="checkbox">\n                            <label>\n                                <input type="checkbox" ng-model="status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked" />\n                                <i>I acknowledge that once the plan is approved, no changes can be made and production will be as per the current plan. NAC will not take responsibility for any loss due to any future change.</i>\n                            </label>\n                        </div>\n                        <div class="checkbox">\n                            <label>\n                                <input type="checkbox" ng-model="status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked" />\n                                <i>I understand that the weights and dimensions provided are an estimate only and that the final weights and dimensions will depend on the customer\'s final specifications</i>\n                            </label>\n                        </div>\n\n                        <div class="form-group col-md-6">\n                            <button type="button" ng-click="confirmRejectCustomerPlan()" class="btn btn-primary form-control">\n                                Reject Customer Plan\n                            </button>\n                        </div>\n                        <div class="form-group col-md-6">\n                            <button type="button" ng-click="approveCustomerPlan()" class="btn btn-primary form-control btn-success"\n                                    ng-disabled="!status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked || !status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked">\n                                Approve Customer Plan\n                            </button>\n                        </div>\n                    </div>\n\n                    <div ng-if="status.approval.customer_plan_reviewed.status == \'Rejected\'">\n                        Reject reason: {{ status.approval.customer_plan_reviewed.reject_reason }}\n                    </div>\n                </div>\n            </status-row>\n        -->\n\n        <status-row title="Factory Plans Produced" stage="status.approval.factory_plans_produced" permission="status.permissions.view_status_factory_plans_produced">\n            <form name="factory_plans_form"\n                  ng-submit="updateDoc(factory_plans_form, status.approval.factory_plans_produced.file_upload, \'factory\')">\n\n                <div class="form-group col-md-4" ng-if="status.approval.factory_plans_produced.permission">\n                    <label class="form-label">FACTORY PLANS</label>\n                    <label ng-if="status.approval.factory_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.factory_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.factory_plans_produced.file_upload"\n                            name="factory_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.factory_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="plan in status.approval.factory_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span ng-if="plan.file"><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a ng-if="status.approval.factory_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'factory\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.factory_plans_produced && (status.approval.factory_plans_produced.status != \'Complete\' || !status.approval.factory_plans_produced.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.factory_plans_produced.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.factory_plans_produced.data[0], \'factory\')"/>\n                        Plans attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Chassis Plans Produced" stage="status.approval.chassis_plans_produced" permission="status.permissions.view_status_chassis_plans_produced">\n            <form name="chassis_plans_form"\n                  ng-submit="updateDoc(chassis_plans_form, status.approval.chassis_plans_produced.file_upload, \'chassis\')">\n                <div class="form-group col-md-4" ng-if="status.approval.chassis_plans_produced.permission">\n                    <label class="form-label">CHASSIS PLANS</label>\n                    <label ng-if="status.approval.chassis_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.chassis_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.chassis_plans_produced.file_upload"\n                            name="chassis_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.chassis_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="plan in status.approval.chassis_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span ng-if="plan.file"><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a ng-if="status.approval.chassis_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'chassis\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.chassis_plans_produced && (status.approval.chassis_plans_produced.status != \'Complete\' || !status.approval.chassis_plans_produced.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.chassis_plans_produced.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.chassis_plans_produced.data[0], \'chassis\')"/>\n                        Plans attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n\n        <div class="row task-row sub-header" ng-if="status.permissions.any_delivery">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':sectionComplete(status.delivery)}"></i>\n                    Production \n                </h4>\n            </div>\n        </div>\n\n        <status-row title="VIN Number Assigned" stage="status.delivery.vin_number" permission="status.permissions.view_status_vin_number">\n            <form ng-if="status.delivery.vin_number" name="vin_number_form"\n                  ng-submit="updateVinNumber(vin_number_form, status.delivery.vin_number.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">VIN</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.vin_number.data"\n                           name="vin_number" required ng-disabled="!status.delivery.vin_number.permission"\n                           ng-pattern="/^.{11}\\d{6}$/" />\n                    <span class="error" ng-show="vin_number_form.vin_number.$error.pattern">VIN Number must be AAAAAAAAAAANNNNNN</span>\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.vin_number.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n        <!-- New Code -->\n        <status-row title="Actual Production Date" stage="status.delivery.actual_production_date" permission=" status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_production_date" name="actual_production_date_form"\n                  ng-submit="updateActualProductionDate(actual_production_date_form, status.delivery.actual_production_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Production Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_production_date.data"\n                           name="actual_production_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                           \n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n                </form>\n                <form name="del_actual_production_date_form"  ng-submit="deleteActualProdDate(del_actual_production_date_form,status.delivery.actual_production_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n       <!--  <status-row title=" Production Comments " stage="status.delivery.actual_production_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_production_comments" name="actual_production_comments_form"\n                  ng-submit="updateActualProductionComments(actual_production_comments_form, status.delivery.actual_production_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Production Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_production_comments.data"\n                           name="actual_production_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row> -->\n\n        <!-- Chassis Section -->\n         <status-row title="Chassis Section Date" stage="status.delivery.chassis_section" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.chassis_section" name="chassis_section"\n                  ng-submit="updateChassisSectionDate(chassis_section, status.delivery.chassis_section.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Chassis Section Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.chassis_section.data"\n                           name="chassis_section" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n                </form>\n                <form  name="del_chassis_section" ng-submit="deleteChassisSection(del_chassis_section,status.delivery.chassis_section.data)"  >\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n                \n\n        </status-row>\n\n        <status-row title="Chassis Section Comments" stage="status.delivery.chassis_section_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.chassis_section_comments" name="chassis_section_comments"\n                  ng-submit="updateChassisSectionComments(chassis_section_comments, status.delivery.chassis_section_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Chassis Section Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.chassis_section_comments.data"\n                           name="chassis_section_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Building Section -->\n         <status-row title="Building Section Date" stage="status.delivery.building" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.building" name="building"\n                  ng-submit="updateBuildingDate(building, status.delivery.building.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Building Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.building.data"\n                           name="building" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n            <form name="del_building_section" ng-submit="deleteBuildingSection(del_building_section,status.delivery.building.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n            </form>\n                \n        </status-row>\n\n        <status-row title="Building Comments" stage="status.delivery.building_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.building_comments" name="building_comments"\n                  ng-submit="updateBuildingComments(building_comments, status.delivery.building_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Building Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.building_comments.data"\n                           name="building_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n\n<!-- Pre-Wire Section -->\n         <status-row title="Pre-Wire Section Date" stage="status.delivery.prewire_section" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.prewire_section" name="prewire_section"\n                  ng-submit="updatePrewireDate(prewire_section, status.delivery.prewire_section.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Pre-Wire Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.prewire_section.data"\n                           name="prewire_section" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n              <form name="del_prewire_section" ng-submit="deletePrewireSection(del_prewire_section,status.delivery.prewire_section.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Prewire Comments" stage="status.delivery.prewire_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.prewire_comments" name="prewire_comments"\n                  ng-submit="updatePrewireComments(prewire_comments, status.delivery.prewire_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Prewire Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.prewire_comments.data"\n                           name="prewire_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n\n\n<!-- Aluminium Section -->\n         <status-row title="Aluminium / Fit Off" stage="status.delivery.aluminium" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.aluminium" name="aluminium"\n                  ng-submit="updateAluminiumDate(aluminium, status.delivery.aluminium.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Aluminium / Fit Off</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.aluminium.data"\n                           name="aluminium" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_aluminium_section" ng-submit="deleteAluminiumSection(del_aluminium_section,status.delivery.aluminium.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Aluminium / Fit Off Comments" stage="status.delivery.aluminium_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.aluminium_comments" name="aluminium_comments"\n                  ng-submit="updateAluminiumComments(aluminium_comments, status.delivery.aluminium_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Aluminium Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.aluminium_comments.data"\n                           name="aluminium_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Finishing Section -->\n         <status-row title="Finishing Date" stage="status.delivery.finishing" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.finishing" name="finishing"\n                  ng-submit="updateFinishingDate(finishing, status.delivery.finishing.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Finishing Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.finishing.data"\n                           name="finishing" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_finishing" ng-submit="deleteFinishing(del_finishing,status.delivery.finishing.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Finishing Comments" stage="status.delivery.finishing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.finishing_comments" name="finishing_comments"\n                  ng-submit="updateFinishingComments(finishing_comments, status.delivery.finishing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Finishing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.finishing_comments.data"\n                           name="finishing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n        <!-- planned QC -->\n        <!--     <status-row title="Planned QC Date" stage="status.delivery.qc_date_planned" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.qc_date_planned" name="qc_date_planned_form"\n                  ng-submit="updatePlannedQcDate(qc_date_planned_form, status.delivery.qc_date_planned.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_date_planned.data"\n                           name="qc_date_planned" ng-disabled="!status.delivery.qc_date_planned.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n        -->\n         <status-row title="Actual QC Date" stage="status.delivery.qc_date_actual" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.qc_date_actual" name="qc_date_actual_form"\n                  ng-submit="updateActualQcDate(qc_date_actual_form, status.delivery.qc_date_actual.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_date_actual.data"\n                           name="qc_date_actual" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_qc_date_actual" ng-submit="deleteActualQC(del_qc_date_actual,status.delivery.qc_date_actual.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n\n        <status-row title=" QC Comments " stage="status.delivery.qc_comments" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.qc_comments" name="qc_comments_form"\n                  ng-submit="updateQCComments(qc_comments_form, status.delivery.qc_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  QC Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_comments.data"\n                           name="qc_comments" ng-disabled="!status.delivery.qc_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n     <!--    <status-row title="Planned Water Test  Date" stage="status.delivery.planned_watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.planned_watertest_date" name="planned_watertest_date_form"\n                  ng-submit="updatePlannedWatertestDate(planned_watertest_date_form, status.delivery.planned_watertest_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned Water Test Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.planned_watertest_date.data"\n                           name="planned_watertest_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row> -->\n    \n      <!--  <status-row title="Actual Water Test  Date" stage="status.delivery.actual_watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_watertest_date" name="actual_watertest_date_form"\n                  ng-submit="updateActualWatertestDate(actual_watertest_date_form, status.delivery.actual_watertest_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Water Test Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_watertest_date.data"\n                           name="actual_watertest_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title=" Water Test Comments " stage="status.delivery.watertest_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_comments" name="watertest_comments_form"\n                  ng-submit="updateWatertestComments(watertest_comments_form, status.delivery.watertest_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Water Testing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.watertest_comments.data"\n                           name="watertest_comments" ng-disabled="!status.delivery.qc_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update </button>\n                </div>\n            </form>\n        </status-row>\n\n       -->\n        <status-row title="Weights" stage="status.delivery.weights" permission="status.permissions.view_status_weights">\n            <div class="row" ng-if="status.delivery.weights.permission">\n                <div class="form-group">\n                    <div class="row">\n                        <div class="col-md-4"><label>TARE:</label> {{ status.delivery.weights.data.weight_tare }}{{ status.delivery.weights.data.weight_tare == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>ATM:</label> {{ status.delivery.weights.data.weight_atm }}{{ status.delivery.weights.data.weight_atm == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>TOW BALL:</label> {{ status.delivery.weights.data.weight_tow_ball }}{{ status.delivery.weights.data.weight_tow_ball == null ? \'\' : \' kg\' }}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4"><label>WOB:</label> {{ status.delivery.weights.data.weight_tare - status.delivery.weights.data.weight_tow_ball }} kg</div>\n                        <div class="col-md-4"><label>GTM:</label> {{ status.delivery.weights.data.weight_atm - status.delivery.weights.data.weight_tow_ball }} kg</div>\n                        <div class="col-md-4"><label>TYRES:</label> {{ status.delivery.weights.data.weight_tyres }}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4"><label>CHASSIS GTM:</label> {{ status.delivery.weights.data.weight_chassis_gtm }}{{ status.delivery.weights.data.weight_chassis_gtm == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>GAS COMP:</label> {{ status.delivery.weights.data.weight_gas_comp }}</div>\n                        <div class="col-md-4"><label>PAYLOAD:</label> {{ status.delivery.weights.data.weight_payload }}{{ status.delivery.weights.data.weight_payload == null ? \'\' : \' kg\' }}</div>\n                    </div>\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.weights.permission">\n                    <button type="button" class="btn btn-primary form-control" ng-click="openWeightsModal()">Set Weights</button>\n                </div>\n            </div>\n        </status-row>\n\n         <status-row title="Final QC Date" stage="status.delivery.final_qc_date" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.final_qc_date" name="final_qc_date_form"\n                  ng-submit="updateFinalQcDate(final_qc_date_form, status.delivery.final_qc_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Final QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.final_qc_date.data"\n                           name="final_qc_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_final_qc_date" ng-submit="deleteFinalQC(del_final_qc_date,status.delivery.final_qc_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n            \n        </status-row>\n\n        <status-row title=" Final QC Comments " stage="status.delivery.final_qc_comments" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.final_qc_comments" name="final_qc_comments_form"\n                  ng-submit="updateFinalQcComments(final_qc_comments_form, status.delivery.final_qc_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Final QC Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.final_qc_comments.data"\n                           name="final_qc_comments" ng-disabled="!status.delivery.final_qc_comments.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.final_qc_comments.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update  </button>\n                </div>\n            </form>\n        </status-row>\n\n        \n        <status-row title="Planned Dispatch Date" stage="status.delivery.dispatch_date_planned" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="dispatch_date_planned_form"\n                  ng-submit="updatePlannedDispatchDate(dispatch_date_planned_form, status.delivery.dispatch_date_planned.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned Dispatch Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.dispatch_date_planned.data"\n                           name="dispatch_date_planned" ng-disabled="!status.delivery.dispatch_date_planned.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Actual Dispatch Date" stage="status.delivery.dispatch_date_actual" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_actual" name="dispatch_date_actual_form"\n                  ng-submit="updateActualDispatchDate(dispatch_date_actual_form, status.delivery.dispatch_date_actual.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Dispatch Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.dispatch_date_actual.data"\n                           name="dispatch_date_actual" ng-disabled="!status.delivery.dispatch_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n            \n            <form name="del_dispatch_date_actual" ng-submit="deleteActualDispatchDate(del_dispatch_date_actual,status.delivery.dispatch_date_actual.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title=" Dispatch Comments " stage="status.delivery.dispatch_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.dispatch_comments" name="dispatch_comments_form"\n                  ng-submit="updateDispatchComments(dispatch_comments_form, status.delivery.dispatch_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Dispatch Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.dispatch_comments.data"\n                           name="dispatch_comments" ng-disabled="!status.delivery.dispatch_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update  </button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Upload Driver Handover Form" stage="status.approval.handover_to_driver_form" permission="status.permissions.view_status_handover_to_driver_form">\n            <div class="row">\n                <form name="handover_to_driver_form"\n                      ng-submit="updateDoc(handover_to_driver_form, status.approval.handover_to_driver_form.file_upload, \'handover_to_driver_form\')">\n                    <div class="form-group col-md-4" ng-if="status.approval.handover_to_driver_form.permission">\n                        <label class="form-label">Handover Form</label>\n                        <label ng-if="status.approval.handover_to_driver_form.file_upload.name">\n                            Selected: {{ status.approval.handover_to_driver_form.file_upload.name }}\n                        </label>\n                        <button class="form-control btn btn-default" ngf-select\n                                ng-model="status.approval.handover_to_driver_form.file_upload"\n                                name="handover_to_driver" required>\n                            Select Form\n                        </button>\n                        <button type="submit" class="btn btn-primary form-control">Upload</button>\n                    </div>\n                    <div class="col-md-8" ng-if="status.approval.handover_to_driver_form">\n                        <label class="form-label">UPLOADED</label>\n                        <div ng-repeat="doc in status.approval.handover_to_driver_form.data">\n                            <b>{{ doc.file }}</b>\n                            <span ng-if="doc.file"><a target="_blank" href="{{ doc.url }}">View</a>&nbsp;<a  ng-if="status.approval.handover_to_driver_form.permission" href="" ng-click="deleteDoc(doc.id, \'handover_to_driver_form\')">Delete</a></span>\n                        </div>\n                    </div>\n                    <div class="col-md-8 col-md-offset-4" ng-if="status.approval.handover_to_driver_form && (status.approval.handover_to_driver_form.status != \'Complete\' || !status.approval.handover_to_driver_form.data[0].file)">\n                        <label>\n                            <input type="checkbox" ng-model="status.approval.handover_to_driver_form.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.handover_to_driver_form.data[0], \'handover_to_driver_form\')"/>\n                            Handover form attached separately\n                        </label>\n                    </div>\n                </form>\n            </div>\n            <div class="row" ng-if="status.approval.handover_to_driver_form.status == \'Complete\'">\n                <div class="col-md-6" ng-if="status.approval.handover_to_driver_form">\n                    <label>Recorded in Salesforce:</label>\n                </div>\n                <div class="col-md-6">\n                    {{ status.approval.handover_to_driver_form.extra_data.salesforce_handover_recorded_at | date :AppSettings.FORMAT_DATETIME_JS }}\n                </div>\n            </div>\n        </status-row>\n\n        <status-row title="Van Received at Dealership" stage="status.delivery.received_date_dealership" permission="status.permissions.view_status_received_date_dealership">\n            <form ng-if="status.delivery.received_date_dealership" name="received_date_dealership_form"\n                  ng-submit="updateDealershipReceivedDate(received_date_dealership_form, status.delivery.received_date_dealership.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Van Received at Dealership</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.received_date_dealership.data"\n                           name="received_date_dealership" ng-disabled="!status.delivery.received_date_dealership.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.received_date_dealership.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Upload Driver Handover To Dealership Form" stage="status.approval.handover_to_dealership_form" permission="status.permissions.view_status_handover_to_dealership_form">\n            <form name="handover_to_dealership_form"\n                  ng-submit="updateDoc(handover_to_dealership_form, status.approval.handover_to_dealership_form.file_upload, \'handover_to_dealership_form\')">\n                <div class="form-group col-md-4" ng-if="status.approval.handover_to_dealership_form.permission">\n                    <label class="form-label">Handover Form</label>\n                    <label ng-if="status.approval.handover_to_dealership_form.file_upload.name">\n                        Selected: {{ status.approval.handover_to_dealership_form.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.handover_to_dealership_form.file_upload"\n                            name="handover_to_dealership" required>\n                        Select Form\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.handover_to_dealership_form">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="doc in status.approval.handover_to_dealership_form.data">\n                        <b>{{ doc.file }}</b>\n                        <span ng-if="doc.file"><a target="_blank" href="{{ doc.url }}">View</a>&nbsp;<a  ng-if="status.approval.handover_to_dealership_form.permission" href="" ng-click="deleteDoc(doc.id, \'handover_to_dealership_form\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.handover_to_dealership_form && (status.approval.handover_to_dealership_form.status != \'Complete\' || !status.approval.handover_to_dealership_form.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.handover_to_dealership_form.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.handover_to_dealership_form.data[0], \'handover_to_dealership_form\')"/>\n                        Handover form attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Customer Delivery Date" stage="status.delivery.delivery_date_customer" permission="status.permissions.view_status_delivery_date_customer">\n            <div class="row">\n                <form ng-if="status.delivery.delivery_date_customer" name="delivery_date_customer_form"\n                      ng-submit="updateCustomerDeliveryDate(delivery_date_customer_form, status.delivery.delivery_date_customer.data.delivery_date_customer)">\n                    <div class="form-group col-md-8">\n                        <label class="form-label">Customer Delivery Date</label>\n                        <input type="text" class="form-control" ng-model="status.delivery.delivery_date_customer.data.delivery_date_customer" ng-change="checkErr(delivery_date_customer)"\n                               name="delivery_date_customer" id = "delivery_date_customer"  ng-disabled="!status.delivery.delivery_date_customer.permission"\n                               placeholder="dd/mm/yyyy" required/>\n                        <span ng-show = "delivery_date_customer_form.delivery_date_customer.$error.required">This field is required!</span>\n                        <span>{{errMessage}}</span>\n                    </div>\n                    <div class="col-md-4" ng-if="status.delivery.delivery_date_customer.permission" >\n                        <label class="form-label">&nbsp;</label>\n                        <button type="submit" class="btn btn-primary form-control" ng-if="noShow">Set Date</button>\n                    </div>\n                </form>\n\n            </div>\n            <div class="row" ng-if="status.delivery.delivery_date_customer.status == \'Complete\'">\n                <div class="col-md-6">\n                    <label>Recorded in Salesforce:</label>\n                </div>\n                <div class="col-md-6">\n                    {{ status.delivery.delivery_date_customer.data.salesforce_delivery_recorded_at | date :AppSettings.FORMAT_DATETIME_JS }}\n                </div>\n            </div>\n        </status-row>\n    </div>\n\n    <h3 class="top-margin-40">Order History</h3>\n\n    <div class="row top-margin-20" ng-if="status.history.permission">\n        <form name="order_history_note_form" ng-submit="updateHistory(order_history_note_form, history)">\n            <div class="form-group col-md-6">\n                <label class="form-label">Manually add notes and/or relevant files for this order</label>\n                <textarea class="form-control" ng-model="history.note" name="history_note"></textarea>\n            </div>\n            <div class="form-group col-md-4">\n                <label class="form-label"></label>\n                <label ng-if="history.file_upload">\n                    Selected: {{ history.file_upload.name }}\n                </label>\n                <button class="form-control btn btn-default" ngf-select\n                        ng-model="history.file_upload"\n                        name="contract">\n                    Select File\n                </button>\n            </div>\n            <div class="col-md-2"> <!-- ng-if="status.history.add.permission" -->\n                <label class="form-label">&nbsp;</label>\n                <button type="submit" class="btn btn-primary form-control">Submit</button>\n            </div>\n        </form>\n    </div>\n\n    <div class="history-container">\n        <div class="row header-top top-margin-40">\n            <div class="col-sm-3">Date & Time</div>\n            <div class="col-sm-3">User</div>\n            <div class="col-sm-3">Action</div>\n            <div class="col-sm-3">Action Details</div>\n\n        </div>\n\n        <div class="row" ng-repeat="history in status_history" permission="status.permissions.view_status_qc_date_actual" >\n            <div class="col-sm-3">{{ history.update_on | date :AppSettings.FORMAT_DATETIME_JS}}</div>\n            <div class="col-sm-3">{{ history.update_by }}</div>\n            <div class="col-sm-3">{{ history.action}}</div>\n\n<!--            <div class="col-sm-2" ng-if="history.action ==\'Customer Changed\'">-->\n<!--              {{order.order_converted}}-->\n<!--            </div>-->\n<!--            <div class="col-sm-2" ng-if="history.action !=\'Customer Changed\'">-->\n<!--              &#45;&#45;-->\n<!--            </div>-->\n\n\n\n\n\n\n            <div class="col-sm-3"><div ng-repeat="note in history.notes" ng-bind-html="note">\n\n            </div>\n              <div ng-if="history.action ==\'Customer Changed\'">\n                sales date :{{order.order_converted}}\n              </div>\n            </div>\n\n\n        </div>\n    </div>\n\n\n    <div id="update_customer_manager" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Change Customer Manager</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <div>\n                        <label>Select new Customer Manager:</label>\n                        <select ng-options="u.id as u.title for u in customer_manager_list" ng-model="new_customer_manager_id"></select>\n                    </div>\n                    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateCustomerManager()">Update</button>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="update_sales_rep" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Change Sales Representative</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <div>\n                        <label>Select new Sales Representative:</label>\n                        <select ng-options="u.id as u.title for u in sales_rep_list" ng-model="new_sales_rep_id"></select>\n                    </div>\n                    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateSalesRep()">Update</button>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="customer_plan_reject_reason" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Rejection reason</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter here the reason why the customer plan is being rejected..."\n                              class="form-control"\n                              ng-model="customer_plan_reject_reason"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="processRejectCustomerPlan()">Reject</button>\n                    &nbsp;\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="order_finalization_cancel_reason" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Cancellation reason</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter here the reason why the order finalisation is cancelled..."\n                              class="form-control"\n                              ng-model="order_finalization_cancel_reason"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="processCancelFinalization()" ng-disabled="!order_finalization_cancel_reason">Cancel Order Lock</button>\n                    &nbsp;\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="delivery_weights" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Weights</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n\n                <form name="save_weight_form" ng-submit="saveWeights()">\n                    <div class="modal-body">\n                        <div class="row">\n                            <div class="col-md-4">\n                                TARE:<br>\n                                <input class="form-control" type="number" name="weight_tare" ng-model="status.delivery.new_weights.data.weight_tare" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tare.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tare.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                ATM:<br>\n                                <input class="form-control" type="number" name="weight_atm" ng-model="status.delivery.new_weights.data.weight_atm" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_atm.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_atm.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                TOW BALL:<br>\n                                <input class="form-control" type="number" name="weight_tow_ball" ng-model="status.delivery.new_weights.data.weight_tow_ball" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tow_ball.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tow_ball.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-4">WOB:<br> {{ status.delivery.new_weights.data.weight_tare - status.delivery.new_weights.data.weight_tow_ball }}  kg</div>\n                            <div class="col-md-4">GTM:<br> {{ status.delivery.new_weights.data.weight_atm - status.delivery.new_weights.data.weight_tow_ball }} kg</div>\n                            <div class="col-md-4">\n                                TYRES:<br>\n                                <input class="form-control" type="text" name="weight_tyres" ng-model="status.delivery.new_weights.data.weight_tyres" ng-min="0" />\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tyres.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tyres.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-4">\n                                CHASSIS GTM:<br>\n                                <input class="form-control" type="number" name="weight_chassis_gtm" ng-model="status.delivery.new_weights.data.weight_chassis_gtm" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_chassis_gtm.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_chassis_gtm.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                GAS COMP:<br>\n                                <input class="form-control" type="number" name="weight_gas_comp" ng-model="status.delivery.new_weights.data.weight_gas_comp" ng-pattern="/^\\d{8}$/" />\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_gas_comp.$error.pattern">Must be 8 digits</span>\n                            </div>\n                            <div class="col-md-4">\n                                PAYLOAD:<br>\n                                <input class="form-control" type="number" name="weight_payload" ng-model="status.delivery.new_weights.data.weight_payload" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_payload.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_payload.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="modal-footer">\n                        <button type="submit" class="btn btn-default" ng-disabled="!save_weight_form.$valid">Save Weights</button>\n                        &nbsp;\n                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n';
},function(e,r){e.exports='<form name="weightsize_form" novalidate class="form">\r\n    <div class="row top-margin-40">\r\n        <div class="col-sm-10 col-sm-offset-1">\r\n            <h2>Estimated Size</h2>\r\n\r\n            <div class="row">\r\n                <div class="col-sm-2 th">\r\n                    Length: inc. A-Frame\r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Length: inc. Bumper\r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Width: inc. Awning\r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Max Height: inc. A/C\r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Avg. Tare weight:\r\n                </div>\r\n                <div class="col-sm-2 th">\r\n                    Avg. Tow Ball weight:\r\n                </div>\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.length_incl_aframe_feet }}\' {{ info.series_detail.length_incl_aframe_inches }}"\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.length_incl_bumper_feet }}\' {{ info.series_detail.length_incl_bumper_inches }}"\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.width_incl_awning_feet }}\' {{ info.series_detail.width_incl_awning_inches }}"\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.height_max_incl_ac_feet }}\' {{ info.series_detail.height_max_incl_ac_inches }}"\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.avg_tare_weight_min }} &mdash; {{ info.series_detail.avg_tare_weight_max }} kg\r\n                </div>\r\n                <div class="col-sm-2">\r\n                    {{ info.series_detail.avg_ball_weight_min }} &mdash; {{ info.series_detail.avg_ball_weight_max }} kg\r\n                </div>\r\n            </div>\r\n\r\n            <h2 class="top-margin-40">Estimated Weight (Tare)</h2>\r\n            {{ info.series_detail.tare_weight }} kg\r\n\r\n            <h3 class="top-margin-40">Specify weight limits for this caravan</h3>\r\n            Some owners are limited by the towing capacity of their vehicle.\r\n\r\n            <div class="row top-margin-40">\r\n                <div class="col-sm-4">\r\n                    <div class="form-group">\r\n                        <label class="form-label">TARE (KG)</label>\r\n                        <input type="number" string-to-number class="form-control" name="customer_tare_weight" ng-model="order.custom_tare_weight" />\r\n\r\n                        <div ng-messages="weightsize_form.customer_tare_weight.$error" ng-if="weightsize_form.customer_tare_weight.$dirty || customer_form.$submitted">\r\n                            <p ng-message="number">This is not a valid number.</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="col-sm-4">\r\n                    <div class="form-group">\r\n                        <label class="form-label">BALL WEIGHT (KG)</label>\r\n                        <input type="number" string-to-number class="form-control" name="customer_ball_weight" ng-model="order.custom_ball_weight" />\r\n\r\n                        <div ng-messages="weightsize_form.customer_ball_weight.$error" ng-if="weightsize_form.customer_ball_weight.$dirty || customer_form.$submitted">\r\n                            <p ng-message="number">This is not a valid number.</p>\r\n                        </div>\r\n                    </div>\r\n                    </div>\r\n                </div>\r\n             </div>\r\n\r\n            <div class="row top-margin-40">\r\n                <div class="col-sm-3">\r\n                    <button class="btn btn-primary form-control" type="submit" ng-click="proceed(weightsize_form)" ng-if="order.isEditable()">Save and proceed\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</form>'}]);